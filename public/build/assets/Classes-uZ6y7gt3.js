import{I as G,n as R,J,i as n,j as pe,c as o,a as O,u as z,h as ge,w as Y,b as e,d as _,k as I,o as a,F as A,r as E,t as g,p as me,s as M,x as be,e as ve,v as xe,K as T,m as p}from"./app-CJLHV58l.js";import{_ as ye}from"./AuthenticatedLayout-DivsuQqy.js";import{_ as fe}from"./Alert-DjLP1fDd.js";import"./ApplicationLogo-DdIlblXI.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";/**
 * @license lucide-vue-next v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var N={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};/**
 * @license lucide-vue-next v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=v=>v.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),_e=(v,k)=>({size:i,strokeWidth:r=2,absoluteStrokeWidth:w,color:x,class:V,...d},{attrs:m,slots:u})=>G("svg",{...N,width:i||N.width,height:i||N.height,stroke:x||N.stroke,"stroke-width":w?Number(r)*24/Number(i):r,...m,class:["lucide",`lucide-${he(v)}`],...d},[...k.map(f=>G(...f)),...u.default?[u.default()]:[]]);/**
 * @license lucide-vue-next v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=_e("BookOpenIcon",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]),ke={class:"flex items-center justify-between"},we={class:"flex flex-wrap items-center gap-2"},Ce=["disabled"],Se=["disabled"],je={key:0,class:"inline-flex items-center gap-1"},Ie={key:1},Ae={class:"rounded-xl bg-white p-5 shadow-sm ring-1 ring-gray-100"},Me={class:"mb-5 flex flex-col gap-3 border-b border-gray-100 pb-4 text-xs text-gray-700"},Ve={class:"flex flex-wrap items-end justify-between gap-3"},Fe={class:"w-full max-w-xs"},Le=["value"],Be={class:"flex gap-2"},Oe=["disabled"],Ee={key:0},Ne={key:1},$e={key:0,class:"mt-2 rounded-md bg-gray-50 p-3"},De={class:"flex flex-wrap gap-2"},Pe=["value","checked","onChange"],ze={class:"overflow-x-auto"},Te={class:"min-w-full text-left text-sm"},Ue={class:"border-b border-gray-200 bg-gray-50 text-xs font-semibold uppercase tracking-wide text-gray-500"},He={class:"w-10 px-3 py-2"},Ke=["checked"],qe={key:0},Ge={class:"px-3 py-2 align-top"},Re=["checked","onChange"],Je={class:"px-3 py-2 align-top"},Ye={class:"text-xs text-gray-500"},Ze={class:"px-3 py-2 align-top"},Qe={class:"flex flex-col"},Xe={class:"text-gray-800"},We={key:0,class:"text-[10px] text-gray-500"},es={class:"px-3 py-2 align-top"},ss={class:"text-[11px] text-gray-700"},ts={class:"font-medium"},ls={class:"px-3 py-2 align-top"},as={class:"flex justify-end gap-2"},os=["onClick"],ns=["onClick"],ds={key:0,class:"fixed inset-0 z-40 flex items-center justify-center bg-black/40 px-4"},rs={class:"w-full max-w-lg rounded-lg bg-white p-5 shadow-lg"},is={class:"mb-3 flex items-center justify-between"},us={class:"text-base font-semibold text-gray-800"},cs={class:"grid grid-cols-1 gap-3"},ps={class:"flex flex-wrap gap-1"},gs=["onClick"],ms={class:"mt-4 flex justify-end gap-2"},bs=["disabled"],vs={key:0},xs={key:1},ys={key:1,class:"fixed inset-0 z-40 flex items-center justify-center bg-black/40 px-4"},fs={class:"w-full max-w-md rounded-lg bg-white p-6 shadow-lg"},hs={class:"mb-4 flex items-center gap-2"},_s={class:"space-y-3 mb-6"},ks={class:"flex justify-end gap-2"},ws=["disabled"],Cs={key:0,class:"inline-flex items-center gap-1"},Ss={key:1},js={key:2,class:"fixed inset-0 z-40 flex items-center justify-center bg-black/40 px-4"},Is={class:"w-full max-w-sm rounded-lg bg-white p-5 shadow-lg"},As={class:"mb-4 text-xs text-gray-600"},Os={__name:"Classes",props:{classes:{type:Array,default:()=>[]},subjects:{type:Array,default:()=>[]},schoolLevel:{type:String,default:""}},setup(v){const k=v,i=R(k.classes.map(l=>({id:l.id,name:l.name,level:l.level,description:l.description,subject_ids:[...l.subject_ids]})));J(()=>k.classes,l=>{i.splice(0,i.length,...l.map(s=>({id:s.id,name:s.name,level:s.level,description:s.description,subject_ids:[...s.subject_ids]})))});const r=n([]),w=n(!1),x=n(!1),V=n(!1),d=n(""),m=n(null),u=n([]),f=n(!1),F=n(!1),S=n(null),c=R({name:"",description:"",level:""}),b=n([]),h=n(null),j=n(!1),$=n(!1),D=n(""),L=n(null),C=n(null),Q=["CIV","HIS","GEO","KIS","ENG","PHY","CHE","BIO","B/MAT"],X=pe(()=>k.subjects.filter(l=>Q.includes(l.subject_code)).map(l=>l.id)),W=()=>{S.value=null,c.name="",c.description="",c.level=k.schoolLevel,b.value=[],h.value=null,F.value=!0},ee=l=>{const s=i.find(t=>t.id===l);if(!s){u.value=[];return}s.subject_ids&&s.subject_ids.length>0?u.value=[...s.subject_ids]:u.value=[...X.value]};J(()=>m.value,l=>{if(!l){u.value=[];return}ee(l)});const se=l=>{S.value=l.id,c.name=l.name,c.description=l.description||"",b.value=[...l.subject_ids],h.value=null,F.value=!0},B=()=>{F.value=!1},U=(l,s,t)=>{L.value=l,C.value=s,D.value=t,$.value=!0},H=()=>{$.value=!1,L.value=null,C.value=null,D.value=""},te=l=>{const s=r.value.indexOf(l);s===-1?r.value.push(l):r.value.splice(s,1)},K=()=>i.length>0&&r.value.length===i.length,le=()=>{K()?r.value=[]:r.value=i.map(l=>l.id)},ae=()=>{j.value=!0,h.value=null,S.value?p.post(route("classes.update",S.value),{name:c.name,description:c.description,subject_ids:b.value},{preserveScroll:!0,onSuccess:()=>{B(),p.reload({only:["classes"]})},onError:l=>{h.value=Object.values(l||{}).join(" ")},onFinish:()=>{j.value=!1}}):p.post(route("classes.store"),{name:c.name,description:c.description,subject_ids:b.value},{preserveScroll:!0,onSuccess:()=>{B(),p.reload({only:["classes"]})},onError:l=>{h.value=Object.values(l||{}).join(" ")},onFinish:()=>{j.value=!1}})},oe=l=>{U("delete-single",l,"Are you sure you want to delete this class? This action cannot be undone.")},ne=()=>{r.value.length&&U("delete-bulk",[...r.value],"Are you sure you want to delete all selected classes? This action cannot be undone.")},de=()=>{d.value="",V.value=!0},q=()=>{V.value=!1,d.value=""},re=()=>{!d.value||x.value||(x.value=!0,p.post(route("classes.bulk-create-standard"),{level:d.value},{preserveScroll:!0,onSuccess:()=>{q(),p.reload({only:["classes"]})},onFinish:()=>{x.value=!1}}))},ie=()=>{L.value==="delete-single"&&C.value?p.delete(route("classes.destroy",C.value),{preserveScroll:!0}):L.value==="delete-bulk"&&Array.isArray(C.value)&&(w.value=!0,p.post(route("classes.bulk-delete"),{ids:C.value},{preserveScroll:!0,onSuccess:()=>{p.reload({only:["classes"]})},onFinish:()=>{w.value=!1,r.value=[]}})),H()},ue=l=>{const s=u.value.indexOf(l);s===-1?u.value.push(l):u.value.splice(s,1)},ce=()=>{if(!m.value||f.value)return;f.value=!0;const l=[{class_id:m.value,subject_ids:u.value}];p.post("/classes/assign-subjects",{assignments:l},{preserveScroll:!0,onSuccess:()=>{p.reload({only:["classes"]})},onFinish:()=>{f.value=!1}})};return(l,s)=>(a(),o(A,null,[O(z(ge),{title:"Classes"}),O(ye,null,{header:Y(()=>[e("div",ke,[s[7]||(s[7]=e("div",null,[e("h2",{class:"text-2xl font-semibold leading-tight text-gray-800"}," Classes "),e("p",{class:"mt-1 text-sm text-gray-500"}," Manage classes and inline assign subjects to each class. ")],-1)),e("div",we,[e("button",{type:"button",class:"rounded-md bg-emerald-600 px-3 py-1.5 text-xs font-semibold text-white shadow-sm hover:bg-emerald-700",onClick:W}," + Add Class "),e("button",{type:"button",class:"rounded-md bg-blue-600 px-3 py-1.5 text-xs font-semibold text-white shadow-sm hover:bg-blue-700 disabled:cursor-not-allowed disabled:opacity-60 flex items-center gap-1",disabled:x.value,onClick:de},[O(z(Z),{class:"w-4 h-4"}),s[5]||(s[5]=e("span",null,"Import Classes",-1))],8,Ce),e("button",{type:"button",class:"rounded-md bg-red-50 px-3 py-1.5 text-xs font-semibold text-red-700 ring-1 ring-red-100 hover:bg-red-100 disabled:cursor-not-allowed disabled:opacity-60",disabled:!r.value.length||w.value,onClick:ne},[w.value?(a(),o("span",je,[...s[6]||(s[6]=[e("span",{class:"inline-flex h-3 w-3 animate-spin rounded-full border border-red-500 border-t-transparent"},null,-1),e("span",null,"Deleting...",-1)])])):(a(),o("span",Ie,"Bulk Delete"))],8,Se)])])]),default:Y(()=>[e("div",Ae,[e("div",Me,[s[11]||(s[11]=e("div",{class:"flex flex-wrap items-center gap-3"},[e("div",{class:"flex flex-col gap-1"},[e("span",{class:"text-[11px] font-semibold uppercase tracking-wide text-gray-500"}," Assign Subjects to a Class "),e("span",{class:"text-[11px] text-gray-500"}," Chagua darasa kisha weka alama kwenye masomo unayotaka lifundishwe; masomo ya msingi yatajiwekwa alama kiotomatiki kama darasa halina masomo bado. ")])],-1)),e("div",Ve,[e("div",Fe,[s[9]||(s[9]=e("label",{class:"mb-1 block text-[11px] font-medium text-gray-700"},"Select Class",-1)),I(e("select",{"onUpdate:modelValue":s[0]||(s[0]=t=>m.value=t),class:"w-full rounded-md border border-gray-300 px-2 py-1.5 text-xs focus:border-emerald-500 focus:outline-none focus:ring-emerald-500"},[s[8]||(s[8]=e("option",{value:"",disabled:""},"Select class...",-1)),(a(!0),o(A,null,E(i,t=>(a(),o("option",{key:t.id,value:t.id},g(t.name)+" (ID #"+g(t.id)+") ",9,Le))),128))],512),[[me,m.value]])]),e("div",Be,[e("button",{type:"button",class:"rounded-md bg-emerald-600 px-3 py-1.5 text-xs font-semibold text-white shadow-sm hover:bg-emerald-700 disabled:cursor-not-allowed disabled:opacity-60",disabled:!m.value||f.value,onClick:ce},[f.value?(a(),o("span",Ne,"Saving...")):(a(),o("span",Ee,"Save Assignments"))],8,Oe)])]),m.value?(a(),o("div",$e,[s[10]||(s[10]=e("p",{class:"mb-2 text-[11px] font-medium text-gray-700"},"Subjects",-1)),e("div",De,[(a(!0),o(A,null,E(v.subjects,t=>(a(),o("label",{key:t.id,class:M(["inline-flex items-center gap-1 rounded-full border px-2 py-1 text-[10px] font-medium",u.value.includes(t.id)?"border-emerald-500 bg-emerald-50 text-emerald-800":"border-gray-200 bg-white text-gray-700 hover:bg-gray-50"])},[e("input",{type:"checkbox",class:"h-3 w-3 rounded border-gray-300 text-emerald-600 focus:ring-emerald-500",value:t.id,checked:u.value.includes(t.id),onChange:y=>ue(t.id)},null,40,Pe),e("span",null,g(t.subject_code),1)],2))),128))])])):_("",!0)]),e("div",ze,[e("table",Te,[e("thead",null,[e("tr",Ue,[e("th",He,[e("input",{type:"checkbox",class:"h-3 w-3 rounded border-gray-300 text-emerald-600 focus:ring-emerald-500",checked:K(),onChange:le},null,40,Ke)]),s[12]||(s[12]=e("th",{class:"w-16 px-3 py-2"},"ID No",-1)),s[13]||(s[13]=e("th",{class:"px-3 py-2"},"Class",-1)),s[14]||(s[14]=e("th",{class:"px-3 py-2"},"Subjects Assigned",-1)),s[15]||(s[15]=e("th",{class:"px-3 py-2 text-right"},"Actions",-1))])]),e("tbody",null,[i.length===0?(a(),o("tr",qe,[...s[16]||(s[16]=[e("td",{colspan:"4",class:"px-3 py-4 text-center text-xs text-gray-500"}," No classes defined yet. ",-1)])])):_("",!0),(a(!0),o(A,null,E(i,t=>(a(),o("tr",{key:t.id,class:"border-b border-gray-100 text-xs text-gray-700 hover:bg-gray-50"},[e("td",Ge,[e("input",{type:"checkbox",class:"h-3 w-3 rounded border-gray-300 text-emerald-600 focus:ring-emerald-500",checked:r.value.includes(t.id),onChange:y=>te(t.id)},null,40,Re)]),e("td",Je,[e("span",Ye,"#"+g(t.id),1)]),e("td",Ze,[e("div",Qe,[e("span",Xe,g(t.name),1),t.description?(a(),o("span",We,g(t.description),1)):_("",!0)])]),e("td",es,[e("div",ss,[e("span",ts,g(v.subjects.filter(y=>t.subject_ids.map(P=>String(P)).includes(String(y.id))).map(y=>y.subject_code).join(", ")||"None"),1)])]),e("td",ls,[e("div",as,[e("button",{type:"button",class:"rounded-md bg-blue-50 px-2 py-1 text-[11px] font-medium text-blue-700 ring-1 ring-blue-100 hover:bg-blue-100",onClick:y=>se(t)}," Edit ",8,os),e("button",{type:"button",class:"rounded-md bg-red-50 px-2 py-1 text-[11px] font-medium text-red-700 ring-1 ring-red-100 hover:bg-red-100",onClick:y=>oe(t.id)}," Delete ",8,ns)])])]))),128))])])])]),F.value?(a(),o("div",ds,[e("div",rs,[e("div",is,[e("h3",us,g(S.value?"Edit Class":"Add Class"),1),e("button",{type:"button",class:"text-sm text-gray-400 hover:text-gray-600",onClick:B}," âœ• ")]),e("form",{class:"space-y-3 text-xs text-gray-700",onSubmit:be(ae,["prevent"])},[h.value?(a(),ve(fe,{key:0,variant:"danger",title:"Could not save class",message:h.value},null,8,["message"])):_("",!0),e("div",cs,[e("div",null,[s[17]||(s[17]=e("label",{class:"mb-1 block font-medium"},"Class Name",-1)),I(e("input",{"onUpdate:modelValue":s[1]||(s[1]=t=>c.name=t),type:"text",class:"w-full rounded-md border border-gray-300 px-2 py-1.5 text-xs focus:border-emerald-500 focus:outline-none focus:ring-emerald-500",placeholder:"e.g. Form I A",required:""},null,512),[[xe,c.name]])])]),e("div",null,[s[18]||(s[18]=e("label",{class:"mb-1 block font-medium"},"Assign Subjects",-1)),e("div",ps,[(a(!0),o(A,null,E(v.subjects,t=>(a(),o("button",{key:t.id,type:"button",class:M(["rounded-full px-2 py-0.5 text-[10px] font-medium ring-1",b.value.includes(t.id)?"bg-emerald-600 text-white ring-emerald-600":"bg-white text-gray-700 ring-gray-200 hover:bg-gray-50"]),onClick:y=>b.value=b.value.includes(t.id)?b.value.filter(P=>P!==t.id):[...b.value,t.id]},g(t.subject_code),11,gs))),128))])]),e("div",ms,[e("button",{type:"button",class:"rounded-md bg-gray-50 px-3 py-1.5 text-xs font-medium text-gray-700 ring-1 ring-gray-200 hover:bg-gray-100",onClick:B}," Cancel "),e("button",{type:"submit",class:"rounded-md bg-emerald-600 px-3 py-1.5 text-xs font-semibold text-white shadow-sm hover:bg-emerald-700 disabled:cursor-not-allowed disabled:opacity-60",disabled:j.value},[j.value?(a(),o("span",vs,"Saving...")):(a(),o("span",xs,"Save"))],8,bs)])],32)])])):_("",!0),V.value?(a(),o("div",ys,[e("div",fs,[e("div",hs,[O(z(Z),{class:"w-5 h-5 text-blue-600"}),s[19]||(s[19]=e("h3",{class:"text-lg font-semibold text-gray-800"}," Import Classes ",-1))]),s[24]||(s[24]=e("p",{class:"mb-4 text-sm text-gray-600"}," Select the school level to import standard classes for your school. ",-1)),e("div",_s,[e("label",{class:M(["flex items-center gap-3 p-3 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50",d.value==="Primary"?"border-blue-500 bg-blue-50":""])},[I(e("input",{type:"radio","onUpdate:modelValue":s[2]||(s[2]=t=>d.value=t),value:"Primary",class:"w-4 h-4 text-blue-600"},null,512),[[T,d.value]]),s[20]||(s[20]=e("div",null,[e("p",{class:"font-medium text-gray-900"},"Primary"),e("p",{class:"text-xs text-gray-500"},"Class I - VII")],-1))],2),e("label",{class:M(["flex items-center gap-3 p-3 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50",d.value==="O-Level"?"border-blue-500 bg-blue-50":""])},[I(e("input",{type:"radio","onUpdate:modelValue":s[3]||(s[3]=t=>d.value=t),value:"O-Level",class:"w-4 h-4 text-blue-600"},null,512),[[T,d.value]]),s[21]||(s[21]=e("div",null,[e("p",{class:"font-medium text-gray-900"},"O-Level (Secondary)"),e("p",{class:"text-xs text-gray-500"},"Form I - IV")],-1))],2),e("label",{class:M(["flex items-center gap-3 p-3 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50",d.value==="A-Level"?"border-blue-500 bg-blue-50":""])},[I(e("input",{type:"radio","onUpdate:modelValue":s[4]||(s[4]=t=>d.value=t),value:"A-Level",class:"w-4 h-4 text-blue-600"},null,512),[[T,d.value]]),s[22]||(s[22]=e("div",null,[e("p",{class:"font-medium text-gray-900"},"A-Level (Secondary)"),e("p",{class:"text-xs text-gray-500"},"Form V - VI")],-1))],2)]),e("div",ks,[e("button",{type:"button",class:"rounded-md bg-gray-50 px-4 py-2 text-sm font-medium text-gray-700 ring-1 ring-gray-200 hover:bg-gray-100",onClick:q}," Cancel "),e("button",{type:"button",class:"rounded-md bg-blue-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-blue-700 disabled:cursor-not-allowed disabled:opacity-60 flex items-center gap-1",disabled:!d.value||x.value,onClick:re},[x.value?(a(),o("span",Cs,[...s[23]||(s[23]=[e("span",{class:"inline-flex h-3 w-3 animate-spin rounded-full border border-white border-t-transparent"},null,-1),e("span",null,"Importing...",-1)])])):(a(),o("span",Ss,"Import"))],8,ws)])])])):_("",!0),$.value?(a(),o("div",js,[e("div",Is,[s[25]||(s[25]=e("h3",{class:"mb-2 text-sm font-semibold text-gray-800"}," Please confirm ",-1)),e("p",As,g(D.value),1),e("div",{class:"mt-2 flex justify-end gap-2 text-xs"},[e("button",{type:"button",class:"rounded-md bg-gray-50 px-3 py-1.5 font-medium text-gray-700 ring-1 ring-gray-200 hover:bg-gray-100",onClick:H}," Cancel "),e("button",{type:"button",class:"rounded-md bg-red-600 px-3 py-1.5 font-semibold text-white shadow-sm hover:bg-red-700",onClick:ie}," Confirm ")])])])):_("",!0)]),_:1})],64))}};export{Os as default};

import{r as y,c as P,q as U,a as i,b as f,u as a,h as V,w as h,d as t,e as c,o as p,t as n,g as u,k as A,F as C,f as B,n as j,x as F,m as x,v as b}from"./app-ff-AdnyS.js";import{_ as H}from"./AuthenticatedLayout-C1QmzU21.js";import"./ApplicationLogo-no4VEeoL.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const D={class:"space-y-4"},$={key:0,class:"rounded-lg border border-emerald-200 bg-emerald-50 px-3 py-2 text-[11px] text-emerald-900"},R={class:"flex items-start gap-2"},z={class:"text-[11px] text-emerald-800"},O={class:"flex flex-wrap items-center justify-between gap-2 text-xs text-gray-600"},E={class:"flex items-center gap-2"},I={class:"overflow-x-auto rounded-xl bg-white p-4 shadow-sm ring-1 ring-gray-100"},L={class:"min-w-full border-collapse text-left text-[11px]"},q={key:0},G={class:"px-3 py-2 align-top"},J={class:"px-3 py-2 align-top"},K={class:"px-3 py-2 align-top"},Q={class:"px-3 py-2 align-top"},W={class:"px-3 py-2 align-top text-right"},X={class:"px-3 py-2 align-top text-right"},Y={class:"px-3 py-2 align-top text-right"},Z={class:"px-3 py-2 align-top"},tt={class:"px-3 py-2 align-top text-right"},et={class:"inline-flex items-center gap-1"},st=["onClick"],ot={key:0,class:"fixed inset-0 z-40 flex items-center justify-center bg-black/40 px-4 py-6 backdrop-blur-sm"},lt={class:"w-full max-w-md rounded-2xl bg-white p-5 text-xs text-gray-700 shadow-2xl"},at={class:"mb-3 rounded-md bg-gray-50 px-3 py-2 text-[11px] text-gray-700"},nt={class:"font-semibold text-gray-800"},rt={class:"text-[10px] text-gray-500"},dt={class:"mt-1 text-[10px] text-gray-600"},it={class:"font-semibold"},pt={class:"font-semibold"},ut={class:"font-semibold"},xt={key:0,class:"mt-1 text-[10px] text-emerald-700"},mt={class:"font-semibold"},gt={class:"grid gap-3 md:grid-cols-2"},ct={class:"mt-3 grid gap-3 md:grid-cols-2"},bt={class:"mt-3"},yt={class:"mt-4 flex justify-end gap-2 text-[11px]"},ft=["disabled"],St={__name:"HostelPayments",props:{payments:{type:Array,default:()=>[]}},setup(T){const v=T,m=y("All"),_=P(()=>m.value==="All"?v.payments:v.payments.filter(l=>l.status===m.value)),d=l=>{if(l==null)return"-";try{return Number(l).toLocaleString()}catch{return l}},g=y(!1),r=y(null),o=U({allocation_id:"",amount:"",paid_on:"",method:"Cash",reference:"",notes:""}),M=l=>{r.value=l,o.reset(),o.allocation_id=l.id,o.amount=l.balance||"";const e=new Date().toISOString().slice(0,10);o.paid_on=e,g.value=!0},w=()=>{g.value=!1,r.value=null},N=()=>{o.post(route("hostel-payments.store"),{preserveScroll:!0,onSuccess:()=>{g.value=!1,r.value=null}})},k=P(()=>{if(!r.value)return null;const l=Number(r.value.balance||0),e=Number(o.amount||0),s=l-e;return isNaN(s)?null:Math.max(s,0)});return(l,e)=>(p(),i(C,null,[f(a(V),{title:"Hostel Payments"}),f(H,null,{header:h(()=>[...e[6]||(e[6]=[t("div",{class:"flex flex-wrap items-center justify-between gap-3"},[t("div",null,[t("h2",{class:"text-2xl font-semibold leading-tight text-gray-800"}," Hostel Payments "),t("p",{class:"mt-1 text-sm text-gray-500"}," Track hostel fee payments and balances for boarding students. ")])],-1)])]),default:h(()=>[t("div",D,[l.$page.props.flash&&l.$page.props.flash.success?(p(),i("div",$,[t("div",R,[e[8]||(e[8]=t("span",{class:"mt-0.5 text-emerald-600"},"✔",-1)),t("div",null,[e[7]||(e[7]=t("p",{class:"font-semibold"},"Saved",-1)),t("p",z,n(l.$page.props.flash.success),1)])])])):c("",!0),t("div",O,[t("div",E,[e[10]||(e[10]=t("label",{class:"text-[11px] font-medium text-gray-600"},"Filter by status",-1)),u(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>m.value=s),class:"rounded-md border border-gray-300 bg-white px-3 py-1.5 text-[11px] text-gray-700 shadow-sm focus:border-emerald-500 focus:outline-none focus:ring-emerald-500"},[...e[9]||(e[9]=[t("option",{value:"All"},"All",-1),t("option",{value:"Paid"},"Paid",-1),t("option",{value:"Partial"},"Partial",-1),t("option",{value:"Unpaid"},"Unpaid",-1)])],512),[[A,m.value]])])]),t("div",I,[t("table",L,[e[13]||(e[13]=t("thead",null,[t("tr",{class:"border-b border-gray-200 bg-gray-50 text-[11px] font-semibold uppercase tracking-wide text-gray-500"},[t("th",{class:"px-3 py-2"},"#"),t("th",{class:"px-3 py-2"},"Student"),t("th",{class:"px-3 py-2"},"Class"),t("th",{class:"px-3 py-2"},"Hostel"),t("th",{class:"px-3 py-2 text-right"},"Amount"),t("th",{class:"px-3 py-2 text-right"},"Paid"),t("th",{class:"px-3 py-2 text-right"},"Balance"),t("th",{class:"px-3 py-2"},"Status"),t("th",{class:"px-3 py-2 text-right"},"Actions")])],-1)),t("tbody",null,[_.value.length?c("",!0):(p(),i("tr",q,[...e[11]||(e[11]=[t("td",{colspan:"9",class:"px-3 py-6 text-center text-[11px] text-gray-400"}," No hostel payments recorded yet. ",-1)])])),(p(!0),i(C,null,B(_.value,(s,S)=>(p(),i("tr",{key:s.id||S,class:"border-b border-gray-100 text-[11px] text-gray-700 hover:bg-gray-50"},[t("td",G,n(S+1),1),t("td",J,n(s.student_name||"-"),1),t("td",K,n(s.class_name||"-"),1),t("td",Q,n(s.hostel_name||"-"),1),t("td",W,"TSh "+n(d(s.amount)),1),t("td",X,"TSh "+n(d(s.paid)),1),t("td",Y,"TSh "+n(d(s.balance)),1),t("td",Z,[t("span",{class:j(["inline-flex rounded-full px-2 py-0.5 text-[10px] font-semibold",{"bg-emerald-50 text-emerald-700":s.status==="Paid","bg-amber-50 text-amber-700":s.status==="Partial","bg-rose-50 text-rose-700":!s.status||s.status==="Unpaid"}])},n(s.status||"Unpaid"),3)]),t("td",tt,[t("div",et,[t("button",{type:"button",class:"inline-flex items-center rounded-md bg-white px-2 py-1 text-[10px] font-semibold text-emerald-700 ring-1 ring-emerald-200 hover:bg-emerald-50",onClick:ht=>M(s)}," Add payment ",8,st),f(a(F),{href:l.route("hostel-payments.receipt",s.id),class:"inline-flex items-center rounded-md bg-white px-2 py-1 text-[10px] font-semibold text-indigo-600 ring-1 ring-indigo-200 hover:bg-indigo-50"},{default:h(()=>[...e[12]||(e[12]=[x(" Receipt ",-1)])]),_:1},8,["href"])])])]))),128))])])])]),g.value&&r.value?(p(),i("div",ot,[t("div",lt,[t("div",{class:"mb-3 flex items-start justify-between gap-4 border-b border-gray-100 pb-3"},[e[14]||(e[14]=t("div",null,[t("h3",{class:"text-sm font-semibold text-emerald-800"}," Record Hostel Payment "),t("p",{class:"mt-1 text-[11px] text-gray-500"}," Enter payment details for this student. Status and balances will update automatically. ")],-1)),t("button",{type:"button",class:"inline-flex h-6 w-6 items-center justify-center rounded-full bg-gray-100 text-[11px] font-bold text-gray-600 hover:bg-gray-200",onClick:w}," × ")]),t("div",at,[t("p",nt,n(r.value.student_name||"-"),1),t("p",rt," Hostel: "+n(r.value.hostel_name||"-"),1),t("p",dt,[e[15]||(e[15]=x(" Total: ",-1)),t("span",it,"TSh "+n(d(r.value.amount)),1),e[16]||(e[16]=x("  |  Paid: ",-1)),t("span",pt,"TSh "+n(d(r.value.paid)),1),e[17]||(e[17]=x("  |  Balance: ",-1)),t("span",ut,"TSh "+n(d(r.value.balance)),1)]),k.value!==null?(p(),i("p",xt,[e[18]||(e[18]=x(" After this payment, new balance will be: ",-1)),t("span",mt,"TSh "+n(d(k.value)),1)])):c("",!0)]),t("div",gt,[t("div",null,[e[19]||(e[19]=t("label",{class:"text-[11px] font-medium text-gray-600"},"Amount (TSh)",-1)),u(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>a(o).amount=s),type:"number",min:"1",class:"mt-1 w-full rounded-md border border-gray-300 px-3 py-1.5 text-[11px] text-gray-800 shadow-sm focus:border-emerald-500 focus:outline-none focus:ring-emerald-500"},null,512),[[b,a(o).amount,void 0,{number:!0}]])]),t("div",null,[e[20]||(e[20]=t("label",{class:"text-[11px] font-medium text-gray-600"},"Date paid",-1)),u(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>a(o).paid_on=s),type:"date",class:"mt-1 w-full rounded-md border border-gray-300 px-3 py-1.5 text-[11px] text-gray-800 shadow-sm focus:border-emerald-500 focus:outline-none focus:ring-emerald-500"},null,512),[[b,a(o).paid_on]])])]),t("div",ct,[t("div",null,[e[22]||(e[22]=t("label",{class:"text-[11px] font-medium text-gray-600"},"Method",-1)),u(t("select",{"onUpdate:modelValue":e[3]||(e[3]=s=>a(o).method=s),class:"mt-1 w-full rounded-md border border-gray-300 bg-white px-3 py-1.5 text-[11px] text-gray-800 shadow-sm focus:border-emerald-500 focus:outline-none focus:ring-emerald-500"},[...e[21]||(e[21]=[t("option",{value:"Cash"},"Cash",-1),t("option",{value:"Bank"},"Bank",-1),t("option",{value:"Mobile Money"},"Mobile Money",-1),t("option",{value:"Other"},"Other",-1)])],512),[[A,a(o).method]])]),t("div",null,[e[23]||(e[23]=t("label",{class:"text-[11px] font-medium text-gray-600"},"Reference (optional)",-1)),u(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>a(o).reference=s),type:"text",class:"mt-1 w-full rounded-md border border-gray-300 px-3 py-1.5 text-[11px] text-gray-800 shadow-sm focus:border-emerald-500 focus:outline-none focus:ring-emerald-500",placeholder:"Receipt no. / Tx ID"},null,512),[[b,a(o).reference]])])]),t("div",bt,[e[24]||(e[24]=t("label",{class:"text-[11px] font-medium text-gray-600"},"Notes (optional)",-1)),u(t("textarea",{"onUpdate:modelValue":e[5]||(e[5]=s=>a(o).notes=s),rows:"2",class:"mt-1 w-full resize-none rounded-md border border-gray-300 px-3 py-1.5 text-[11px] text-gray-800 shadow-sm focus:border-emerald-500 focus:outline-none focus:ring-emerald-500",placeholder:"Any additional details about this payment."},null,512),[[b,a(o).notes]])]),t("div",yt,[t("button",{type:"button",class:"rounded-md bg-gray-50 px-3 py-1.5 font-medium text-gray-700 ring-1 ring-gray-200 hover:bg-gray-100",onClick:w}," Cancel "),t("button",{type:"button",class:"rounded-md bg-emerald-600 px-3 py-1.5 font-semibold text-white shadow-sm hover:bg-emerald-700 disabled:cursor-not-allowed disabled:opacity-60",disabled:a(o).processing||!a(o).amount||!a(o).paid_on||!a(o).method,onClick:N}," Save payment ",8,ft)])])])):c("",!0)]),_:1})],64))}};export{St as default};

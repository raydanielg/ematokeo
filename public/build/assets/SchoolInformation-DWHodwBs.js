import{n as C,i as x,E as A,B as M,N as L,c as i,a as f,u as I,h as Y,w as V,d as v,b as t,o as a,k as d,s as D,v as u,t as $,p as U,f as T,F as E,r as z,e as P,m as j}from"./app-BcZSGutu.js";import{_ as G}from"./AuthenticatedLayout-BUHB3P0T.js";import{_ as h}from"./Alert-BVWT0qCM.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const R={key:0,class:"pointer-events-none fixed right-4 top-4 z-50 w-full max-w-sm"},q={class:"pointer-events-auto"},H={class:"space-y-6"},W={class:"grid gap-6 md:grid-cols-2"},J={class:"rounded-xl bg-white p-4 shadow-sm ring-1 ring-gray-100"},K={class:"w-full text-left text-xs"},Q={class:"border-b border-gray-100"},X={class:"px-2 py-2"},Z={key:0,class:"mt-1 text-[10px] text-red-600"},ee={class:"border-b border-gray-100"},te={class:"px-2 py-2"},se={class:"border-b border-gray-100"},oe={class:"px-2 py-2"},re={class:"border-b border-gray-100"},le={class:"px-2 py-2"},ne={class:"px-2 py-2"},ae={class:"rounded-xl bg-white p-4 shadow-sm ring-1 ring-gray-100"},de={class:"w-full text-left text-xs"},ie={class:"border-b border-gray-100"},ue={class:"px-2 py-2"},pe={class:"border-b border-gray-100"},me={class:"px-2 py-2"},ce={class:"border-b border-gray-100"},ge={class:"px-2 py-2"},xe={class:"border-b border-gray-100"},fe={class:"px-2 py-2"},ye={class:"border-b border-gray-100"},be={class:"px-2 py-2"},ve={class:"px-2 py-2"},he={class:"grid grid-cols-2 gap-2"},we={class:"rounded-xl bg-white p-4 shadow-sm ring-1 ring-gray-100"},Se={key:0,class:"flex flex-wrap gap-1"},_e=["onClick"],ke={key:1,class:"text-[11px] text-gray-400"},Ce={class:"space-y-2"},je={class:"flex items-center justify-between gap-3"},Be=["disabled"],Ve={key:0},$e={key:1},Ue={class:"max-w-md"},Te={key:0,class:"pointer-events-auto fixed inset-0 z-40 flex items-center justify-center bg-black/60 px-4 backdrop-blur-sm"},Ee={class:"flex w-full max-w-md flex-col items-center rounded-2xl bg-white p-6 text-center shadow-2xl ring-1 ring-emerald-100"},Pe={class:"mb-4 h-32 w-32"},Le={__name:"SchoolInformation",props:{school:{type:Object,default:()=>({})},subjects:{type:Array,default:()=>[]}},setup(w){const l=w,o=C({name:l.school.name||"",registration_number:l.school.registration_number||"",school_code:l.school.school_code||"",level:l.school.level||"",ownership:l.school.ownership||"",phone:l.school.phone||"",email:l.school.email||"",address:l.school.address||"",district:l.school.district||"",region:l.school.region||"",head_teacher_name:l.school.head_teacher_name||"",head_teacher_phone:l.school.head_teacher_phone||""}),B=C({}),y=x(!1),c=x(null),g=x(null),S=x(!1),m=x({}),p=C({show:!1,variant:"success",title:"",message:""});let _=null;const b=(r,e,k)=>{p.variant=r,p.title=e,p.message=k,p.show=!0,_&&clearTimeout(_),_=setTimeout(()=>{p.show=!1},3500)},N=A();M(()=>{(N.props.value.flash||{}).registration_success&&(S.value=!0)});const n=r=>{typeof o[r]=="string"&&!["level","ownership"].includes(r)&&(o[r]=o[r].toUpperCase()),B[r]=!0,m.value={},j.put(route("settings.school-information.update"),{[r]:o[r]},{preserveScroll:!0,onSuccess:()=>{b("success","Saved successfully","Your changes have been saved.")},onError:e=>{m.value=e,b("danger","Save failed","Please check the field and try again.")},onFinish:()=>{B[r]=!1}})},O=()=>{y.value=!0,c.value=null,g.value=null,m.value={};const r={...o};Object.keys(r).forEach(e=>{typeof r[e]=="string"&&!["level","ownership"].includes(e)&&(r[e]=r[e].toUpperCase())}),j.put(route("settings.school-information.update"),r,{preserveScroll:!0,onSuccess:()=>{c.value="success",g.value=null,b("success","Saved successfully","Your school information has been saved.")},onError:e=>{c.value="error",m.value=e,e.name&&(g.value=e.name[0]),b("danger","Save failed",g.value||"Something went wrong while saving. Please check the fields and try again.")},onFinish:()=>{y.value=!1}})},F=r=>{confirm("Delete this subject from the school?")&&j.delete(route("subjects.destroy",r),{preserveScroll:!0})};return(r,e)=>{const k=L("lottie-player");return a(),i(E,null,[f(I(Y),{title:"School Information"}),f(G,null,{header:V(()=>[...e[25]||(e[25]=[t("div",null,[t("h2",{class:"text-2xl font-semibold leading-tight text-gray-800"}," School Information "),t("p",{class:"mt-1 text-sm text-gray-500"}," Core details about your school used across E-Matokeo. You typically set this once and only update when something changes. ")],-1)])]),default:V(()=>[p.show?(a(),i("div",R,[t("div",q,[f(h,{variant:p.variant,title:p.title,message:p.message},null,8,["variant","title","message"])])])):v("",!0),t("div",H,[f(h,{variant:"info",title:"Fill in your school details",message:"This is the first step. These details are required so that exam numbers, reports, and other modules work correctly."}),t("div",W,[t("div",J,[e[33]||(e[33]=t("h3",{class:"mb-3 text-xs font-semibold uppercase tracking-wide text-gray-500"}," General Information ",-1)),t("table",K,[t("tbody",null,[t("tr",Q,[e[26]||(e[26]=t("td",{class:"w-1/3 px-2 py-2 font-medium text-gray-600"}," School Name ",-1)),t("td",X,[t("div",null,[d(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>o.name=s),onBlur:e[1]||(e[1]=s=>n("name")),type:"text",class:D(["w-full rounded-md border px-2 py-1.5 text-xs focus:outline-none focus:ring-emerald-500",m.value.name?"border-red-400 focus:border-red-500":"border-gray-200 focus:border-emerald-500"]),placeholder:"e.g. Mlimani Secondary School"},null,34),[[u,o.name]]),m.value.name?(a(),i("p",Z,$(m.value.name[0]),1)):v("",!0)])])]),t("tr",ee,[e[27]||(e[27]=t("td",{class:"px-2 py-2 font-medium text-gray-600"}," Registration No. ",-1)),t("td",te,[d(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>o.registration_number=s),onBlur:e[3]||(e[3]=s=>n("registration_number")),type:"text",class:"w-full rounded-md border border-gray-200 px-2 py-1.5 text-xs focus:border-emerald-500 focus:outline-none focus:ring-emerald-500",placeholder:"NECTA / EMIS number"},null,544),[[u,o.registration_number]])])]),t("tr",se,[e[28]||(e[28]=t("td",{class:"px-2 py-2 font-medium text-gray-600"}," School Code ",-1)),t("td",oe,[d(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>o.school_code=s),onBlur:e[5]||(e[5]=s=>n("school_code")),type:"text",class:"w-full rounded-md border border-gray-200 px-2 py-1.5 text-xs focus:border-emerald-500 focus:outline-none focus:ring-emerald-500",placeholder:"Used to build exam numbers"},null,544),[[u,o.school_code]])])]),t("tr",re,[e[30]||(e[30]=t("td",{class:"px-2 py-2 font-medium text-gray-600"}," Level ",-1)),t("td",le,[d(t("select",{"onUpdate:modelValue":e[6]||(e[6]=s=>o.level=s),onChange:e[7]||(e[7]=s=>n("level")),class:"w-full rounded-md border border-gray-200 px-2 py-1.5 text-xs focus:border-emerald-500 focus:outline-none focus:ring-emerald-500"},[...e[29]||(e[29]=[t("option",{value:"",disabled:""},"Select level",-1),t("option",{value:"Primary"},"Primary",-1),t("option",{value:"O-Level"},"O-Level (Secondary)",-1),t("option",{value:"A-Level"},"A-Level (Secondary)",-1)])],544),[[U,o.level]])])]),t("tr",null,[e[32]||(e[32]=t("td",{class:"px-2 py-2 font-medium text-gray-600"}," Ownership ",-1)),t("td",ne,[d(t("select",{"onUpdate:modelValue":e[8]||(e[8]=s=>o.ownership=s),onChange:e[9]||(e[9]=s=>n("ownership")),class:"w-full rounded-md border border-gray-200 px-2 py-1.5 text-xs focus:border-emerald-500 focus:outline-none focus:ring-emerald-500"},[...e[31]||(e[31]=[t("option",{value:"",disabled:""},"Select ownership",-1),t("option",{value:"Government"},"Government",-1),t("option",{value:"Private"},"Private",-1),t("option",{value:"Faith-Based"},"Faith-Based",-1),t("option",{value:"Community"},"Community",-1),t("option",{value:"Other"},"Other",-1)])],544),[[U,o.ownership]])])])])])]),t("div",ae,[e[40]||(e[40]=t("h3",{class:"mb-3 text-xs font-semibold uppercase tracking-wide text-gray-500"}," Contact & Location ",-1)),t("table",de,[t("tbody",null,[t("tr",ie,[e[34]||(e[34]=t("td",{class:"w-1/3 px-2 py-2 font-medium text-gray-600"}," Phone ",-1)),t("td",ue,[d(t("input",{"onUpdate:modelValue":e[10]||(e[10]=s=>o.phone=s),onBlur:e[11]||(e[11]=s=>n("phone")),type:"text",class:"w-full rounded-md border border-gray-200 px-2 py-1.5 text-xs focus:border-emerald-500 focus:outline-none focus:ring-emerald-500",placeholder:"Main school contact number"},null,544),[[u,o.phone]])])]),t("tr",pe,[e[35]||(e[35]=t("td",{class:"px-2 py-2 font-medium text-gray-600"}," Email ",-1)),t("td",me,[d(t("input",{"onUpdate:modelValue":e[12]||(e[12]=s=>o.email=s),onBlur:e[13]||(e[13]=s=>n("email")),type:"email",class:"w-full rounded-md border border-gray-200 px-2 py-1.5 text-xs focus:border-emerald-500 focus:outline-none focus:ring-emerald-500",placeholder:"Official school email"},null,544),[[u,o.email]])])]),t("tr",ce,[e[36]||(e[36]=t("td",{class:"px-2 py-2 font-medium text-gray-600"}," Address ",-1)),t("td",ge,[d(t("input",{"onUpdate:modelValue":e[14]||(e[14]=s=>o.address=s),onBlur:e[15]||(e[15]=s=>n("address")),type:"text",class:"w-full rounded-md border border-gray-200 px-2 py-1.5 text-xs focus:border-emerald-500 focus:outline-none focus:ring-emerald-500",placeholder:"P.O. Box / Street"},null,544),[[u,o.address]])])]),t("tr",xe,[e[37]||(e[37]=t("td",{class:"px-2 py-2 font-medium text-gray-600"}," District ",-1)),t("td",fe,[d(t("input",{"onUpdate:modelValue":e[16]||(e[16]=s=>o.district=s),onBlur:e[17]||(e[17]=s=>n("district")),type:"text",class:"w-full rounded-md border border-gray-200 px-2 py-1.5 text-xs focus:border-emerald-500 focus:outline-none focus:ring-emerald-500",placeholder:"e.g. Ilala"},null,544),[[u,o.district]])])]),t("tr",ye,[e[38]||(e[38]=t("td",{class:"px-2 py-2 font-medium text-gray-600"}," Region ",-1)),t("td",be,[d(t("input",{"onUpdate:modelValue":e[18]||(e[18]=s=>o.region=s),onBlur:e[19]||(e[19]=s=>n("region")),type:"text",class:"w-full rounded-md border border-gray-200 px-2 py-1.5 text-xs focus:border-emerald-500 focus:outline-none focus:ring-emerald-500",placeholder:"e.g. Dar es Salaam"},null,544),[[u,o.region]])])]),t("tr",null,[e[39]||(e[39]=t("td",{class:"px-2 py-2 font-medium text-gray-600"}," Head Teacher ",-1)),t("td",ve,[t("div",he,[d(t("input",{"onUpdate:modelValue":e[20]||(e[20]=s=>o.head_teacher_name=s),onBlur:e[21]||(e[21]=s=>n("head_teacher_name")),type:"text",class:"w-full rounded-md border border-gray-200 px-2 py-1.5 text-xs focus:border-emerald-500 focus:outline-none focus:ring-emerald-500",placeholder:"Full name"},null,544),[[u,o.head_teacher_name]]),d(t("input",{"onUpdate:modelValue":e[22]||(e[22]=s=>o.head_teacher_phone=s),onBlur:e[23]||(e[23]=s=>n("head_teacher_phone")),type:"text",class:"w-full rounded-md border border-gray-200 px-2 py-1.5 text-xs focus:border-emerald-500 focus:outline-none focus:ring-emerald-500",placeholder:"Phone number"},null,544),[[u,o.head_teacher_phone]])])])])])])])]),t("div",we,[e[41]||(e[41]=t("h3",{class:"mb-2 text-xs font-semibold uppercase tracking-wide text-gray-500"}," Subjects Offered ",-1)),e[42]||(e[42]=t("p",{class:"mb-2 text-[11px] text-gray-500"},[T(" These are the subjects configured for this school. You can remove a subject by clicking the small "),t("span",{class:"font-semibold"},"×"),T(" icon on the chip. To add more, use the Subjects settings pages. ")],-1)),w.subjects.length?(a(),i("div",Se,[(a(!0),i(E,null,z(w.subjects,s=>(a(),i("span",{key:s.id,class:"inline-flex items-center gap-1 rounded-full bg-emerald-50 px-2 py-0.5 text-[11px] font-medium text-emerald-800 ring-1 ring-emerald-100"},[t("span",null,$(s.subject_code),1),t("button",{type:"button",class:"text-[11px] text-emerald-500 hover:text-red-600",onClick:Ne=>F(s.id)}," × ",8,_e)]))),128))])):(a(),i("div",ke," No subjects configured yet. Start by adding subjects under the Subjects section. "))]),t("div",Ce,[t("div",je,[e[43]||(e[43]=t("p",{class:"text-[11px] text-gray-500"}," Changes are saved inline when you leave a field (on blur). You can also click Save below to store everything at once. ",-1)),t("button",{type:"button",class:"inline-flex items-center justify-center rounded-md bg-emerald-600 px-4 py-2 text-xs font-semibold text-white shadow-sm hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-60",disabled:y.value,onClick:O},[y.value?(a(),i("span",Ve,"Saving...")):(a(),i("span",$e,"Save"))],8,Be)]),t("div",Ue,[c.value==="success"?(a(),P(h,{key:0,variant:"success",title:"Saved successfully",message:"Your school information has been saved."})):c.value==="error"?(a(),P(h,{key:1,variant:"danger",title:"Save failed",message:g.value||"Something went wrong while saving. Please check the fields and try again."},null,8,["message"])):v("",!0)])]),S.value?(a(),i("div",Te,[t("div",Ee,[t("div",Pe,[f(k,{src:"/success.json",background:"transparent",speed:"1",style:{width:"100%",height:"100%"},autoplay:""})]),e[44]||(e[44]=t("h2",{class:"mb-1 text-lg font-semibold text-gray-900"}," Account created successfully ",-1)),e[45]||(e[45]=t("p",{class:"mb-4 text-xs text-gray-500"}," Welcome to E-Matokeo. Next, please fill in your school details so that exams and reports work correctly. ",-1)),t("button",{type:"button",class:"inline-flex items-center justify-center rounded-md bg-emerald-600 px-4 py-2 text-xs font-semibold text-white shadow-sm hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:ring-offset-2",onClick:e[24]||(e[24]=s=>S.value=!1)}," Continue ")])])):v("",!0)])]),_:1})],64)}}};export{Le as default};

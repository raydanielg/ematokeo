import{E as ot,j as A,i as p,I as be,c as a,a as O,u as re,h as nt,w as Ee,d as u,b as e,o,f as K,t as n,k as b,F as h,r as _,p as U,v as S,s as R,x as rt,m as V}from"./app-DiZpD1QT.js";import{_ as dt}from"./AuthenticatedLayout-8s8Aoywo.js";import{c as Me,P as it,T as ut}from"./trash-2-D88qWl2p.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";/**
 * @license lucide-vue-next v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mt=Me("ClipboardListIcon",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-vue-next v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pt=Me("EyeIcon",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),ct={class:"flex items-center justify-between"},gt={class:"flex items-center gap-2"},xt=["value"],vt={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 px-4 py-6"},bt={class:"w-full max-w-sm overflow-hidden rounded-2xl bg-white shadow-2xl ring-1 ring-black/5"},yt={class:"border-b border-gray-100 bg-gradient-to-r from-red-50 to-white px-5 py-4"},ft={class:"mt-1 text-[11px] text-gray-600"},ht={class:"font-semibold text-gray-800"},_t={class:"px-5 py-4"},wt={class:"flex items-center justify-between rounded-lg bg-gray-50 px-3 py-2 text-[11px] text-gray-700 ring-1 ring-gray-100"},kt={class:"font-mono"},St={class:"mt-4 flex justify-end gap-2 text-xs"},Ct=["disabled"],jt=["disabled"],At={key:0},Dt={key:1},Bt={key:1,class:"fixed inset-0 z-40 flex items-center justify-center bg-black/40 px-4 py-6"},Ut={class:"w-full max-w-sm rounded-xl bg-white p-5 shadow-xl"},Et={class:"mb-4 text-xs text-gray-600"},Mt={class:"flex justify-end gap-2 text-xs"},$t=["disabled"],Vt={key:0},Pt={key:1},Nt={key:2,class:"pointer-events-none fixed inset-0 z-50 flex items-start justify-center pt-16"},zt={class:"pointer-events-auto rounded-md bg-emerald-600 px-4 py-2 text-xs font-medium text-white shadow-lg"},Ft={key:3,class:"fixed inset-0 z-30 flex items-center justify-center bg-black/40 px-4 py-6"},Rt={class:"w-full max-w-sm rounded-xl bg-white p-5 shadow-xl"},Xt={class:"mb-3 flex items-center justify-between"},Lt={class:"space-y-3 text-xs text-gray-700"},It=["value"],Tt={class:"mt-4 flex justify-end gap-2"},Gt=["disabled"],Ot={key:0},Kt={key:1},qt={class:"rounded-xl bg-white p-5 shadow-sm ring-1 ring-gray-100"},Ht={class:"mb-3 flex items-center justify-between gap-3"},Jt={class:"text-sm font-medium text-gray-700"},Wt={class:"flex items-center gap-2"},Yt=["disabled"],Zt={key:0},Qt={key:1},es={class:"overflow-x-auto"},ts={class:"min-w-full text-left text-sm"},ss={class:"border-b border-gray-200 bg-gray-50 text-xs font-semibold uppercase tracking-wide text-gray-500"},ls={class:"px-3 py-2"},as=["checked"],os={class:"px-3 py-2"},ns={class:"text-[10px] text-gray-400"},rs={class:"px-3 py-2"},ds={class:"text-[10px] text-gray-400"},is={class:"px-3 py-2"},us={class:"text-[10px] text-gray-400"},ms={class:"px-3 py-2"},ps={class:"text-[10px] text-gray-400"},cs={class:"px-3 py-2"},gs={class:"text-[10px] text-gray-400"},xs={class:"bg-gray-50 text-xs font-semibold text-gray-700"},vs={class:"px-3 py-2",colspan:"9"},bs={class:"flex items-center justify-between"},ys={class:"text-[11px] font-medium text-gray-500"},fs={class:"px-3 py-2 align-top"},hs=["checked","onChange"],_s={class:"px-3 py-2 align-top text-xs text-gray-500"},ws={class:"px-3 py-2 align-top font-mono text-xs text-gray-900"},ks={class:"px-3 py-2 align-top"},Ss={class:"font-medium text-gray-900"},Cs={class:"px-3 py-2 align-top"},js={class:"font-medium text-gray-800"},As={class:"px-3 py-2 align-top"},Ds={class:"font-medium text-gray-800"},Bs={class:"px-3 py-2 align-top"},Us={class:"flex flex-wrap gap-1"},Es={key:1,class:"text-[11px] text-gray-400"},Ms={class:"px-3 py-2 align-top"},$s={class:"px-3 py-2 align-top"},Vs={class:"flex justify-end gap-2"},Ps=["onClick"],Ns=["onClick"],zs=["onClick"],Fs=["onClick"],Rs={key:4,class:"fixed inset-0 z-30 flex items-center justify-center bg-black/40 px-4 py-6"},Xs={class:"w-full max-w-md rounded-xl bg-white p-5 shadow-xl"},Ls={class:"mb-4 flex items-center justify-between"},Is={class:"space-y-3 text-xs text-gray-700"},Ts={key:0,class:"mt-1 text-[11px] font-medium text-red-600"},Gs={class:"grid grid-cols-2 gap-3"},Os=["value"],Ks={key:0,class:"mt-1 text-[11px] font-medium text-red-600"},qs={key:0},Hs=["value"],Js={key:0,class:"mt-1 text-[11px] text-red-600"},Ws={key:1,class:"text-[11px] text-gray-500"},Ys={key:0,class:"mt-1 text-[11px] font-medium text-red-600"},Zs={class:"mt-4 flex justify-end gap-2"},Qs=["disabled"],el={key:0},tl={key:1},sl={key:5,class:"fixed inset-0 z-30 flex items-center justify-center bg-black/40 px-4 py-6"},ll={class:"w-full max-w-6xl rounded-xl bg-white p-5 shadow-xl"},al={class:"mb-4 flex flex-wrap gap-2 border-b border-gray-100 pb-3 text-[11px]"},ol={key:0,class:"grid gap-4 md:grid-cols-2 text-xs text-gray-700"},nl={class:"space-y-2"},rl={class:"space-y-1"},dl={class:"flex justify-between"},il={class:"text-gray-800"},ul={class:"flex justify-between"},ml={class:"font-mono text-gray-800"},pl={class:"flex justify-between"},cl={class:"text-gray-800"},gl={key:0},xl={class:"flex justify-between"},vl={class:"text-gray-800"},bl={class:"flex justify-between"},yl={class:"text-gray-800"},fl={class:"space-y-1"},hl={class:"flex justify-between"},_l={class:"text-gray-800"},wl={class:"flex justify-between"},kl={class:"text-gray-800"},Sl={class:"flex justify-between gap-4"},Cl={class:"text-right text-gray-800"},jl={class:"space-y-2"},Al={class:"mb-2 flex flex-wrap gap-1"},Dl={key:1,class:"text-[11px] text-gray-400"},Bl={key:1,class:"space-y-3 text-xs text-gray-700"},Ul={class:"overflow-hidden rounded-lg border border-gray-200 bg-white"},El={id:"student-results-preview"},Ml={class:"border-b border-gray-200 bg-gray-50 px-3 py-2"},$l={class:"flex items-center justify-between gap-2"},Vl={class:"flex items-center gap-2"},Pl=["value"],Nl={class:"mt-2 flex flex-wrap items-center justify-between gap-2 text-[10px] text-gray-600"},zl={class:"ml-1 text-gray-800"},Fl={class:"ml-1 font-mono text-gray-800"},Rl={class:"mt-1 flex flex-wrap items-center justify-between gap-2 text-[10px] text-gray-600"},Xl={class:"ml-1 text-gray-800"},Ll={key:0},Il={class:"px-3 py-2"},Tl={class:"w-full border-collapse text-[11px]"},Gl={key:0,class:"text-gray-500"},Ol={key:1,class:"text-red-600"},Kl={colspan:"3",class:"border-t border-gray-100 px-2 py-2 text-center"},ql={key:2,class:"text-gray-500"},Hl={class:"border-t border-gray-100 px-2 py-1"},Jl={class:"border-t border-gray-100 px-2 py-1 text-center"},Wl={class:"border-t border-gray-100 px-2 py-1 text-center"},Yl={key:0,class:"mt-2 flex justify-between text-[10px] text-gray-600"},Zl={class:"ml-1"},Ql={class:"ml-1"},ea={key:2,class:"space-y-3 text-xs text-gray-700"},ta={class:"flex items-center justify-between"},sa={class:"flex items-center gap-2"},la={key:0,class:"text-[11px] font-medium text-red-600"},aa={class:"overflow-hidden rounded-md border border-gray-200"},oa={class:"w-full border-collapse text-[11px]"},na={key:0,class:"text-gray-500"},ra={class:"border-t border-gray-100 px-2 py-1 font-mono"},da={class:"border-t border-gray-100 px-2 py-1"},ia={class:"border-t border-gray-100 px-2 py-1 text-center font-semibold"},ua={class:"border-t border-gray-100 px-2 py-1"},ma={key:6,class:"fixed inset-0 z-30 flex items-center justify-center bg-black/40 px-4 py-6"},pa={class:"w-full max-w-6xl rounded-xl bg-white p-5 shadow-xl"},ca={class:"mb-3 flex items-center justify-between"},ga={class:"mt-0.5 text-[11px] text-gray-500"},xa={class:"mb-3 flex flex-wrap items-center justify-between gap-2 text-[11px]"},va={class:"text-gray-600"},ba={class:"ml-1 font-mono"},ya={class:"ml-1"},fa={class:"flex flex-wrap items-center gap-2"},ha={class:"flex items-center gap-2"},_a={key:0,class:"mb-2 text-[11px] font-medium text-red-600"},wa={class:"overflow-hidden rounded-md border border-gray-200"},ka={class:"w-full border-collapse text-[11px]"},Sa={key:0,class:"text-gray-500"},Ca={class:"border-t border-gray-100 px-2 py-1 font-mono"},ja={class:"border-t border-gray-100 px-2 py-1"},Aa={class:"border-t border-gray-100 px-2 py-1 text-center"},Da={class:"inline-flex overflow-hidden rounded-md ring-1 ring-gray-200"},Ba=["onClick"],Ua=["onClick"],Ea=["onClick"],Ma=["onClick"],$a={class:"border-t border-gray-100 px-2 py-1"},Va=["onUpdate:modelValue"],Pa={class:"mt-4 flex justify-end gap-2"},Na=["disabled"],za={key:0},Fa={key:1},Ra={key:7,class:"fixed inset-0 z-30 flex items-center justify-center bg-black/40 px-4 py-6"},Xa={class:"w-full max-w-2xl overflow-hidden rounded-2xl bg-white shadow-2xl ring-1 ring-black/5"},La={class:"flex items-start justify-between border-b border-gray-100 bg-gradient-to-r from-emerald-50 to-white px-5 py-4"},Ia={class:"mt-1 flex flex-wrap items-center gap-2 text-[11px] text-gray-600"},Ta={class:"rounded-full bg-white px-2 py-0.5 font-mono text-gray-700 ring-1 ring-gray-200"},Ga={class:"font-medium text-gray-700"},Oa={class:"grid gap-3 md:grid-cols-2"},Ka={class:"md:col-span-2"},qa={key:0,class:"mt-1 text-[11px] font-medium text-red-600"},Ha=["value"],Ja={key:0,class:"mt-1 text-[11px] font-medium text-red-600"},Wa={key:0},Ya=["value"],Za={key:0,class:"mt-1 text-[11px] font-medium text-red-600"},Qa={key:1,class:"rounded-md border border-dashed border-gray-200 bg-gray-50 px-3 py-2 text-[11px] text-gray-500"},eo={class:"md:col-span-2"},to={class:"flex flex-wrap gap-1"},so={key:1,class:"text-[11px] text-gray-400"},lo={key:0,class:"mt-1 text-[11px] font-medium text-red-600"},ao={key:0,class:"mt-1 text-[11px] font-medium text-red-600"},oo={class:"rounded-xl border border-gray-100 bg-gray-50 p-3"},no={class:"grid gap-3 md:grid-cols-2"},ro={key:0,class:"mt-1 text-[11px] font-medium text-red-600"},io={key:0,class:"mt-1 text-[11px] font-medium text-red-600"},uo={class:"md:col-span-2"},mo={key:0,class:"mt-1 text-[11px] font-medium text-red-600"},po={class:"flex flex-wrap gap-1"},co={key:1,class:"text-[11px] text-gray-400"},go={class:"flex items-center justify-end gap-2 border-t border-gray-100 pt-4"},xo=["disabled"],vo={key:0},bo={key:1},yo={key:8,class:"fixed inset-0 z-30 flex items-center justify-center bg-black/40 px-4 py-6"},fo={class:"w-full max-w-xl rounded-xl bg-white p-5 shadow-xl"},ho={class:"mb-4 flex items-center justify-between"},_o={class:"mt-4 flex justify-between gap-2"},wo={class:"flex gap-2"},Ao={__name:"Students",props:{students:{type:Array,default:()=>[]},classes:{type:Array,default:()=>[]},classSubjects:{type:Object,default:()=>({})},streamSubjects:{type:Object,default:()=>({})},filters:{type:Object,default:()=>({class:null})},exams:{type:Array,default:()=>[]},streamsByClass:{type:Object,default:()=>({})}},setup(P){var Ue;const x=P,ce=ot(),ye=A(()=>ce.props.flash&&ce.props.flash.success?ce.props.flash.success:""),q=p(!1),de=p(!1),H=p(!1),J=p(!1),W=p(!1),Y=p(!1),ie=p(!1),ue=p(!1),r=p(null),Z=p(!1),Q=p(!1),j=p({}),f=p({}),D=p(null),X=p(!1),w=p([]),N=p(!1),B=p("personal"),ge=p(!1),c=p({full_name:"",class_level:"",stream:"",gender:"",date_of_birth:"",guardian_name:"",guardian_phone:"",guardian_address:""}),i=p({full_name:"",class_level:"",stream:"",gender:"",date_of_birth:"",guardian_name:"",guardian_phone:"",guardian_address:""}),L=A(()=>{const l=String(i.value.class_level||"").trim(),t=x.streamsByClass&&Object.prototype.hasOwnProperty.call(x.streamsByClass,l)?x.streamsByClass[l]:[];return Array.isArray(t)?t:[]}),I=A(()=>{const l=String(c.value.class_level||"").trim(),t=x.streamsByClass&&Object.prototype.hasOwnProperty.call(x.streamsByClass,l)?x.streamsByClass[l]:[];return Array.isArray(t)?t:[]}),$e=A(()=>!!String(c.value.class_level||"").trim()&&(!I.value||I.value.length===0)),Ve=A(()=>!!String(i.value.class_level||"").trim()&&(!L.value||L.value.length===0)),fe=(l,t)=>{const d=String(l||"").trim(),m=String(t||"").trim();if(d&&m&&x.streamSubjects&&x.streamSubjects[d]&&x.streamSubjects[d][m]){const g=x.streamSubjects[d][m];if(Array.isArray(g)&&g.length)return g}if(d&&x.classSubjects&&x.classSubjects[d]){const g=x.classSubjects[d];if(Array.isArray(g))return g}return[]},T=A(()=>fe(i.value.class_level,i.value.stream));A(()=>fe(c.value.class_level,c.value.stream)),be(()=>i.value.class_level,()=>{L.value.length?i.value.stream&&!L.value.includes(i.value.stream)&&(i.value.stream=""):i.value.stream=""}),be(()=>c.value.class_level,()=>{I.value.length?c.value.stream&&!I.value.includes(c.value.stream)&&(c.value.stream=""):c.value.stream=""});const Pe=A(()=>{const l=new Map;return(x.students||[]).forEach(t=>{const d=String(t.class_level||"Unknown");l.has(d)||l.set(d,[]),l.get(d).push(t)}),Array.from(l.entries()).map(([t,d])=>({class_level:t,students:d}))}),G=p(""),ee=p(!1),z=p(String(((Ue=x.filters)==null?void 0:Ue.class)||""));be(()=>{var l;return(l=x.filters)==null?void 0:l.class},l=>{z.value=String(l||"")});const Ne=l=>{var d,m,g;const t=((d=l==null?void 0:l.target)==null?void 0:d.value)??z.value;z.value=String(t||""),V.get(route("students.index"),{class:t||null,sort:((m=x.filters)==null?void 0:m.sort)||null,dir:((g=x.filters)==null?void 0:g.dir)||null},{preserveState:!0,preserveScroll:!0,replace:!0})},he=A(()=>{var l;return String(((l=x.filters)==null?void 0:l.sort)||"").trim()}),_e=A(()=>{var l;return String(((l=x.filters)==null?void 0:l.dir)||"asc").toLowerCase()==="desc"?"desc":"asc"}),te=l=>he.value!==l?"":_e.value==="asc"?"▲":"▼",se=l=>{const t=he.value,d=_e.value,m=t===l&&d==="asc"?"desc":"asc";V.get(route("students.index"),{class:z.value?z.value:null,sort:l,dir:m},{preserveState:!0,preserveScroll:!0,replace:!0})},ze=l=>{const t=w.value.indexOf(l);t===-1?w.value.push(l):w.value.splice(t,1)},we=()=>x.students.length>0&&w.value.length===x.students.length,Fe=()=>{we()?w.value=[]:w.value=x.students.map(l=>l.id)},Re=()=>{!w.value.length||N.value||(N.value=!0,V.post(route("students.bulk-delete"),{ids:w.value},{preserveScroll:!0,onSuccess:()=>{w.value=[],ie.value=!1},onFinish:()=>{N.value=!1}}))},Xe=()=>{w.value.length&&(ie.value=!0)},Le=()=>{G.value="",H.value=!0},Ie=()=>{!G.value||ee.value||(ee.value=!0,V.post(route("students.import-samples"),{class_level:G.value},{preserveScroll:!0,onSuccess:()=>{H.value=!1},onFinish:()=>{ee.value=!1}}))},Te=l=>{r.value=l,J.value=!0,Y.value=!1,B.value="personal",ge.value=!1,E.value="",je(),pe("")},Ge=l=>{r.value=l,Y.value=!0,J.value=!1,ge.value=!0,k.value="",pe(k.value)},Oe=l=>{r.value=l,f.value={},i.value={full_name:(l==null?void 0:l.full_name)||"",class_level:(l==null?void 0:l.class_level)||"",stream:(l==null?void 0:l.stream)||"",gender:(l==null?void 0:l.gender)||"",date_of_birth:(l==null?void 0:l.date_of_birth)||"",guardian_name:(l==null?void 0:l.guardian_name)||"",guardian_phone:(l==null?void 0:l.guardian_phone)||"",guardian_address:(l==null?void 0:l.guardian_address)||""},W.value=!0},Ke=()=>{!r.value||Q.value||(Q.value=!0,f.value={},V.patch(route("students.update",r.value.id),{full_name:i.value.full_name,class_level:i.value.class_level,stream:i.value.stream||null,gender:i.value.gender||null,date_of_birth:i.value.date_of_birth||null,guardian_name:i.value.guardian_name||null,guardian_phone:i.value.guardian_phone||null,guardian_address:i.value.guardian_address||null},{preserveScroll:!0,onSuccess:()=>{r.value&&(r.value.full_name=i.value.full_name,r.value.class_level=i.value.class_level,r.value.stream=i.value.stream||null,r.value.gender=i.value.gender||null,r.value.date_of_birth=i.value.date_of_birth||null,r.value.guardian_name=i.value.guardian_name||null,r.value.guardian_phone=i.value.guardian_phone||null,r.value.guardian_address=i.value.guardian_address||null,r.value.subjects=T.value),W.value=!1},onError:l=>{f.value=l||{}},onFinish:()=>{Q.value=!1}}))},qe=l=>{l&&(D.value=l,ue.value=!0)},He=()=>{!D.value||X.value||(X.value=!0,V.post(route("students.bulk-delete"),{ids:[D.value.id]},{preserveScroll:!0,onSuccess:()=>{w.value=w.value.filter(l=>{var t;return l!==((t=D.value)==null?void 0:t.id)}),r.value&&r.value.id===D.value.id&&(J.value=!1,W.value=!1,Y.value=!1,r.value=null),ue.value=!1,D.value=null},onFinish:()=>{X.value=!1}}))},Je=()=>{ue.value=!1,D.value=null},We=()=>{c.value={full_name:"",class_level:"",stream:"",gender:"",date_of_birth:"",guardian_name:"",guardian_phone:"",guardian_address:""}},Ye=()=>{We(),j.value={},q.value=!0},Ze=()=>{Z.value||(Z.value=!0,j.value={},V.post(route("students.store"),{full_name:c.value.full_name,class_level:c.value.class_level,stream:c.value.stream||null,gender:c.value.gender||null,date_of_birth:c.value.date_of_birth||null,guardian_name:c.value.guardian_name||null,guardian_phone:c.value.guardian_phone||null,guardian_address:c.value.guardian_address||null},{preserveScroll:!0,onSuccess:()=>{q.value=!1,V.reload({only:["students"]})},onError:l=>{j.value=l||{}},onFinish:()=>{Z.value=!1}}))},ke=()=>{J.value=!1,E.value="",xe.value=null,M.value=null,le.value=[],ae.value="",k.value="",$.value=[],C.value=""},Se=()=>{Y.value=!1,ge.value=!1,k.value="",$.value=[],C.value=""},Ce=()=>{W.value=!1,f.value={}},E=p(""),le=p([]),xe=p(null),M=p(null),ve=p(!1),ae=p(""),je=async()=>{if(r.value){ae.value="",ve.value=!0;try{const l=new URLSearchParams;E.value&&l.set("exam",E.value);const t=route("students.results-preview",r.value.id)+(l.toString()?`?${l.toString()}`:""),d=await fetch(t,{credentials:"same-origin",headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});if(!d.ok)throw new Error(`Request failed (${d.status})`);const m=await d.json();xe.value=m.exam,M.value=m.summary,le.value=Array.isArray(m.results)?m.results:[],!E.value&&m.exam&&m.exam.id&&(E.value=String(m.exam.id))}catch{xe.value=null,M.value=null,le.value=[],ae.value="Could not load results preview."}finally{ve.value=!1}}},Qe=()=>{je()},Ae=()=>{pe(k.value)},k=p(""),$=p([]),oe=p(!1),ne=p(!1),C=p(""),et=[{code:"901",label:"Bidii ya Kazi"},{code:"902",label:"Mahudhurio Darasani"},{code:"903",label:"Kutunza mali za shule"},{code:"904",label:"Utii kazini/darasani"},{code:"905",label:"Uelewano na ushirikiano"},{code:"906",label:"Heshima kwa wote"},{code:"907",label:"Kumudu uongozi"},{code:"908",label:"Adabu"},{code:"909",label:"Kujua usafi binafsi"},{code:"910",label:"Kukubali ushauri"},{code:"911",label:"Kuthamini kazi"},{code:"912",label:"Kujituma"},{code:"913",label:"Kushiriki michezo"},{code:"914",label:"Sifa nzuri ya Ushawishi"}],De=l=>{const t=new Map;return(l||[]).forEach(d=>{t.set(String(d.code),{code:String(d.code),label:d.label,grade:d.grade,comment:d.comment||""})}),et.map(d=>{const m=t.get(String(d.code));return{code:d.code,label:d.label,grade:(m==null?void 0:m.grade)||"",comment:(m==null?void 0:m.comment)||""}})},Be=A(()=>k.value?$.value.every(l=>["A","B","C","D"].includes(String(l.grade||"").toUpperCase())):!1),tt={A:"Excellent",B:"Good",C:"Average",D:"Poor"},me=(l,t)=>{const d=String(t||"").toUpperCase(),m=(l==null?void 0:l._autoComment)||"",g=String((l==null?void 0:l.comment)||"");l.grade=d;const y=tt[d]||"";l._autoComment=y,(!g||g===m)&&(l.comment=y)},pe=async l=>{if(r.value){C.value="",oe.value=!0;try{const t=new URLSearchParams;l&&t.set("rated_date",l);const d=route("students.behaviour-ratings.index",r.value.id)+(t.toString()?`?${t.toString()}`:""),m=await fetch(d,{credentials:"same-origin",headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});if(!m.ok)throw new Error(`Request failed (${m.status})`);const g=await m.json(),y=Array.isArray(g.ratings)?g.ratings:[];if($.value=De(y),g&&g.rated_date)k.value=g.rated_date;else if(y.length&&y[0].rated_date)k.value=y[0].rated_date;else{const s=new Date;k.value=s.toISOString().slice(0,10)}}catch{$.value=De([]),C.value="Could not load behaviour ratings."}finally{oe.value=!1}}},st=async()=>{var l,t;if(!(!r.value||ne.value)){if(!Be.value){C.value="Please select grades (A/B/C/D) for all behaviours before saving.";return}ne.value=!0,C.value="";try{const d={rated_date:k.value||null,ratings:$.value.map(g=>({code:g.code,label:g.label,grade:g.grade,comment:g.comment||null}))},m=await fetch(route("students.behaviour-ratings.store",r.value.id),{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":((l=document.querySelector('meta[name="csrf-token"]'))==null?void 0:l.getAttribute("content"))||""},body:JSON.stringify(d)});if(!m.ok){let g="";try{const y=await m.json();if(y!=null&&y.message&&(g=y.message),!g&&(y!=null&&y.errors)){const s=Object.keys(y.errors)[0];g=s?String(((t=y.errors[s])==null?void 0:t[0])||""):""}}catch{try{g=await m.text()}catch{g=""}}C.value=`Save failed (${m.status}). ${g||"Please try again."}`;return}await pe(k.value)}catch{C.value="Could not save behaviour ratings."}finally{ne.value=!1}}},lt=()=>{const l=document.getElementById("student-results-preview");if(!l)return;const t=window.open("","_blank","noopener,noreferrer,width=900,height=650");t&&(t.document.open(),t.document.write(`
      <html>
        <head>
          <title>Student Results Preview</title>
          <style>
            body{font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; padding:16px;}
            table{width:100%; border-collapse:collapse; font-size:12px;}
            th,td{border:1px solid #e5e7eb; padding:6px;}
            th{background:#f9fafb; text-align:left;}
            .muted{color:#6b7280; font-size:12px;}
            .row{display:flex; justify-content:space-between; gap:12px; margin-top:10px; font-size:12px;}
            @media print{body{padding:0;}}
          </style>
        </head>
        <body>
          ${l.innerHTML}
        </body>
      </html>
    `),t.document.close(),t.focus(),t.print(),t.close())};return(l,t)=>(o(),a(h,null,[O(re(nt),{title:"Students"}),O(dt,null,{header:Ee(()=>[e("div",ct,[t[39]||(t[39]=e("div",null,[e("h2",{class:"text-2xl font-semibold leading-tight text-gray-800"}," Students "),e("p",{class:"mt-1 text-sm text-gray-500"}," Overview of all registered students. Use the class filter to narrow down the list. ")],-1)),e("div",gt,[t[38]||(t[38]=e("label",{class:"text-xs font-medium uppercase tracking-wide text-gray-500"},"Class",-1)),b(e("select",{class:"rounded-md border border-gray-300 bg-white px-3 py-1.5 text-sm text-gray-700 shadow-sm focus:border-emerald-500 focus:outline-none focus:ring-emerald-500","onUpdate:modelValue":t[0]||(t[0]=d=>z.value=d),onChange:Ne},[t[37]||(t[37]=e("option",{value:""},"All",-1)),(o(!0),a(h,null,_(P.classes,d=>(o(),a("option",{key:d,value:d},n(d),9,xt))),128))],544),[[U,z.value]])])])]),default:Ee(()=>{var d,m,g,y;return[ue.value&&D.value?(o(),a("div",vt,[e("div",bt,[e("div",yt,[t[42]||(t[42]=e("h3",{class:"text-sm font-semibold text-gray-900"},"Delete student",-1)),e("p",ft,[t[40]||(t[40]=K(" You are about to delete ",-1)),e("span",ht,n(D.value.full_name),1),t[41]||(t[41]=K(". This action cannot be undone. ",-1))])]),e("div",_t,[e("div",wt,[t[43]||(t[43]=e("span",{class:"font-medium"},"Exam No:",-1)),e("span",kt,n(D.value.exam_number),1)]),e("div",St,[e("button",{type:"button",class:"rounded-md bg-gray-50 px-3 py-1.5 font-medium text-gray-700 ring-1 ring-gray-200 hover:bg-gray-100",disabled:X.value,onClick:Je}," Cancel ",8,Ct),e("button",{type:"button",class:"rounded-md bg-red-600 px-3 py-1.5 font-semibold text-white shadow-sm hover:bg-red-700 disabled:cursor-not-allowed disabled:opacity-60",disabled:X.value,onClick:He},[X.value?(o(),a("span",Dt,"Deleting...")):(o(),a("span",At,"Delete"))],8,jt)])])])])):u("",!0),ie.value?(o(),a("div",Bt,[e("div",Ut,[t[44]||(t[44]=e("h3",{class:"mb-2 text-sm font-semibold text-gray-800"}," Confirm bulk delete ",-1)),e("p",Et," You are about to delete "+n(w.value.length)+" student(s). This action cannot be undone. ",1),e("div",Mt,[e("button",{type:"button",class:"rounded-md bg-gray-50 px-3 py-1.5 font-medium text-gray-700 ring-1 ring-gray-200 hover:bg-gray-100",onClick:t[1]||(t[1]=s=>ie.value=!1)}," Cancel "),e("button",{type:"button",class:"rounded-md bg-red-600 px-3 py-1.5 font-semibold text-white shadow-sm hover:bg-red-700 disabled:cursor-not-allowed disabled:opacity-60",disabled:N.value,onClick:Re},[N.value?(o(),a("span",Pt,"Deleting...")):(o(),a("span",Vt,"Delete"))],8,$t)])])])):u("",!0),ye.value?(o(),a("div",Nt,[e("div",zt,n(ye.value),1)])):u("",!0),H.value?(o(),a("div",Ft,[e("div",Rt,[e("div",Xt,[t[45]||(t[45]=e("h3",{class:"text-sm font-semibold text-gray-800"}," Import 100 Sample Students ",-1)),e("button",{type:"button",class:"rounded-full p-1 text-gray-400 hover:bg-gray-100 hover:text-gray-600",onClick:t[2]||(t[2]=s=>H.value=!1)}," ✕ ")]),e("div",Lt,[t[48]||(t[48]=e("p",{class:"text-[11px] text-gray-600"}," Choose the class level where you want to quickly add 100 sample students. They will automatically inherit all subjects already assigned to that class level on the Classes page. Useful for testing reports and features without entering data manually. ",-1)),e("div",null,[t[47]||(t[47]=e("label",{class:"mb-1 block font-medium"},"Class Level",-1)),b(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>G.value=s),class:"w-full rounded-md border border-gray-300 px-2 py-1.5 text-xs focus:border-emerald-500 focus:outline-none focus:ring-emerald-500"},[t[46]||(t[46]=e("option",{value:""},"Select class level",-1)),(o(!0),a(h,null,_(P.classes,s=>(o(),a("option",{key:"import-"+s,value:s},n(s),9,It))),128))],512),[[U,G.value]])])]),e("div",Tt,[e("button",{type:"button",class:"rounded-md bg-gray-50 px-3 py-1.5 text-xs font-medium text-gray-700 ring-1 ring-gray-200 hover:bg-gray-100",onClick:t[4]||(t[4]=s=>H.value=!1)}," Cancel "),e("button",{type:"button",class:"rounded-md bg-blue-600 px-3 py-1.5 text-xs font-semibold text-white shadow-sm hover:bg-blue-700 disabled:cursor-not-allowed disabled:opacity-60",disabled:!G.value||ee.value,onClick:Ie},[ee.value?(o(),a("span",Kt,"Importing...")):(o(),a("span",Ot,"Import 100 Students"))],8,Gt)])])])):u("",!0),e("div",qt,[e("div",Ht,[e("p",Jt," Students list ("+n(P.students.length)+") ",1),e("div",Wt,[e("button",{type:"button",class:"inline-flex items-center gap-1 rounded-md bg-emerald-600 px-3 py-1.5 text-xs font-semibold text-white shadow-sm transition hover:bg-emerald-700 focus:outline-none",onClick:Ye},[...t[49]||(t[49]=[e("span",{class:"text-base leading-none"},"+",-1),e("span",null,"Add Student",-1)])]),e("button",{type:"button",class:"inline-flex items-center gap-1 rounded-md bg-emerald-50 px-3 py-1.5 text-xs font-semibold text-emerald-700 ring-1 ring-emerald-200 transition hover:bg-emerald-100 focus:outline-none",onClick:t[5]||(t[5]=s=>de.value=!0)},[...t[50]||(t[50]=[e("span",{class:"text-sm leading-none"},"⇪",-1),e("span",null,"Bulk Upload",-1)])]),e("button",{type:"button",class:"inline-flex items-center gap-1 rounded-md bg-blue-50 px-3 py-1.5 text-xs font-semibold text-blue-700 ring-1 ring-blue-200 transition hover:bg-blue-100 focus:outline-none",onClick:Le},[...t[51]||(t[51]=[e("span",{class:"text-sm leading-none"},"★",-1),e("span",null,"Import 100 Samples",-1)])]),e("button",{type:"button",class:"inline-flex items-center gap-1 rounded-md bg-red-50 px-3 py-1.5 text-xs font-semibold text-red-700 ring-1 ring-red-200 transition hover:bg-red-100 focus:outline-none disabled:cursor-not-allowed disabled:opacity-60",disabled:!w.value.length||N.value,onClick:Xe},[N.value?(o(),a("span",Qt,"Deleting...")):(o(),a("span",Zt,"Bulk Delete"))],8,Yt)])]),e("div",es,[e("table",ts,[e("thead",null,[e("tr",ss,[e("th",ls,[e("input",{type:"checkbox",class:"h-3 w-3 rounded border-gray-300 text-emerald-600 focus:ring-emerald-500",checked:we(),onChange:Fe},null,40,as)]),t[57]||(t[57]=e("th",{class:"px-3 py-2"},"#",-1)),e("th",os,[e("button",{type:"button",class:"inline-flex items-center gap-1 hover:text-gray-700",onClick:t[6]||(t[6]=s=>se("exam_number"))},[t[52]||(t[52]=e("span",null,"Exam Number",-1)),e("span",ns,n(te("exam_number")),1)])]),e("th",rs,[e("button",{type:"button",class:"inline-flex items-center gap-1 hover:text-gray-700",onClick:t[7]||(t[7]=s=>se("full_name"))},[t[53]||(t[53]=e("span",null,"Full Name",-1)),e("span",ds,n(te("full_name")),1)])]),e("th",is,[e("button",{type:"button",class:"inline-flex items-center gap-1 hover:text-gray-700",onClick:t[8]||(t[8]=s=>se("class_level"))},[t[54]||(t[54]=e("span",null,"Class",-1)),e("span",us,n(te("class_level")),1)])]),e("th",ms,[e("button",{type:"button",class:"inline-flex items-center gap-1 hover:text-gray-700",onClick:t[9]||(t[9]=s=>se("stream"))},[t[55]||(t[55]=e("span",null,"Stream",-1)),e("span",ps,n(te("stream")),1)])]),t[58]||(t[58]=e("th",{class:"px-3 py-2"},"Subjects",-1)),e("th",cs,[e("button",{type:"button",class:"inline-flex items-center gap-1 hover:text-gray-700",onClick:t[10]||(t[10]=s=>se("gender"))},[t[56]||(t[56]=e("span",null,"Gender",-1)),e("span",gs,n(te("gender")),1)])]),t[59]||(t[59]=e("th",{class:"px-3 py-2 text-right"},"Actions",-1))])]),e("tbody",null,[(o(!0),a(h,null,_(Pe.value,s=>(o(),a(h,{key:"group-"+s.class_level},[e("tr",xs,[e("td",vs,[e("div",bs,[e("span",null,n(s.class_level),1),e("span",ys,n(s.students.length)+" student(s) ",1)])])]),(o(!0),a(h,null,_(s.students,(v,at)=>(o(),a("tr",{key:v.id,class:"border-b border-gray-100 text-xs text-gray-700 hover:bg-gray-50"},[e("td",fs,[e("input",{type:"checkbox",class:"h-3 w-3 rounded border-gray-300 text-emerald-600 focus:ring-emerald-500",checked:w.value.includes(v.id),onChange:F=>ze(v.id)},null,40,hs)]),e("td",_s,n(at+1),1),e("td",ws,n(v.exam_number),1),e("td",ks,[e("div",Ss,n(v.full_name),1)]),e("td",Cs,[e("div",js,n(v.class_level),1)]),e("td",As,[e("div",Ds,n(v.stream||"-"),1)]),e("td",Bs,[e("div",Us,[v.subjects&&v.subjects.length?(o(!0),a(h,{key:0},_(v.subjects,F=>(o(),a("span",{key:F.code,class:"inline-flex items-center rounded-full bg-emerald-50 px-2 py-0.5 text-[10px] font-medium text-emerald-700 ring-1 ring-emerald-100"},n(F.code),1))),128)):u("",!0),!v.subjects||!v.subjects.length?(o(),a("span",Es," — ")):u("",!0)])]),e("td",Ms,n(v.gender||"—"),1),e("td",$s,[e("div",Vs,[e("button",{type:"button",class:"inline-flex h-8 w-8 items-center justify-center rounded-md bg-blue-50 text-blue-700 ring-1 ring-blue-100 hover:bg-blue-100",title:"View details","aria-label":"View details",onClick:F=>Te(v)},[O(re(pt),{class:"h-4 w-4"})],8,Ps),e("button",{type:"button",class:"inline-flex h-8 w-8 items-center justify-center rounded-md bg-violet-50 text-violet-700 ring-1 ring-violet-100 hover:bg-violet-100",title:"Behaviour","aria-label":"Behaviour",onClick:F=>Ge(v)},[O(re(mt),{class:"h-4 w-4"})],8,Ns),e("button",{type:"button",class:"inline-flex h-8 w-8 items-center justify-center rounded-md bg-emerald-50 text-emerald-700 ring-1 ring-emerald-100 hover:bg-emerald-100",title:"Edit","aria-label":"Edit",onClick:F=>Oe(v)},[O(re(it),{class:"h-4 w-4"})],8,zs),e("button",{type:"button",class:"inline-flex h-8 w-8 items-center justify-center rounded-md bg-red-50 text-red-700 ring-1 ring-red-100 hover:bg-red-100",title:"Delete","aria-label":"Delete",onClick:F=>qe(v)},[O(re(ut),{class:"h-4 w-4"})],8,Fs)])])]))),128))],64))),128))])])])]),q.value?(o(),a("div",Rs,[e("div",Xs,[e("div",Ls,[t[60]||(t[60]=e("h3",{class:"text-sm font-semibold text-gray-800"}," Add Student ",-1)),e("button",{type:"button",class:"rounded-full p-1 text-gray-400 hover:bg-gray-100 hover:text-gray-600",onClick:t[11]||(t[11]=s=>q.value=!1)}," ✕ ")]),e("div",Is,[e("div",null,[t[61]||(t[61]=e("label",{class:"mb-1 block font-medium"},"Full Name",-1)),b(e("input",{"onUpdate:modelValue":t[12]||(t[12]=s=>c.value.full_name=s),type:"text",class:"w-full rounded-md border border-gray-300 px-2 py-1.5 text-xs focus:border-emerald-500 focus:outline-none focus:ring-emerald-500",placeholder:"e.g. John Doe"},null,512),[[S,c.value.full_name]]),(d=j.value)!=null&&d.full_name?(o(),a("p",Ts,n(j.value.full_name),1)):u("",!0)]),e("div",Gs,[e("div",null,[t[63]||(t[63]=e("label",{class:"mb-1 block font-medium"},"Class",-1)),b(e("select",{"onUpdate:modelValue":t[13]||(t[13]=s=>c.value.class_level=s),class:"w-full rounded-md border border-gray-300 px-2 py-1.5 text-xs focus:border-emerald-500 focus:outline-none focus:ring-emerald-500"},[t[62]||(t[62]=e("option",{value:""},"Select class",-1)),(o(!0),a(h,null,_(P.classes,s=>(o(),a("option",{key:"add-"+s,value:s},n(s),9,Os))),128))],512),[[U,c.value.class_level]]),(m=j.value)!=null&&m.class_level?(o(),a("p",Ks,n(j.value.class_level),1)):u("",!0)]),I.value.length?(o(),a("div",qs,[t[65]||(t[65]=e("label",{class:"mb-1 block font-medium"},"Stream",-1)),b(e("select",{"onUpdate:modelValue":t[14]||(t[14]=s=>c.value.stream=s),class:"w-full rounded-md border border-gray-300 px-2 py-1.5 text-xs focus:border-emerald-500 focus:outline-none focus:ring-emerald-500"},[t[64]||(t[64]=e("option",{value:""},"Select stream",-1)),(o(!0),a(h,null,_(I.value,s=>(o(),a("option",{key:"add-stream-"+s,value:s},n(s),9,Hs))),128))],512),[[U,c.value.stream]]),(g=j.value)!=null&&g.stream?(o(),a("p",Js,n(j.value.stream),1)):u("",!0)])):$e.value?(o(),a("div",Ws,[...t[66]||(t[66]=[e("label",{class:"mb-1 block font-medium"},"Stream",-1),e("div",{class:"rounded-md border border-dashed border-gray-200 bg-gray-50 px-2 py-2"}," No streams configured for this class. ",-1)])])):u("",!0),e("div",null,[t[68]||(t[68]=e("label",{class:"mb-1 block font-medium"},"Gender",-1)),b(e("select",{"onUpdate:modelValue":t[15]||(t[15]=s=>c.value.gender=s),class:"w-full rounded-md border border-gray-300 px-2 py-1.5 text-xs focus:border-emerald-500 focus:outline-none focus:ring-emerald-500"},[...t[67]||(t[67]=[e("option",{value:""},"Select gender",-1),e("option",{value:"M"},"Male",-1),e("option",{value:"F"},"Female",-1)])],512),[[U,c.value.gender]]),(y=j.value)!=null&&y.gender?(o(),a("p",Ys,n(j.value.gender),1)):u("",!0)])]),e("div",null,[t[69]||(t[69]=e("label",{class:"mb-1 block font-medium"},"Parent Phone",-1)),b(e("input",{type:"tel",class:"w-full rounded-md border border-gray-300 px-2 py-1.5 text-xs focus:border-emerald-500 focus:outline-none focus:ring-emerald-500",placeholder:"e.g. 07XXXXXXXX","onUpdate:modelValue":t[16]||(t[16]=s=>c.value.guardian_phone=s)},null,512),[[S,c.value.guardian_phone]])]),e("div",null,[t[70]||(t[70]=e("label",{class:"mb-1 block font-medium"},"Parent/Guardian Name",-1)),b(e("input",{"onUpdate:modelValue":t[17]||(t[17]=s=>c.value.guardian_name=s),type:"text",class:"w-full rounded-md border border-gray-300 px-2 py-1.5 text-xs focus:border-emerald-500 focus:outline-none focus:ring-emerald-500",placeholder:"e.g. Mary Doe"},null,512),[[S,c.value.guardian_name]])]),e("div",null,[t[71]||(t[71]=e("label",{class:"mb-1 block font-medium"},"Address (optional)",-1)),b(e("input",{"onUpdate:modelValue":t[18]||(t[18]=s=>c.value.guardian_address=s),type:"text",class:"w-full rounded-md border border-gray-300 px-2 py-1.5 text-xs focus:border-emerald-500 focus:outline-none focus:ring-emerald-500",placeholder:"e.g. Mtaa wa ..., Mkoa ..."},null,512),[[S,c.value.guardian_address]])]),e("div",null,[t[72]||(t[72]=e("label",{class:"mb-1 block font-medium"},"Date of Birth",-1)),b(e("input",{"onUpdate:modelValue":t[19]||(t[19]=s=>c.value.date_of_birth=s),type:"date",class:"w-full rounded-md border border-gray-300 px-2 py-1.5 text-xs focus:border-emerald-500 focus:outline-none focus:ring-emerald-500"},null,512),[[S,c.value.date_of_birth]])]),t[73]||(t[73]=e("div",null,[e("label",{class:"mb-1 block font-medium"},"Exam Number"),e("input",{type:"text",class:"w-full cursor-not-allowed rounded-md border border-dashed border-gray-300 bg-gray-50 px-2 py-1.5 text-xs text-gray-500",value:"Will be generated automatically from school code",readonly:""}),e("p",{class:"mt-1 text-[10px] text-gray-500"}," After you save, the system will assign an exam number using your school code and class. ")],-1)),t[74]||(t[74]=e("div",null,[e("label",{class:"mb-1 block font-medium"},"Notes (optional)"),e("textarea",{rows:"2",class:"w-full rounded-md border border-gray-300 px-2 py-1.5 text-xs focus:border-emerald-500 focus:outline-none focus:ring-emerald-500",placeholder:"Any extra information about this student"})],-1))]),e("div",Zs,[e("button",{type:"button",class:"rounded-md bg-gray-50 px-3 py-1.5 text-xs font-medium text-gray-700 ring-1 ring-gray-200 hover:bg-gray-100",onClick:t[20]||(t[20]=s=>q.value=!1)}," Cancel "),e("button",{type:"button",class:"rounded-md bg-emerald-600 px-3 py-1.5 text-xs font-semibold text-white shadow-sm hover:bg-emerald-700",disabled:Z.value,onClick:Ze},[Z.value?(o(),a("span",tl,"Saving...")):(o(),a("span",el,"Save"))],8,Qs)])])])):u("",!0),J.value&&r.value?(o(),a("div",sl,[e("div",ll,[e("div",{class:"mb-3 flex items-center justify-between"},[t[75]||(t[75]=e("div",null,[e("h3",{class:"text-sm font-semibold text-gray-800"}," Student Details "),e("p",{class:"mt-0.5 text-[11px] text-gray-500"}," Full profile and a sample academic summary for this student. ")],-1)),e("button",{type:"button",class:"rounded-full p-1 text-gray-400 hover:bg-gray-100 hover:text-gray-600",onClick:ke}," ✕ ")]),e("div",al,[e("button",{type:"button",class:R(["rounded-md px-3 py-1.5 font-semibold",B.value==="personal"?"bg-emerald-600 text-white":"bg-gray-50 text-gray-700 ring-1 ring-gray-200 hover:bg-gray-100"]),onClick:t[21]||(t[21]=s=>B.value="personal")}," Personal Details ",2),e("button",{type:"button",class:R(["rounded-md px-3 py-1.5 font-semibold",B.value==="results"?"bg-emerald-600 text-white":"bg-gray-50 text-gray-700 ring-1 ring-gray-200 hover:bg-gray-100"]),onClick:t[22]||(t[22]=s=>B.value="results")}," Results ",2),e("button",{type:"button",class:R(["rounded-md px-3 py-1.5 font-semibold",B.value==="behaviours"?"bg-emerald-600 text-white":"bg-gray-50 text-gray-700 ring-1 ring-gray-200 hover:bg-gray-100"]),onClick:t[23]||(t[23]=s=>B.value="behaviours")}," Behaviours ",2)]),B.value==="personal"?(o(),a("div",ol,[e("div",nl,[t[84]||(t[84]=e("h4",{class:"text-[11px] font-semibold uppercase tracking-wide text-gray-500"}," Basic Information ",-1)),e("div",rl,[e("div",dl,[t[76]||(t[76]=e("span",{class:"font-medium text-gray-600"},"Full Name:",-1)),e("span",il,n(r.value.full_name),1)]),e("div",ul,[t[77]||(t[77]=e("span",{class:"font-medium text-gray-600"},"Exam No:",-1)),e("span",ml,n(r.value.exam_number),1)]),e("div",pl,[t[78]||(t[78]=e("span",{class:"font-medium text-gray-600"},"Class / Stream:",-1)),e("span",cl,[K(n(r.value.class_level)+" ",1),r.value.stream?(o(),a("span",gl,"- "+n(r.value.stream),1)):u("",!0)])]),e("div",xl,[t[79]||(t[79]=e("span",{class:"font-medium text-gray-600"},"Gender:",-1)),e("span",vl,n(r.value.gender||"—"),1)]),e("div",bl,[t[80]||(t[80]=e("span",{class:"font-medium text-gray-600"},"Date of Birth:",-1)),e("span",yl,n(r.value.date_of_birth||"—"),1)])]),t[85]||(t[85]=e("h4",{class:"mt-3 text-[11px] font-semibold uppercase tracking-wide text-gray-500"}," Guardian & Contacts ",-1)),e("div",fl,[e("div",hl,[t[81]||(t[81]=e("span",{class:"font-medium text-gray-600"},"Guardian Name:",-1)),e("span",_l,n(r.value.guardian_name||"—"),1)]),e("div",wl,[t[82]||(t[82]=e("span",{class:"font-medium text-gray-600"},"Guardian Phone:",-1)),e("span",kl,n(r.value.guardian_phone||"—"),1)]),e("div",Sl,[t[83]||(t[83]=e("span",{class:"font-medium text-gray-600"},"Address:",-1)),e("span",Cl,n(r.value.guardian_address||"—"),1)])])]),e("div",jl,[t[86]||(t[86]=e("h4",{class:"text-[11px] font-semibold uppercase tracking-wide text-gray-500"}," Subjects ",-1)),e("div",Al,[r.value.subjects&&r.value.subjects.length?(o(!0),a(h,{key:0},_(r.value.subjects,s=>(o(),a("span",{key:s.code,class:"inline-flex items-center rounded-full bg-emerald-50 px-2 py-0.5 text-[11px] font-medium text-emerald-700 ring-1 ring-emerald-100"},n(s.code),1))),128)):u("",!0),!r.value.subjects||!r.value.subjects.length?(o(),a("span",Dl," Subjects not configured yet. ")):u("",!0)])])])):u("",!0),B.value==="results"?(o(),a("div",Bl,[e("div",{class:"flex items-center justify-end"},[e("button",{type:"button",class:"inline-flex items-center gap-1 rounded-md bg-emerald-600 px-2 py-1 font-semibold text-white shadow-sm hover:bg-emerald-700",onClick:lt}," Print Preview ")]),e("div",Ul,[e("div",El,[e("div",Ml,[e("div",$l,[t[89]||(t[89]=e("div",{class:"flex items-center gap-2"},[e("img",{src:"/images/emblem.png",alt:"Emblem",class:"h-7 w-7 flex-shrink-0"}),e("div",{class:"leading-tight"},[e("p",{class:"text-[10px] font-semibold uppercase tracking-wide text-gray-700"}," United Republic of Tanzania "),e("p",{class:"text-[10px] font-semibold text-gray-800"}," Student Report Card (Preview) ")])],-1)),e("div",Vl,[t[88]||(t[88]=e("span",{class:"font-semibold text-gray-700"},"Exam:",-1)),b(e("select",{"onUpdate:modelValue":t[24]||(t[24]=s=>E.value=s),onChange:Qe,class:"rounded-md border border-gray-300 px-2 py-0.5 text-[10px] focus:border-emerald-500 focus:outline-none focus:ring-emerald-500"},[t[87]||(t[87]=e("option",{value:""},"Latest exam",-1)),(o(!0),a(h,null,_(P.exams,s=>(o(),a("option",{key:s.id,value:String(s.id)},n(s.name)+" ("+n(s.academic_year)+") ",9,Pl))),128))],544),[[U,E.value]])])]),e("div",Nl,[e("div",null,[t[90]||(t[90]=e("span",{class:"font-semibold text-gray-700"},"Student:",-1)),e("span",zl,n(r.value.full_name),1)]),e("div",null,[t[91]||(t[91]=e("span",{class:"font-semibold text-gray-700"},"Exam No:",-1)),e("span",Fl,n(r.value.exam_number),1)])]),e("div",Rl,[e("div",null,[t[92]||(t[92]=e("span",{class:"font-semibold text-gray-700"},"Class:",-1)),e("span",Xl,[K(n(r.value.class_level)+" ",1),r.value.stream?(o(),a("span",Ll,"- "+n(r.value.stream),1)):u("",!0)])])])]),e("div",Il,[e("table",Tl,[t[95]||(t[95]=e("thead",null,[e("tr",{class:"bg-gray-50 text-gray-600"},[e("th",{class:"border-b border-gray-200 px-2 py-1 text-left"},"Subject"),e("th",{class:"border-b border-gray-200 px-2 py-1 text-center"},"Marks"),e("th",{class:"border-b border-gray-200 px-2 py-1 text-center"},"Grade")])],-1)),e("tbody",null,[ve.value?(o(),a("tr",Gl,[...t[93]||(t[93]=[e("td",{colspan:"3",class:"border-t border-gray-100 px-2 py-2 text-center"},"Loading results...",-1)])])):ae.value?(o(),a("tr",Ol,[e("td",Kl,n(ae.value),1)])):le.value.length?(o(!0),a(h,{key:3},_(le.value,s=>(o(),a("tr",{key:s.subject_code,class:"text-gray-700"},[e("td",Hl,n(s.subject_code||s.subject_name||"—"),1),e("td",Jl,n(s.marks??"—"),1),e("td",Wl,n(s.grade??"—"),1)]))),128)):(o(),a("tr",ql,[...t[94]||(t[94]=[e("td",{colspan:"3",class:"border-t border-gray-100 px-2 py-2 text-center"},"No results found for this exam.",-1)])]))])]),M.value&&(M.value.total!==null||M.value.average!==null)?(o(),a("div",Yl,[e("div",null,[t[96]||(t[96]=e("span",{class:"font-semibold text-gray-700"},"Total:",-1)),e("span",Zl,n(M.value.total??"—"),1)]),e("div",null,[t[97]||(t[97]=e("span",{class:"font-semibold text-gray-700"},"Average:",-1)),e("span",Ql,n(M.value.average??"—"),1)])])):u("",!0)])])])])):u("",!0),B.value==="behaviours"?(o(),a("div",ea,[e("div",ta,[t[99]||(t[99]=e("div",{class:"text-[11px] text-gray-500"}," View only. To edit, use the Behaviour button in Actions. ",-1)),e("div",sa,[t[98]||(t[98]=e("span",{class:"text-[10px] font-semibold text-gray-700"},"Date:",-1)),b(e("input",{"onUpdate:modelValue":t[25]||(t[25]=s=>k.value=s),type:"date",class:"rounded-md border border-gray-300 px-2 py-0.5 text-[10px] focus:border-emerald-500 focus:outline-none focus:ring-emerald-500",onChange:Ae},null,544),[[S,k.value]])])]),C.value?(o(),a("div",la,n(C.value),1)):u("",!0),e("div",aa,[e("table",oa,[t[101]||(t[101]=e("thead",null,[e("tr",{class:"bg-gray-50 text-gray-600"},[e("th",{class:"px-2 py-1 text-left"},"Code"),e("th",{class:"px-2 py-1 text-left"},"Behaviour"),e("th",{class:"px-2 py-1 text-center"},"Grade"),e("th",{class:"px-2 py-1 text-left"},"Comment")])],-1)),e("tbody",null,[oe.value?(o(),a("tr",na,[...t[100]||(t[100]=[e("td",{colspan:"4",class:"border-t border-gray-100 px-2 py-2 text-center"},"Loading behaviour ratings...",-1)])])):(o(!0),a(h,{key:1},_($.value,s=>(o(),a("tr",{key:s.code,class:"text-gray-700"},[e("td",ra,n(s.code),1),e("td",da,n(s.label),1),e("td",ia,n(s.grade),1),e("td",ua,n(s.comment||"—"),1)]))),128))])])])])):u("",!0),e("div",{class:"mt-4 flex justify-between gap-2"},[t[102]||(t[102]=e("div",null,null,-1)),e("button",{type:"button",class:"rounded-md bg-gray-50 px-3 py-1.5 text-xs font-medium text-gray-700 ring-1 ring-gray-200 hover:bg-gray-100",onClick:ke}," Close ")])])])):u("",!0),Y.value&&r.value?(o(),a("div",ma,[e("div",pa,[e("div",ca,[e("div",null,[t[103]||(t[103]=e("h3",{class:"text-sm font-semibold text-gray-800"}," Behaviour Ratings ",-1)),e("p",ga," Set behaviour grades and optional comments for "+n(r.value.full_name)+". ",1)]),e("button",{type:"button",class:"rounded-full p-1 text-gray-400 hover:bg-gray-100 hover:text-gray-600",onClick:Se}," ✕ ")]),e("div",xa,[e("div",va,[t[104]||(t[104]=e("span",{class:"font-semibold text-gray-700"},"Exam No:",-1)),e("span",ba,n(r.value.exam_number),1),t[105]||(t[105]=e("span",{class:"mx-2 text-gray-300"},"|",-1)),t[106]||(t[106]=e("span",{class:"font-semibold text-gray-700"},"Class:",-1)),e("span",ya,n(r.value.class_level),1)]),e("div",fa,[e("div",ha,[t[107]||(t[107]=e("span",{class:"text-[10px] font-semibold text-gray-700"},"Date:",-1)),b(e("input",{"onUpdate:modelValue":t[26]||(t[26]=s=>k.value=s),type:"date",class:"rounded-md border border-gray-300 px-2 py-0.5 text-[10px] focus:border-emerald-500 focus:outline-none focus:ring-emerald-500",onChange:Ae},null,544),[[S,k.value]])])])]),C.value?(o(),a("div",_a,n(C.value),1)):u("",!0),e("div",wa,[e("table",ka,[t[109]||(t[109]=e("thead",null,[e("tr",{class:"bg-gray-50 text-gray-600"},[e("th",{class:"px-2 py-1 text-left"},"Code"),e("th",{class:"px-2 py-1 text-left"},"Behaviour"),e("th",{class:"px-2 py-1 text-center"},"Grade"),e("th",{class:"px-2 py-1 text-left"},"Comment")])],-1)),e("tbody",null,[oe.value?(o(),a("tr",Sa,[...t[108]||(t[108]=[e("td",{colspan:"4",class:"border-t border-gray-100 px-2 py-2 text-center"},"Loading behaviour ratings...",-1)])])):(o(!0),a(h,{key:1},_($.value,s=>(o(),a("tr",{key:s.code,class:"text-gray-700"},[e("td",Ca,n(s.code),1),e("td",ja,n(s.label),1),e("td",Aa,[e("div",Da,[e("button",{type:"button",class:R(["px-2 py-0.5 text-[10px] font-semibold",s.grade==="A"?"bg-emerald-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"]),onClick:v=>me(s,"A")}," A ",10,Ba),e("button",{type:"button",class:R(["px-2 py-0.5 text-[10px] font-semibold",s.grade==="B"?"bg-emerald-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"]),onClick:v=>me(s,"B")}," B ",10,Ua),e("button",{type:"button",class:R(["px-2 py-0.5 text-[10px] font-semibold",s.grade==="C"?"bg-emerald-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"]),onClick:v=>me(s,"C")}," C ",10,Ea),e("button",{type:"button",class:R(["px-2 py-0.5 text-[10px] font-semibold",s.grade==="D"?"bg-emerald-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"]),onClick:v=>me(s,"D")}," D ",10,Ma)])]),e("td",$a,[b(e("input",{"onUpdate:modelValue":v=>s.comment=v,type:"text",class:"w-full rounded-md border border-gray-200 px-2 py-1 text-[10px] focus:border-emerald-500 focus:outline-none focus:ring-emerald-500",placeholder:"Optional comment"},null,8,Va),[[S,s.comment]])])]))),128))])])]),e("div",Pa,[e("button",{type:"button",class:"rounded-md bg-gray-50 px-3 py-1.5 text-xs font-medium text-gray-700 ring-1 ring-gray-200 hover:bg-gray-100",onClick:Se}," Close "),e("button",{type:"button",class:"rounded-md bg-emerald-600 px-3 py-1.5 text-xs font-semibold text-white shadow-sm hover:bg-emerald-700 disabled:cursor-not-allowed disabled:opacity-60",disabled:ne.value||oe.value||!Be.value,onClick:st},[ne.value?(o(),a("span",Fa,"Saving...")):(o(),a("span",za,"Save Behaviour"))],8,Na)])])])):u("",!0),W.value&&r.value?(o(),a("div",Ra,[e("div",Xa,[e("div",La,[e("div",null,[t[111]||(t[111]=e("h3",{class:"text-base font-semibold text-gray-900"},"Edit Student",-1)),e("div",Ia,[e("span",Ta,n(r.value.exam_number),1),t[110]||(t[110]=e("span",{class:"text-gray-300"},"|",-1)),e("span",Ga,n(r.value.full_name),1)])]),e("button",{type:"button",class:"rounded-full p-1 text-gray-400 hover:bg-white hover:text-gray-600",onClick:Ce}," ✕ ")]),e("form",{class:"space-y-4 px-5 py-4 text-xs text-gray-700",onSubmit:rt(Ke,["prevent"])},[e("div",Oa,[e("div",Ka,[t[112]||(t[112]=e("label",{class:"mb-1 block font-medium"},"Full Name",-1)),b(e("input",{"onUpdate:modelValue":t[27]||(t[27]=s=>i.value.full_name=s),type:"text",class:"w-full rounded-md border border-gray-300 px-3 py-2 text-xs focus:border-emerald-500 focus:outline-none focus:ring-emerald-500",placeholder:"e.g. John Doe"},null,512),[[S,i.value.full_name]]),f.value.full_name?(o(),a("p",qa,n(f.value.full_name),1)):u("",!0)]),e("div",null,[t[114]||(t[114]=e("label",{class:"mb-1 block font-medium"},"Class Level",-1)),b(e("select",{"onUpdate:modelValue":t[28]||(t[28]=s=>i.value.class_level=s),class:"w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-xs focus:border-emerald-500 focus:outline-none focus:ring-emerald-500"},[t[113]||(t[113]=e("option",{value:""},"Select class",-1)),(o(!0),a(h,null,_(P.classes,s=>(o(),a("option",{key:"edit-"+s,value:s},n(s),9,Ha))),128))],512),[[U,i.value.class_level]]),f.value.class_level?(o(),a("p",Ja,n(f.value.class_level),1)):u("",!0)]),e("div",null,[t[116]||(t[116]=e("label",{class:"mb-1 block font-medium"},"Stream",-1)),L.value.length?(o(),a("div",Wa,[b(e("select",{"onUpdate:modelValue":t[29]||(t[29]=s=>i.value.stream=s),class:"w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-xs focus:border-emerald-500 focus:outline-none focus:ring-emerald-500"},[t[115]||(t[115]=e("option",{value:""},"Select stream",-1)),(o(!0),a(h,null,_(L.value,s=>(o(),a("option",{key:"stream-"+s,value:s},n(s),9,Ya))),128))],512),[[U,i.value.stream]]),f.value.stream?(o(),a("p",Za,n(f.value.stream),1)):u("",!0)])):Ve.value?(o(),a("div",Qa," No streams configured for this class. ")):u("",!0)]),e("div",eo,[t[117]||(t[117]=e("label",{class:"mb-1 block font-medium"},"Assigned Subjects",-1)),e("div",to,[T.value&&T.value.length?(o(!0),a(h,{key:0},_(T.value,s=>(o(),a("span",{key:s.code,class:"inline-flex items-center rounded-full bg-emerald-50 px-2 py-0.5 text-[11px] font-medium text-emerald-700 ring-1 ring-emerald-100"},n(s.code),1))),128)):u("",!0),!T.value||!T.value.length?(o(),a("span",so," — ")):u("",!0)])]),e("div",null,[t[119]||(t[119]=e("label",{class:"mb-1 block font-medium"},"Gender",-1)),b(e("select",{"onUpdate:modelValue":t[30]||(t[30]=s=>i.value.gender=s),class:"w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-xs focus:border-emerald-500 focus:outline-none focus:ring-emerald-500"},[...t[118]||(t[118]=[e("option",{value:""},"Not set",-1),e("option",{value:"M"},"Male",-1),e("option",{value:"F"},"Female",-1)])],512),[[U,i.value.gender]]),f.value.gender?(o(),a("p",lo,n(f.value.gender),1)):u("",!0)]),e("div",null,[t[120]||(t[120]=e("label",{class:"mb-1 block font-medium"},"Date of Birth",-1)),b(e("input",{"onUpdate:modelValue":t[31]||(t[31]=s=>i.value.date_of_birth=s),type:"date",class:"w-full rounded-md border border-gray-300 px-3 py-2 text-xs focus:border-emerald-500 focus:outline-none focus:ring-emerald-500"},null,512),[[S,i.value.date_of_birth]]),f.value.date_of_birth?(o(),a("p",ao,n(f.value.date_of_birth),1)):u("",!0)])]),e("div",oo,[t[124]||(t[124]=e("p",{class:"mb-2 text-[11px] font-semibold uppercase tracking-wide text-gray-500"},"Guardian Details (optional)",-1)),e("div",no,[e("div",null,[t[121]||(t[121]=e("label",{class:"mb-1 block font-medium text-gray-700"},"Guardian Name",-1)),b(e("input",{"onUpdate:modelValue":t[32]||(t[32]=s=>i.value.guardian_name=s),type:"text",class:"w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-xs focus:border-emerald-500 focus:outline-none focus:ring-emerald-500",placeholder:"e.g. Mary Doe"},null,512),[[S,i.value.guardian_name]]),f.value.guardian_name?(o(),a("p",ro,n(f.value.guardian_name),1)):u("",!0)]),e("div",null,[t[122]||(t[122]=e("label",{class:"mb-1 block font-medium text-gray-700"},"Guardian Phone",-1)),b(e("input",{"onUpdate:modelValue":t[33]||(t[33]=s=>i.value.guardian_phone=s),type:"tel",class:"w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-xs focus:border-emerald-500 focus:outline-none focus:ring-emerald-500",placeholder:"e.g. 07XXXXXXXX"},null,512),[[S,i.value.guardian_phone]]),f.value.guardian_phone?(o(),a("p",io,n(f.value.guardian_phone),1)):u("",!0)]),e("div",uo,[t[123]||(t[123]=e("label",{class:"mb-1 block font-medium text-gray-700"},"Address",-1)),b(e("input",{"onUpdate:modelValue":t[34]||(t[34]=s=>i.value.guardian_address=s),type:"text",class:"w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-xs focus:border-emerald-500 focus:outline-none focus:ring-emerald-500",placeholder:"e.g. Mtaa wa ..., Mkoa ..."},null,512),[[S,i.value.guardian_address]]),f.value.guardian_address?(o(),a("p",mo,n(f.value.guardian_address),1)):u("",!0)])])]),e("div",null,[t[125]||(t[125]=e("label",{class:"mb-1 block font-medium"},"Assigned Subjects",-1)),e("div",po,[r.value.subjects&&r.value.subjects.length?(o(!0),a(h,{key:0},_(r.value.subjects,s=>(o(),a("span",{key:s.code,class:"inline-flex items-center rounded-full bg-emerald-50 px-2 py-0.5 text-[11px] font-medium text-emerald-700 ring-1 ring-emerald-100"},n(s.code),1))),128)):u("",!0),!r.value.subjects||!r.value.subjects.length?(o(),a("span",co," — ")):u("",!0)])]),e("div",go,[e("button",{type:"button",class:"rounded-md bg-gray-50 px-3 py-2 text-xs font-medium text-gray-700 ring-1 ring-gray-200 hover:bg-gray-100",onClick:Ce}," Cancel "),e("button",{type:"submit",class:"rounded-md bg-emerald-600 px-3 py-2 text-xs font-semibold text-white shadow-sm hover:bg-emerald-700 disabled:cursor-not-allowed disabled:opacity-60",disabled:Q.value},[Q.value?(o(),a("span",bo,"Saving...")):(o(),a("span",vo,"Save Changes"))],8,xo)])],32)])])):u("",!0),de.value?(o(),a("div",yo,[e("div",fo,[e("div",ho,[t[126]||(t[126]=e("h3",{class:"text-sm font-semibold text-gray-800"}," Bulk Upload Students ",-1)),e("button",{type:"button",class:"rounded-full p-1 text-gray-400 hover:bg-gray-100 hover:text-gray-600",onClick:t[35]||(t[35]=s=>de.value=!1)}," ✕ ")]),t[129]||(t[129]=e("div",{class:"space-y-3 text-xs text-gray-700"},[e("p",{class:"text-[11px] text-gray-600"},[K(" Paste or type one student per line in the format: "),e("span",{class:"font-mono"},"Full Name, Class, Gender"),K(". Exam numbers will be generated automatically based on your school code and class. ")]),e("textarea",{rows:"8",class:"w-full rounded-md border border-gray-300 px-2 py-1.5 text-xs font-mono focus:border-emerald-500 focus:outline-none focus:ring-emerald-500",placeholder:`e.g.\r
John Doe, Form I, M\r
Jane Doe, Form I, F`})],-1)),e("div",_o,[t[128]||(t[128]=e("button",{type:"button",class:"text-[11px] text-emerald-700 hover:underline"}," Download sample CSV (coming soon) ",-1)),e("div",wo,[e("button",{type:"button",class:"rounded-md bg-gray-50 px-3 py-1.5 text-xs font-medium text-gray-700 ring-1 ring-gray-200 hover:bg-gray-100",onClick:t[36]||(t[36]=s=>de.value=!1)}," Cancel "),t[127]||(t[127]=e("button",{type:"button",class:"rounded-md bg-emerald-600 px-3 py-1.5 text-xs font-semibold text-white shadow-sm hover:bg-emerald-700"}," Process Upload ",-1))])])])])):u("",!0)]}),_:1})],64))}};export{Ao as default};

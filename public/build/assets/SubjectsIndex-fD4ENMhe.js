import{i as m,n as N,I as R,c as l,a as T,u as $,h as W,w as U,b as e,d as f,t as r,o,F as g,r as v,x as F,k as x,p as O,s as Y,v as j,q as J,f as E,m as p}from"./app-BWUaLxI7.js";import{_ as Q}from"./AuthenticatedLayout-SNNT6bdC.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const X={class:"rounded-xl bg-white p-5 shadow-sm ring-1 ring-gray-100"},Z={class:"mb-3 flex items-center justify-between gap-3"},ee={class:"text-sm font-medium text-gray-700"},te={class:"overflow-x-auto"},se={class:"min-w-full text-left text-sm"},le={key:0},oe={class:"px-3 py-2 align-top font-mono text-xs text-gray-900"},ae={class:"px-3 py-2 align-top"},de={class:"px-3 py-2 align-top"},ne={class:"px-3 py-2 align-top"},ie={class:"flex justify-end gap-2"},re=["onClick"],ue=["onClick"],ce=["onClick"],me={key:0,class:"fixed inset-0 z-40 flex items-center justify-center bg-black/40 px-4"},be={class:"w-full max-w-lg rounded-xl bg-white p-5 shadow-xl ring-1 ring-gray-200"},xe=["value"],ge={class:"rounded-md border border-gray-200 bg-white p-2"},pe={class:"grid grid-cols-2 gap-2"},ye=["checked","onChange"],fe={class:"font-medium text-gray-800"},ve={class:"grid grid-cols-2 gap-3"},he={class:"flex items-center gap-2"},_e={class:"mt-4 flex justify-end gap-2"},we=["disabled"],je=["disabled"],ke={key:0},Ce={key:1},Se={key:1,class:"fixed inset-0 z-40 flex items-center justify-center bg-black/40 px-4 py-6 backdrop-blur-sm"},Ae={class:"w-full max-w-sm rounded-xl bg-white p-5 text-xs text-gray-700 shadow-xl"},Ee={class:"mb-2 flex items-start justify-between gap-3"},Me={class:"mt-1 text-[11px] text-gray-600"},Ie={class:"font-semibold"},Ve={class:"font-semibold"},Be=["disabled"],Ne={class:"mt-4 flex justify-end gap-2"},Te=["disabled"],Ue=["disabled"],Fe={key:2,class:"fixed inset-0 z-40 flex items-center justify-center bg-black/40 px-4 py-6 backdrop-blur-sm"},Oe={class:"w-full max-w-md rounded-xl bg-white p-5 text-xs text-gray-700 shadow-xl"},De={class:"space-y-2 text-[11px]"},Ke={class:"flex justify-between gap-3"},Le={class:"text-right font-mono text-gray-900"},Ge={class:"flex justify-between gap-3"},He={class:"text-right text-gray-900"},Pe={class:"flex justify-between gap-3"},ze={class:"max-w-[65%] text-right"},qe={key:0,class:"flex flex-wrap justify-end gap-1"},Re={key:1,class:"text-gray-500"},$e={key:3,class:"fixed inset-0 z-40 flex items-center justify-center bg-black/40 px-4 py-6 backdrop-blur-sm"},We={class:"w-full max-w-lg rounded-xl bg-white p-5 text-xs text-gray-700 shadow-xl"},Ye={class:"mb-3 flex items-start justify-between gap-3"},Je=["disabled"],Qe={class:"grid grid-cols-2 gap-3"},Xe=["value"],Ze={class:"mt-4 flex justify-end gap-2"},et=["disabled"],tt=["disabled"],at={__name:"SubjectsIndex",props:{subjects:{type:Array,default:()=>[]},classes:{type:Array,default:()=>[]}},setup(y){const h=m(!1),b=m(!1),k=m(!1),u=m(!1),n=m(null),C=m(!1),_=m(!1),c=m(!1),i=N({id:null,subject_code:"",name:"",class_ids:[]}),a=N({class_ids:[],subject_code:"",name:"",assign_to_current_user:!1}),M=[{code:"KIS",name:"Kiswahili"},{code:"ENG",name:"English Language"},{code:"B/MAT",name:"Basic Mathematics"},{code:"CIV",name:"Civics"},{code:"HIS",name:"History"},{code:"GEO",name:"Geography"},{code:"BIO",name:"Biology"},{code:"CHE",name:"Chemistry"},{code:"PHY",name:"Physics"},{code:"GK",name:"General Knowledge"},{code:"AGRI",name:"Agriculture"},{code:"COMM",name:"Commerce"},{code:"BOOK",name:"Book Keeping"},{code:"ECON",name:"Economics"},{code:"ACC",name:"Accountancy"},{code:"ENT",name:"Entrepreneurship"},{code:"COMP",name:"Computer Studies"},{code:"ICT",name:"Information and Computer Studies"},{code:"LIT",name:"Literature in English"},{code:"K/F",name:"Kiswahili for Foreigners"},{code:"ARAB",name:"Arabic"},{code:"FREN",name:"French"},{code:"GER",name:"German"},{code:"CHI",name:"Chinese"},{code:"ISL",name:"Islamic Knowledge"},{code:"BIB",name:"Bible Knowledge"},{code:"ECO",name:"Ecology"},{code:"HSC",name:"Home Science"},{code:"F/N",name:"Food and Nutrition"},{code:"TD",name:"Technical Drawing"},{code:"WD",name:"Woodwork"},{code:"MW",name:"Metalwork"},{code:"BC",name:"Building Construction"},{code:"ELC",name:"Electrical Installation"},{code:"AUT",name:"Automotive Mechanics"},{code:"PLU",name:"Plumbing"},{code:"TAIL",name:"Tailoring"},{code:"ART",name:"Fine Art"},{code:"MUS",name:"Music"},{code:"PE",name:"Physical Education"},{code:"SPO",name:"Sports"},{code:"THE",name:"Theatre Arts"},{code:"BUS",name:"Business Studies"}],w=m(""),D=()=>{a.class_ids=[],a.subject_code="",a.name="",a.assign_to_current_user=!1,w.value="",h.value=!0},I=()=>{b.value||(h.value=!1)},K=()=>{b.value||(b.value=!0,p.post(route("subjects.store"),a,{preserveScroll:!0,onSuccess:()=>{b.value=!1,h.value=!1,p.reload({only:["subjects"]})},onError:()=>{b.value=!1}}))},L=d=>{n.value=d,C.value=!0},V=()=>{C.value=!1},G=d=>{n.value=d,i.id=d.id,i.subject_code=d.subject_code||"",i.name=d.name||"",i.class_ids=Array.isArray(d.assigned_class_ids)?d.assigned_class_ids.map(t=>Number(t)).filter(t=>Number.isFinite(t)):[],_.value=!0},B=()=>{c.value||(_.value=!1)},H=()=>{!i.id||c.value||(c.value=!0,p.put(route("subjects.update",i.id),{subject_code:i.subject_code,name:i.name,class_ids:i.class_ids},{preserveScroll:!0,onSuccess:()=>{c.value=!1,_.value=!1,p.reload({only:["subjects"]})},onError:()=>{c.value=!1},onFinish:()=>{c.value=!1}}))},P=d=>{n.value=d,k.value=!0},S=()=>{u.value||(k.value=!1,n.value=null)},z=()=>{!n.value||u.value||(u.value=!0,p.delete(route("subjects.destroy",n.value.id),{preserveScroll:!0,onSuccess:()=>{u.value=!1,S(),p.reload({only:["subjects"]})},onError:()=>{u.value=!1},onFinish:()=>{u.value=!1}}))},q=d=>{const t=a.class_ids.indexOf(d);t===-1?a.class_ids.push(d):a.class_ids.splice(t,1)};return R(()=>w.value,d=>{if(!d)return;const t=M.find(s=>s.code===d);t&&(a.subject_code=t.code,a.name=t.name)}),(d,t)=>(o(),l(g,null,[T($(W),{title:"Subjects"}),T(Q,null,{header:U(()=>[e("div",{class:"flex items-center justify-between"},[t[7]||(t[7]=e("div",null,[e("h2",{class:"text-2xl font-semibold leading-tight text-gray-800"}," Subjects "),e("p",{class:"mt-1 text-sm text-gray-500"}," List of all subjects with codes and the classes they are assigned to. ")],-1)),e("div",{class:"flex items-center gap-2"},[e("button",{type:"button",class:"inline-flex items-center rounded-md bg-emerald-600 px-3 py-1.5 text-xs font-semibold text-white shadow-sm hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:ring-offset-2",onClick:D}," Add Subject ")])])]),default:U(()=>[e("div",X,[e("div",Z,[e("p",ee," Subjects ("+r(y.subjects.length)+") ",1)]),e("div",te,[e("table",se,[t[9]||(t[9]=e("thead",null,[e("tr",{class:"border-b border-gray-200 bg-gray-50 text-xs font-semibold uppercase tracking-wide text-gray-500"},[e("th",{class:"px-3 py-2"},"Code"),e("th",{class:"px-3 py-2"},"Subject Name"),e("th",{class:"px-3 py-2"},"Classes Assigned"),e("th",{class:"px-3 py-2 text-right"},"Actions")])],-1)),e("tbody",null,[y.subjects.length===0?(o(),l("tr",le,[...t[8]||(t[8]=[e("td",{colspan:"4",class:"px-3 py-4 text-center text-xs text-gray-500"}," No subjects found yet. ",-1)])])):f("",!0),(o(!0),l(g,null,v(y.subjects,s=>(o(),l("tr",{key:s.id,class:"border-b border-gray-100 text-xs text-gray-700 hover:bg-gray-50"},[e("td",oe,r(s.subject_code),1),e("td",ae,r(s.name),1),e("td",de,r(s.class_levels||"—"),1),e("td",ne,[e("div",ie,[e("button",{type:"button",class:"rounded-md bg-blue-50 px-2 py-1 text-[11px] font-medium text-blue-700 ring-1 ring-blue-100 hover:bg-blue-100",onClick:A=>L(s)}," View ",8,re),e("button",{type:"button",class:"rounded-md bg-emerald-50 px-2 py-1 text-[11px] font-medium text-emerald-700 ring-1 ring-emerald-100 hover:bg-emerald-100",onClick:A=>G(s)}," Edit ",8,ue),e("button",{type:"button",class:"rounded-md bg-red-50 px-2 py-1 text-[11px] font-medium text-red-700 ring-1 ring-red-100 hover:bg-red-100",onClick:A=>P(s)}," Delete ",8,ce)])])]))),128))])])])]),h.value?(o(),l("div",me,[e("div",be,[e("div",{class:"mb-3 flex items-start justify-between gap-3"},[t[10]||(t[10]=e("div",null,[e("h3",{class:"text-base font-semibold text-gray-900"},"Add Subject"),e("p",{class:"mt-1 text-xs text-gray-500"}," Select a class for this school, then add the subject you want to import for that class and for this user. ")],-1)),e("button",{type:"button",class:"text-xs text-gray-400 hover:text-gray-600",onClick:I}," ✕ ")]),e("form",{class:"space-y-3 text-xs text-gray-700",onSubmit:F(K,["prevent"])},[e("div",null,[t[12]||(t[12]=e("label",{class:"mb-1 block font-medium"},"Suggested subjects",-1)),x(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>w.value=s),class:"w-full rounded-md border border-gray-300 bg-white px-2 py-1.5 text-xs focus:border-emerald-500 focus:outline-none focus:ring-emerald-500"},[t[11]||(t[11]=e("option",{value:""},"-- Select from suggested list (or type manually below) --",-1)),(o(),l(g,null,v(M,s=>e("option",{key:s.code,value:s.code},r(s.code)+" - "+r(s.name),9,xe)),64))],512),[[O,w.value]]),t[13]||(t[13]=e("p",{class:"mt-2 text-[11px] text-gray-500"}," Ukichagua kwenye list, itajaza Subject Name na Code automatically. Ukikosa somo, andika manually. ",-1))]),e("div",null,[t[15]||(t[15]=e("label",{class:"mb-1 block font-medium"},"Select class(es) for this Subject",-1)),e("div",ge,[e("div",pe,[(o(!0),l(g,null,v(y.classes,s=>(o(),l("label",{key:s.id,class:Y(["flex cursor-pointer items-center gap-2 rounded-md border px-2 py-2 text-[11px]",a.class_ids.includes(s.id)?"border-emerald-300 bg-emerald-50":"border-gray-200 bg-white hover:bg-gray-50"])},[e("input",{type:"checkbox",class:"h-3 w-3 rounded border-gray-300 text-emerald-600 focus:ring-emerald-500",checked:a.class_ids.includes(s.id),onChange:A=>q(s.id)},null,40,ye),e("span",fe,r(s.name),1)],2))),128))]),t[14]||(t[14]=e("p",{class:"mt-2 text-[11px] text-gray-500"}," You can select multiple classes. ",-1))])]),e("div",ve,[e("div",null,[t[16]||(t[16]=e("label",{class:"mb-1 block font-medium"},"Subject Name",-1)),x(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>a.name=s),type:"text",class:"w-full rounded-md border border-gray-300 px-2 py-1.5 text-xs focus:border-emerald-500 focus:outline-none focus:ring-emerald-500",placeholder:"e.g. CIVICS",required:""},null,512),[[j,a.name]])]),e("div",null,[t[17]||(t[17]=e("label",{class:"mb-1 block font-medium"},"Subject Code",-1)),x(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>a.subject_code=s),type:"text",class:"w-full rounded-md border border-gray-300 px-2 py-1.5 text-xs focus:border-emerald-500 focus:outline-none focus:ring-emerald-500",placeholder:"e.g. CIV",required:""},null,512),[[j,a.subject_code]])])]),e("div",he,[x(e("input",{id:"assign_to_me","onUpdate:modelValue":t[3]||(t[3]=s=>a.assign_to_current_user=s),type:"checkbox",class:"h-3 w-3 rounded border-gray-300 text-emerald-600 focus:ring-emerald-500"},null,512),[[J,a.assign_to_current_user]]),t[18]||(t[18]=e("label",{for:"assign_to_me",class:"text-[11px] text-gray-600"}," Also assign this subject to me as a teacher. ",-1))]),e("div",_e,[e("button",{type:"button",class:"rounded-md bg-gray-50 px-3 py-1.5 text-xs font-medium text-gray-700 ring-1 ring-gray-200 hover:bg-gray-100",onClick:I,disabled:b.value}," Cancel ",8,we),e("button",{type:"submit",class:"inline-flex items-center rounded-md bg-emerald-600 px-3 py-1.5 text-xs font-semibold text-white shadow-sm hover:bg-emerald-700 disabled:cursor-not-allowed disabled:opacity-70",disabled:b.value},[b.value?(o(),l("span",Ce,"Saving...")):(o(),l("span",ke,"Save Subject"))],8,je)])],32)])])):f("",!0),k.value&&n.value?(o(),l("div",Se,[e("div",Ae,[e("div",Ee,[e("div",null,[t[22]||(t[22]=e("h3",{class:"text-sm font-semibold text-gray-900"},"Delete subject?",-1)),e("p",Me,[t[19]||(t[19]=E(" This will remove ",-1)),e("span",Ie,r(n.value.subject_code),1),t[20]||(t[20]=E(" — ",-1)),e("span",Ve,r(n.value.name),1),t[21]||(t[21]=E(". ",-1))])]),e("button",{type:"button",class:"inline-flex h-6 w-6 items-center justify-center rounded-full bg-gray-100 text-[11px] font-bold text-gray-600 hover:bg-gray-200",disabled:u.value,onClick:S}," × ",8,Be)]),e("div",Ne,[e("button",{type:"button",class:"rounded-md bg-gray-50 px-3 py-1.5 text-[11px] font-medium text-gray-700 ring-1 ring-gray-200 hover:bg-gray-100",disabled:u.value,onClick:S}," Cancel ",8,Te),e("button",{type:"button",class:"rounded-md bg-red-600 px-3 py-1.5 text-[11px] font-semibold text-white shadow-sm hover:bg-red-700 disabled:opacity-60",disabled:u.value,onClick:z},r(u.value?"Deleting...":"Delete"),9,Ue)])])])):f("",!0),C.value&&n.value?(o(),l("div",Fe,[e("div",Oe,[e("div",{class:"mb-3 flex items-start justify-between gap-3"},[t[23]||(t[23]=e("div",null,[e("h3",{class:"text-sm font-semibold text-gray-900"},"Subject details"),e("p",{class:"mt-0.5 text-[11px] text-gray-500"},"Full details and assigned classes.")],-1)),e("button",{type:"button",class:"inline-flex h-6 w-6 items-center justify-center rounded-full bg-gray-100 text-[11px] font-bold text-gray-600 hover:bg-gray-200",onClick:V}," × ")]),e("dl",De,[e("div",Ke,[t[24]||(t[24]=e("dt",{class:"font-semibold text-gray-600"},"Code",-1)),e("dd",Le,r(n.value.subject_code),1)]),e("div",Ge,[t[25]||(t[25]=e("dt",{class:"font-semibold text-gray-600"},"Name",-1)),e("dd",He,r(n.value.name),1)]),e("div",Pe,[t[26]||(t[26]=e("dt",{class:"font-semibold text-gray-600"},"Classes",-1)),e("dd",ze,[Array.isArray(n.value.assigned_classes)&&n.value.assigned_classes.length?(o(),l("div",qe,[(o(!0),l(g,null,v(n.value.assigned_classes,s=>(o(),l("span",{key:s,class:"rounded bg-slate-100 px-1.5 py-0.5 text-[10px] text-slate-700"},r(s),1))),128))])):(o(),l("span",Re,"—"))])])]),e("div",{class:"mt-4 flex justify-end"},[e("button",{type:"button",class:"rounded-md bg-emerald-50 px-3 py-1.5 text-[11px] font-medium text-emerald-700 ring-1 ring-emerald-100 hover:bg-emerald-100",onClick:V}," Close ")])])])):f("",!0),_.value&&n.value?(o(),l("div",$e,[e("div",We,[e("div",Ye,[t[27]||(t[27]=e("div",null,[e("h3",{class:"text-sm font-semibold text-gray-900"},"Edit subject"),e("p",{class:"mt-0.5 text-[11px] text-gray-500"},"Update subject details and assigned classes.")],-1)),e("button",{type:"button",class:"inline-flex h-6 w-6 items-center justify-center rounded-full bg-gray-100 text-[11px] font-bold text-gray-600 hover:bg-gray-200",disabled:c.value,onClick:B}," × ",8,Je)]),e("form",{class:"space-y-3",onSubmit:F(H,["prevent"])},[e("div",Qe,[e("div",null,[t[28]||(t[28]=e("label",{class:"mb-1 block text-[11px] font-medium"},"Subject code",-1)),x(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>i.subject_code=s),type:"text",class:"w-full rounded-md border border-gray-300 px-2 py-1.5 text-[11px] font-mono focus:border-emerald-500 focus:outline-none focus:ring-emerald-500",required:""},null,512),[[j,i.subject_code]])]),e("div",null,[t[29]||(t[29]=e("label",{class:"mb-1 block text-[11px] font-medium"},"Subject name",-1)),x(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>i.name=s),type:"text",class:"w-full rounded-md border border-gray-300 px-2 py-1.5 text-[11px] focus:border-emerald-500 focus:outline-none focus:ring-emerald-500",required:""},null,512),[[j,i.name]])])]),e("div",null,[t[30]||(t[30]=e("label",{class:"mb-1 block text-[11px] font-medium"},"Assigned classes",-1)),x(e("select",{"onUpdate:modelValue":t[6]||(t[6]=s=>i.class_ids=s),multiple:"",class:"w-full rounded-md border border-gray-300 px-2 py-2 text-[11px] text-gray-800 focus:border-emerald-500 focus:outline-none focus:ring-emerald-500"},[(o(!0),l(g,null,v(y.classes,s=>(o(),l("option",{key:s.id,value:s.id},r(s.name),9,Xe))),128))],512),[[O,i.class_ids]]),t[31]||(t[31]=e("p",{class:"mt-1 text-[10px] text-gray-500"},"Chagua madarasa yatakayopata somo hili.",-1))]),e("div",Ze,[e("button",{type:"button",class:"rounded-md bg-gray-50 px-3 py-1.5 text-[11px] font-medium text-gray-700 ring-1 ring-gray-200 hover:bg-gray-100",disabled:c.value,onClick:B}," Cancel ",8,et),e("button",{type:"submit",class:"rounded-md bg-emerald-600 px-3 py-1.5 text-[11px] font-semibold text-white shadow-sm hover:bg-emerald-700 disabled:opacity-60",disabled:c.value},r(c.value?"Saving...":"Save changes"),9,tt)])],32)])])):f("",!0)]),_:1})],64))}};export{at as default};

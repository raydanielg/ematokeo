import{i as x,j as C,I as P,c as o,a as T,u as S,h as q,w as j,b as e,t as a,k as A,d as m,v as V,o as i,F as g,r as _,f as N,m as R}from"./app-DMgQLRjc.js";import{_ as W}from"./AuthenticatedLayout-BHLP2IY0.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const F={class:"space-y-6"},H={class:"rounded-xl bg-white p-5 shadow-sm ring-1 ring-gray-100"},D={class:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between"},L={class:"mt-2 inline-flex items-center rounded-full bg-emerald-50 px-3 py-1 text-xs font-semibold text-emerald-700 ring-1 ring-emerald-100"},B={class:"w-full md:w-80"},E={class:"relative"},U={key:0,class:"absolute z-10 mt-1 w-full overflow-hidden rounded-md border border-gray-200 bg-white shadow-lg"},X={key:0,class:"px-3 py-2 text-[11px] text-gray-500"},z=["onClick"],M={class:"font-semibold text-gray-900"},I={class:"text-[10px] text-gray-500"},J={class:"text-[10px] text-gray-400"},K={key:1,class:"px-3 py-2 text-[11px] text-gray-500"},Q={class:"mt-2"},G={class:"rounded-xl bg-white p-5 shadow-sm ring-1 ring-gray-100"},O={class:"flex items-center justify-between"},Y={class:"text-[11px] text-gray-500"},Z={class:"font-semibold text-gray-700"},ee={class:"mt-4 overflow-x-auto"},te={class:"min-w-full text-[11px]"},se={key:0},le={class:"px-3 py-2 font-medium text-gray-900"},ae=["onClick"],oe={class:"px-3 py-2 text-gray-700"},ie={class:"px-3 py-2 text-gray-700"},ne={class:"px-3 py-2 text-gray-700"},re={class:"px-3 py-2 text-right"},de=["disabled","onClick"],ue={class:"rounded-xl bg-white p-5 shadow-sm ring-1 ring-gray-100"},ce={class:"flex items-center justify-between"},pe={class:"text-[11px] text-gray-500"},xe={class:"font-semibold text-gray-700"},me={class:"mt-4 overflow-x-auto"},ye={class:"min-w-full text-[11px]"},he={key:0},ge={class:"px-3 py-2 font-medium text-gray-900"},be=["onClick"],fe={class:"px-3 py-2 text-gray-700"},ve={class:"px-3 py-2 text-gray-700"},we={class:"px-3 py-2 text-gray-700"},_e={class:"px-3 py-2 text-right"},ke=["disabled","onClick"],Ae={__name:"TeachersCredentials",props:{teachersWithVipindi:{type:Array,default:()=>[]},allTeachers:{type:Array,default:()=>[]},defaultPassword:{type:String,default:"amss2025"}},setup($){const d=$,y=x(""),b=x(""),u=x([]),c=x(!1);let h=null;const n=l=>String(l||"").toLowerCase().trim(),f=C(()=>{const l=n(y.value);return l?(d.teachersWithVipindi||[]).filter(t=>n(t.name).includes(l)||n(t.email).includes(l)||n(t.check_number).includes(l)||n(t.phone).includes(l)):d.teachersWithVipindi||[]}),v=C(()=>{const l=n(y.value);return l?(d.allTeachers||[]).filter(t=>n(t.name).includes(l)||n(t.email).includes(l)||n(t.check_number).includes(l)||n(t.phone).includes(l)):d.allTeachers||[]}),p=x(null),k=l=>{!(l!=null&&l.id)||!window.confirm(`Reset password ya ${l.name} iwe "${d.defaultPassword}"?`)||(p.value=l.id,R.post(route("teachers.credentials.reset-password",l.id),{},{preserveScroll:!0,onFinish:()=>{p.value=null}}))},w=l=>{l&&R.get(route("teachers.details",l),{},{preserveScroll:!0})};return P(()=>b.value,l=>{const t=String(l||"").trim();if(h&&(clearTimeout(h),h=null),t.length<2){u.value=[],c.value=!1;return}h=setTimeout(async()=>{c.value=!0;try{const r=await(await fetch(route("teachers.search",{q:t}),{headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json"},credentials:"same-origin"})).json();u.value=Array.isArray(r==null?void 0:r.data)?r.data:[]}catch{u.value=[]}finally{c.value=!1}},250)}),(l,t)=>(i(),o(g,null,[T(S(q),{title:"Teacher Credentials"}),T(W,null,{header:j(()=>[...t[2]||(t[2]=[e("div",null,[e("h2",{class:"text-2xl font-semibold leading-tight text-gray-800"},"Teacher Credentials"),e("p",{class:"mt-1 text-sm text-gray-500"},"Reset passwords and view login details for teachers.")],-1)])]),default:j(()=>[e("div",F,[e("div",H,[e("div",D,[e("div",null,[t[3]||(t[3]=e("h3",{class:"text-sm font-semibold text-gray-800"},"Default Password",-1)),t[4]||(t[4]=e("p",{class:"mt-1 text-[11px] text-gray-600"},"Kwa sasa mfumo utaweka password ya reset kuwa:",-1)),e("div",L,a(d.defaultPassword),1)]),e("div",B,[t[6]||(t[6]=e("label",{class:"mb-1 block text-[11px] font-medium text-gray-700"},"Teacher search (AJAX)",-1)),e("div",E,[A(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>b.value=s),type:"text",class:"w-full rounded-md border border-gray-300 px-3 py-2 text-[11px] focus:border-emerald-500 focus:outline-none focus:ring-emerald-500",placeholder:"Type name/email/check no..."},null,512),[[V,b.value]]),c.value||u.value.length?(i(),o("div",U,[c.value?(i(),o("div",X,"Searching...")):m("",!0),(i(!0),o(g,null,_(u.value,s=>(i(),o("button",{key:s.id,type:"button",class:"flex w-full items-start justify-between gap-2 px-3 py-2 text-left text-[11px] hover:bg-emerald-50",onClick:r=>w(s.id)},[e("div",null,[e("div",M,a(s.name),1),e("div",I,a(s.email),1)]),e("div",J,a(s.check_number||""),1)],8,z))),128)),!c.value&&!u.value.length?(i(),o("div",K,"No results.")):m("",!0)])):m("",!0)]),e("div",Q,[t[5]||(t[5]=e("label",{class:"mb-1 block text-[11px] font-medium text-gray-700"},"Filter tables (local)",-1)),A(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>y.value=s),type:"text",class:"w-full rounded-md border border-gray-300 px-3 py-2 text-[11px] focus:border-emerald-500 focus:outline-none focus:ring-emerald-500",placeholder:"Filter by name, email, phone, check no..."},null,512),[[V,y.value]])])])])]),e("div",G,[e("div",O,[t[8]||(t[8]=e("div",null,[e("h3",{class:"text-sm font-semibold text-gray-800"},"Walimu wenye vipindi tu"),e("p",{class:"mt-1 text-[11px] text-gray-500"},"Hawa ni walimu waliopangiwa vipindi (waliopo kwenye timetable weekly limits).")],-1)),e("div",Y,[t[7]||(t[7]=N("Total: ",-1)),e("span",Z,a(f.value.length),1)])]),e("div",ee,[e("table",te,[t[10]||(t[10]=e("thead",null,[e("tr",{class:"border-b bg-slate-50 text-left text-[10px] font-semibold uppercase tracking-wide text-gray-600"},[e("th",{class:"px-3 py-2"},"Name"),e("th",{class:"px-3 py-2"},"Email"),e("th",{class:"px-3 py-2"},"Phone"),e("th",{class:"px-3 py-2"},"Check No."),e("th",{class:"px-3 py-2 text-right"},"Action")])],-1)),e("tbody",null,[f.value.length?m("",!0):(i(),o("tr",se,[...t[9]||(t[9]=[e("td",{colspan:"5",class:"px-3 py-3 text-[11px] text-gray-500"},"Hakuna mwalimu mwenye vipindi bado.",-1)])])),(i(!0),o(g,null,_(f.value,s=>(i(),o("tr",{key:s.id,class:"border-b last:border-b-0"},[e("td",le,[e("button",{type:"button",class:"text-emerald-700 hover:underline",onClick:r=>w(s.id)},a(s.name),9,ae)]),e("td",oe,a(s.email),1),e("td",ie,a(s.phone||"-"),1),e("td",ne,a(s.check_number||"-"),1),e("td",re,[e("button",{type:"button",class:"rounded-md bg-emerald-600 px-3 py-1.5 text-[11px] font-semibold text-white shadow-sm hover:bg-emerald-700 disabled:opacity-60",disabled:p.value===s.id,onClick:r=>k(s)},a(p.value===s.id?"Resetting...":"Reset password"),9,de)])]))),128))])])])]),e("div",ue,[e("div",ce,[t[12]||(t[12]=e("div",null,[e("h3",{class:"text-sm font-semibold text-gray-800"},"Walimu wote (role: teacher)"),e("p",{class:"mt-1 text-[11px] text-gray-500"},"Hii ni list ya walimu wote walio kwenye mfumo. Unaweza ku-reset password yao pia.")],-1)),e("div",pe,[t[11]||(t[11]=N("Total: ",-1)),e("span",xe,a(v.value.length),1)])]),e("div",me,[e("table",ye,[t[14]||(t[14]=e("thead",null,[e("tr",{class:"border-b bg-slate-50 text-left text-[10px] font-semibold uppercase tracking-wide text-gray-600"},[e("th",{class:"px-3 py-2"},"Name"),e("th",{class:"px-3 py-2"},"Email"),e("th",{class:"px-3 py-2"},"Phone"),e("th",{class:"px-3 py-2"},"Check No."),e("th",{class:"px-3 py-2 text-right"},"Action")])],-1)),e("tbody",null,[v.value.length?m("",!0):(i(),o("tr",he,[...t[13]||(t[13]=[e("td",{colspan:"5",class:"px-3 py-3 text-[11px] text-gray-500"},"Hakuna walimu kwenye mfumo.",-1)])])),(i(!0),o(g,null,_(v.value,s=>(i(),o("tr",{key:s.id,class:"border-b last:border-b-0"},[e("td",ge,[e("button",{type:"button",class:"text-emerald-700 hover:underline",onClick:r=>w(s.id)},a(s.name),9,be)]),e("td",fe,a(s.email),1),e("td",ve,a(s.phone||"-"),1),e("td",we,a(s.check_number||"-"),1),e("td",_e,[e("button",{type:"button",class:"rounded-md bg-slate-900 px-3 py-1.5 text-[11px] font-semibold text-white shadow-sm hover:bg-slate-800 disabled:opacity-60",disabled:p.value===s.id,onClick:r=>k(s)},a(p.value===s.id?"Resetting...":"Reset password"),9,ke)])]))),128))])])])])])]),_:1})],64))}};export{Ae as default};

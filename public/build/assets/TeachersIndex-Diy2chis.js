import{i as x,j as S,n as P,I as ue,c as n,a as Ce,u as lt,h as at,w as Ne,d as p,b as e,o as i,F as m,r as g,t as d,k as C,p as ce,v as X,f as D,s as ot,x as Se,m as O}from"./app-CWw-RN8I.js";import{_ as rt}from"./AuthenticatedLayout-lyVFAY1m.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const nt={class:"flex items-center justify-between"},it={class:"flex gap-2"},dt={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 px-4 py-6 backdrop-blur-sm"},ut={class:"w-full max-w-md rounded-xl bg-white p-5 text-xs text-gray-700 shadow-xl"},ct={class:"mb-2 flex items-start justify-between gap-3"},bt=["disabled"],pt={class:"rounded-lg border border-amber-200 bg-amber-50 px-3 py-2 text-[11px] text-amber-900"},mt={class:"mt-1 flex flex-wrap gap-1"},xt={key:0,class:"text-[10px] text-amber-900"},gt={class:"mt-4 flex justify-end"},yt=["disabled"],ft={key:1,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 px-4 py-6 backdrop-blur-sm"},ht={class:"w-full max-w-xl rounded-xl bg-white p-5 text-xs text-gray-700 shadow-xl"},vt={class:"mb-2 flex items-start justify-between gap-3"},_t=["disabled"],wt={class:"max-h-64 space-y-2 overflow-auto rounded-lg border border-gray-200 bg-white p-2"},kt={class:"text-[11px] font-semibold text-amber-900"},jt={class:"mt-1 flex flex-wrap gap-1"},Ct={key:0,class:"px-2 py-2 text-[11px] text-gray-500"},Nt={class:"mt-4 flex justify-end gap-2"},St=["disabled"],At=["disabled"],Mt={key:2,class:"fixed inset-0 z-40 flex items-center justify-center bg-black/40 px-4 py-6 backdrop-blur-sm"},Tt={class:"w-full max-w-3xl rounded-xl bg-white p-5 text-xs text-gray-700 shadow-xl"},Ft={class:"mb-3 flex items-start justify-between gap-3"},It={class:"mt-0.5 text-[11px] text-gray-500"},$t=["disabled"],Xt={key:0,class:"py-8 text-center text-[11px] text-gray-500"},Vt={key:1,class:"space-y-3"},Bt={class:"overflow-hidden rounded-lg border border-gray-200"},Lt={class:"min-w-full border-collapse text-[11px]"},zt={key:0},Rt={class:"border-b border-gray-100 px-3 py-2"},Dt=["onUpdate:modelValue"],Ot=["value"],Ut={key:0,class:"mt-1"},Et=["onUpdate:modelValue"],qt=["value"],Pt={class:"border-b border-gray-100 px-3 py-2"},Ht=["onUpdate:modelValue"],Wt=["value"],Jt={class:"border-b border-gray-100 px-3 py-2"},Kt=["onUpdate:modelValue"],Yt={class:"border-b border-gray-100 px-3 py-2 text-right"},Zt=["disabled","onClick"],Gt={class:"flex items-center justify-between"},Qt=["disabled"],es={class:"flex justify-end gap-2"},ts=["disabled"],ss=["disabled"],ls={class:"rounded-2xl bg-slate-50/70 p-4 ring-1 ring-slate-200"},as={class:"rounded-2xl bg-white p-5 shadow-sm ring-1 ring-gray-100"},os={class:"mb-4 flex flex-wrap items-center justify-between gap-3"},rs={class:"mt-0.5 text-[11px] text-gray-500"},ns={class:"font-semibold text-gray-700"},is={class:"w-full sm:w-72"},ds={class:"overflow-hidden rounded-xl border border-gray-200"},us={class:"overflow-x-auto"},cs={class:"min-w-full text-left text-sm"},bs={class:"border-b border-gray-200 bg-slate-50 text-xs font-semibold uppercase tracking-wide text-gray-500"},ps={class:"w-10 px-4 py-3"},ms=["checked"],xs={key:0},gs={class:"px-4 py-2 align-top"},ys=["checked","onChange"],fs={class:"px-3 py-2 align-top"},hs={class:"flex flex-col"},vs={class:"text-gray-800"},_s={class:"text-[10px] text-gray-500"},ws={class:"px-3 py-2 align-top"},ks={class:"px-3 py-2 align-top"},js={class:"px-3 py-2 align-top"},Cs={key:0,class:"flex flex-wrap gap-1"},Ns={key:1,class:"text-gray-500"},Ss={class:"px-3 py-2 align-top"},As={key:0,class:"space-y-1"},Ms={class:"text-[10px] font-semibold text-emerald-900"},Ts={class:"mt-0.5 flex flex-wrap gap-1"},Fs={key:1,class:"flex flex-wrap gap-1"},Is={key:2,class:"text-gray-500"},$s={class:"px-3 py-2 align-top"},Xs={class:"flex justify-end gap-1.5"},Vs=["onClick"],Bs=["onClick"],Ls=["onClick"],zs=["onClick"],Rs=["onClick"],Ds={key:3,class:"fixed inset-0 z-40 flex items-center justify-center bg-black/40 px-4 py-6 backdrop-blur-sm"},Os={class:"w-full max-w-3xl rounded-xl bg-white p-5 text-xs text-gray-700 shadow-xl"},Us={class:"mb-3 flex items-center justify-between"},Es={class:"mt-0.5 text-[11px] text-gray-500"},qs={class:"font-semibold"},Ps={key:0,class:"py-6 text-center text-[11px] text-gray-500"},Hs={key:1,class:"overflow-hidden rounded-lg border border-gray-200"},Ws={class:"min-w-full border-collapse text-[11px]"},Js={key:0},Ks={class:"border-b border-gray-100 px-3 py-2"},Ys={class:"border-b border-gray-100 px-3 py-2"},Zs={class:"font-medium text-gray-800"},Gs={class:"text-[10px] text-gray-500"},Qs={class:"border-b border-gray-100 px-3 py-2 font-semibold"},el={class:"mt-4 flex justify-end"},tl={key:4,class:"fixed inset-0 z-40 flex items-center justify-center bg-black/40 px-4 py-6 backdrop-blur-sm"},sl={class:"w-full max-w-lg rounded-xl bg-white p-5 text-xs text-gray-700 shadow-xl"},ll={class:"mb-3 flex items-center justify-between"},al={class:"space-y-2 text-[11px] text-gray-700"},ol={class:"flex justify-between gap-3"},rl={class:"text-right text-gray-900"},nl={class:"flex justify-between gap-3"},il={class:"text-right"},dl={class:"flex justify-between gap-3"},ul={class:"mt-0.5 text-[11px] font-medium text-gray-900"},cl={class:"flex justify-between gap-3"},bl={class:"mt-0.5 text-[11px] font-medium text-gray-900"},pl={class:"col-span-2"},ml={class:"mt-1 flex flex-wrap gap-1"},xl={key:0,class:"text-[11px] text-gray-500"},gl={key:0,class:"col-span-2"},yl={class:"mt-1 space-y-2"},fl={class:"text-[10px] font-semibold text-amber-900"},hl={class:"mt-1 space-y-1"},vl={class:"text-[10px] font-semibold text-amber-900"},_l={class:"mt-0.5 flex flex-wrap gap-1"},wl={class:"mt-4 flex justify-end"},kl={key:5,class:"fixed inset-0 z-40 flex items-center justify-center bg-black/40 px-4 py-6 backdrop-blur-sm"},jl={class:"w-full max-w-lg rounded-xl bg-white p-5 text-xs text-gray-700 shadow-xl"},Cl={class:"mb-3 flex items-center justify-between"},Nl={class:"grid grid-cols-2 gap-3"},Sl={class:"grid grid-cols-2 gap-3"},Al={class:"max-h-52 space-y-2 overflow-auto rounded-md border border-gray-200 bg-white p-2"},Ml={class:"flex items-center gap-2 rounded-md px-2 py-1.5 text-[11px] text-gray-700 hover:bg-slate-50"},Tl=["checked","onChange"],Fl={class:"font-medium text-gray-800"},Il={key:0,class:"border-t border-gray-100 px-2 pb-2 pt-2"},$l={class:"mt-1 grid grid-cols-2 gap-1"},Xl=["checked","onChange"],Vl={class:"text-gray-800"},Bl={key:0,class:"col-span-2 px-2 py-1 text-[11px] text-gray-500"},Ll={class:"max-h-72 space-y-2 overflow-auto rounded-md border border-gray-200 bg-white p-2"},zl={class:"text-[10px] font-semibold text-gray-700"},Rl={class:"mt-1 grid grid-cols-2 gap-1"},Dl=["checked","onChange"],Ol={class:"font-medium text-gray-800"},Ul={key:0,class:"col-span-2 px-2 py-1 text-[11px] text-gray-500"},El={key:0,class:"px-2 py-2 text-[11px] text-gray-500"},ql={class:"mt-4 flex justify-end gap-2"},Pl={key:6,class:"fixed inset-0 z-40 flex items-center justify-center bg-black/40 px-4 py-6 backdrop-blur-sm"},Hl={class:"w-full max-w-sm rounded-xl bg-white p-5 text-xs text-gray-700 shadow-xl"},Wl={class:"mb-3 text-[11px] text-gray-600"},Jl={class:"font-semibold"},Kl={class:"mt-3 flex justify-end gap-2"},Yl={key:7,class:"fixed inset-0 z-40 flex items-center justify-center bg-black/40 px-4 py-6 backdrop-blur-sm"},Zl={class:"w-full max-w-lg rounded-xl bg-white p-5 text-xs text-gray-700 shadow-xl"},Gl={class:"mb-3 flex items-center justify-between"},Ql={class:"grid grid-cols-2 gap-3"},ea={class:"max-h-52 space-y-2 overflow-auto rounded-md border border-gray-200 bg-white p-2"},ta={class:"flex items-center gap-2 rounded-md px-2 py-1.5 text-[11px] text-gray-700 hover:bg-slate-50"},sa=["checked","onChange"],la={class:"font-medium text-gray-800"},aa={key:0,class:"border-t border-gray-100 px-2 pb-2 pt-2"},oa={class:"mt-1 grid grid-cols-2 gap-1"},ra=["checked","onChange"],na={class:"text-gray-800"},ia={key:0,class:"col-span-2 px-2 py-1 text-[11px] text-gray-500"},da={class:"max-h-72 space-y-2 overflow-auto rounded-md border border-gray-200 bg-white p-2"},ua={class:"text-[10px] font-semibold text-gray-700"},ca={class:"mt-1 grid grid-cols-2 gap-1"},ba=["checked","onChange"],pa={class:"font-medium text-gray-800"},ma={key:0,class:"col-span-2 px-2 py-1 text-[11px] text-gray-500"},xa={key:0,class:"px-2 py-2 text-[11px] text-gray-500"},ga={class:"mt-4 flex justify-end gap-2"},ya={key:8,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 px-4 py-6 backdrop-blur-sm"},fa={class:"w-full max-w-sm rounded-xl bg-white p-5 text-xs text-gray-700 shadow-xl"},ha={class:"mb-3 text-[11px] text-gray-600"},va={class:"font-semibold"},ja={__name:"TeachersIndex",props:{teachers:{type:Array,default:()=>[]},classes:{type:Array,default:()=>[]},allClasses:{type:Array,default:()=>[]},subjects:{type:Array,default:()=>[]},classSubjectMap:{type:Object,default:()=>({})}},setup(G){const h=G,V=x(!1);x(!1);const H=x(!1),B=x(!1),W=x(!1),J=x(!1),Q=x(!1),K=x(!1),ee=x(!1),be=x(!1),te=x(!1),se=x({classId:null,teachers:[],context:null}),A=x(!1),Y=x([]),le=x(null),_=x([]),ae=x(""),U=S(()=>{const l=String(ae.value||"").toLowerCase().trim();return l?(h.teachers||[]).filter(t=>{const a=String((t==null?void 0:t.name)||"").toLowerCase(),s=String((t==null?void 0:t.email)||"").toLowerCase(),o=String((t==null?void 0:t.phone)||"").toLowerCase(),r=String((t==null?void 0:t.check_number)||"").toLowerCase();return a.includes(l)||s.includes(l)||o.includes(l)||r.includes(l)}):h.teachers||[]}),Ae=l=>{I(_.value,l)},Me=S(()=>{const l=(U.value||[]).map(a=>Number(a.id)).filter(a=>Number.isFinite(a));if(!l.length)return!1;const t=new Set((_.value||[]).map(a=>Number(a)));return l.every(a=>t.has(a))}),Te=()=>{const l=(U.value||[]).map(s=>Number(s.id)).filter(s=>Number.isFinite(s)),t=new Set((_.value||[]).map(s=>Number(s))),a=l.length>0&&l.every(s=>t.has(s));_.value=a?[]:l},Fe=()=>{(_.value||[]).length&&(K.value=!0)},Ie=()=>{K.value=!1},$e=()=>{(_.value||[]).length&&O.post(route("teachers.bulk-destroy"),{teacher_ids:_.value},{preserveScroll:!0,onSuccess:()=>{_.value=[],K.value=!1}})},f=P({name:"",phone:"",class_ids:[],subject_ids:[]}),N=P({}),M=x([]),c=P({id:null,name:"",phone:"",check_number:"",teaching_classes:"",class_ids:[],subject_ids:[]}),w=P({}),T=x([]),oe=l=>{var s;const t=(l||[]).map(o=>Number(o)).filter(o=>Number.isFinite(o));if(!t.length)return null;const a=new Set;for(const o of t){const r=Array.isArray((s=h.classSubjectMap)==null?void 0:s[o])?h.classSubjectMap[o]:[];for(const u of r){const y=Number(u);Number.isFinite(y)&&a.add(y)}}return a.size?a:null},L=l=>{const t=Number(l);return!Number.isFinite(t)||t<=0?[]:(h.allClasses||[]).filter(a=>Number(a.parent_class_id)===t).map(a=>({id:Number(a.id),label:$(a)})).sort((a,s)=>String(a.label).localeCompare(String(s.label)))},pe=(l,t)=>{const a=new Set;for(const s of l||[])for(const o of L(s))a.add(Number(o.id));return(t||[]).filter(s=>a.has(Number(s)))},me=(l,t)=>{const a=new Set((t||[]).map(o=>Number(o)).filter(o=>Number.isFinite(o))),s=new Set;for(const o of l||[]){const r=Number(o);if(!Number.isFinite(r)||r<=0)continue;const u=L(r);if(!u.length){s.add(r);continue}const y=u.filter(k=>a.has(Number(k.id)));if(y.length)for(const k of y)s.add(Number(k.id));else for(const k of u)s.add(Number(k.id))}return Array.from(s)},z=S(()=>me(M.value,f.class_ids)),F=S(()=>me(T.value,c.class_ids)),xe=l=>{const t=Number(l),a=(h.allClasses||[]).find(s=>Number(s.id)===t)||(h.classes||[]).find(s=>Number(s.id)===t);return a?$(a):`Class #${t}`},E=l=>{var s,o;const t=Number(l),a=((s=h.classSubjectMap)==null?void 0:s[t])||((o=h.classSubjectMap)==null?void 0:o[String(t)])||null;if(Array.isArray(a)&&a.length){const r=new Set(a.map(u=>Number(u)).filter(u=>Number.isFinite(u)));return(h.subjects||[]).filter(u=>r.has(Number(u.id)))}return h.subjects||[]},q=(l,t)=>{const a=new Set((t||[]).map(s=>Number(s)).filter(s=>Number.isFinite(s)));for(const s of Object.keys(l)){const o=Number(s);a.has(o)||delete l[s]}for(const s of a)Object.prototype.hasOwnProperty.call(l,String(s))||(l[String(s)]=[])},ge=l=>{const t=new Set;for(const a of Object.keys(l||{})){const s=Array.isArray(l[a])?l[a]:[];for(const o of s){const r=Number(o);Number.isFinite(r)&&r>0&&t.add(r)}}return Array.from(t)},ye=l=>{const t=[];for(const a of Object.keys(l||{})){const s=Number(a);if(!Number.isFinite(s)||s<=0)continue;const o=Array.isArray(l[a])?l[a]:[];for(const r of o){const u=Number(r);!Number.isFinite(u)||u<=0||t.push({class_id:s,subject_id:u})}}return t},fe=(l,t)=>{Y.value=Array.isArray(l)?l:[],le.value=typeof t=="function"?t:null,ee.value=!0},re=()=>{A.value||(ee.value=!1,Y.value=[],le.value=null)},Xe=()=>{if(A.value)return;const l=le.value;re(),l&&l()},he=async({pairs:l,excludeTeacherId:t})=>{var a;A.value=!0;try{const o=await(await fetch(route("teachers.assignment-conflicts"),{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest",Accept:"application/json","X-CSRF-TOKEN":((a=document.querySelector('meta[name="csrf-token"]'))==null?void 0:a.getAttribute("content"))||""},credentials:"same-origin",body:JSON.stringify({pairs:l,exclude_teacher_id:t||void 0})})).json();return Array.isArray(o==null?void 0:o.conflicts)?o.conflicts:[]}catch{return[]}finally{A.value=!1}},I=(l,t)=>{const a=Number(t);if(!Number.isFinite(a))return;const s=l.findIndex(o=>Number(o)===a);s===-1?l.push(a):l.splice(s,1)},Ve=l=>I(f.class_ids,l),Be=l=>I(c.class_ids,l),ve=()=>{te.value||(be.value=!1,se.value={classId:null,teachers:[],context:null})},Le=()=>{ve()},ze=l=>{I(M.value,l),f.class_ids=pe(M.value,f.class_ids),f.subject_ids=[]},Re=l=>{I(T.value,l),c.class_ids=pe(T.value,c.class_ids),c.subject_ids=[]},De=async l=>{const t=Number(l);Number.isFinite(t)&&Ve(t)},Oe=async l=>{const t=Number(l);Number.isFinite(t)&&Be(t)},_e=l=>{const t=oe(l);return t?(h.subjects||[]).filter(a=>t.has(Number(a.id))):h.subjects||[]};S(()=>_e(z.value)),S(()=>_e(F.value)),ue(()=>[M.value,f.class_ids],()=>{const l=oe(z.value);if(!l){f.subject_ids=[];return}f.subject_ids=(f.subject_ids||[]).filter(t=>l.has(Number(t))),q(N,z.value)},{deep:!0}),ue(()=>[T.value,c.class_ids],()=>{const l=oe(F.value);if(!l){c.subject_ids=[];return}c.subject_ids=(c.subject_ids||[]).filter(t=>l.has(Number(t))),q(w,F.value)},{deep:!0}),P({class_id:""});const b=x(null),ne=x(!1),R=x({teacher:null,limits:[]}),Z=x(!1),j=x(!1),v=x([]),Ue=l=>{const t=Number(l);return!Number.isFinite(t)||t<=0?[]:(h.allClasses||[]).filter(a=>Number(a.parent_class_id)===t).map(a=>({id:a.id,label:$(a)})).sort((a,s)=>String(a.label).localeCompare(String(s.label)))},we=l=>{var u;const t=l.stream_id?Number(l.stream_id):Number(l.base_class_id),a=((u=b.value)==null?void 0:u.assigned_class_subject_ids)||{},s=(a==null?void 0:a[t])||(a==null?void 0:a[String(t)])||[],o=Array.isArray(s)?s.map(y=>Number(y)).filter(y=>Number.isFinite(y)&&y>0):[];if(!o.length)return E(t);const r=new Set(o);return(h.subjects||[]).filter(y=>r.has(Number(y.id)))},Ee=S(()=>{var a;const l=((a=b.value)==null?void 0:a.assigned_class_ids)||[],t=new Set((l||[]).map(s=>Number(s)).filter(s=>Number.isFinite(s)&&s>0));return(h.classes||[]).filter(s=>t.has(Number(s.id)))}),ke=l=>{var s;const t=Number(l);if(!Number.isFinite(t)||t<=0)return[];const a=new Set((((s=b.value)==null?void 0:s.assigned_stream_class_ids)||[]).map(o=>Number(o)).filter(o=>Number.isFinite(o)&&o>0));return(h.allClasses||[]).filter(o=>Number(o.parent_class_id)===t).filter(o=>a.has(Number(o.id))).map(o=>({id:Number(o.id),label:$(o)})).sort((o,r)=>String(o.label).localeCompare(String(r.label)))};ue(()=>v.value,l=>{for(const t of l||[]){const a=Number(t.base_class_id),s=t.stream_id?Number(t.stream_id):"",o=ke(a),r=s&&o.some(k=>Number(k.id)===Number(s));t.stream_id&&!r&&(t.stream_id="");const y=we(t).map(k=>Number(k.id)).includes(Number(t.subject_id));t.subject_id&&!y&&(t.subject_id="")}},{deep:!0});const qe=S(()=>{var l;return(((l=R.value)==null?void 0:l.limits)||[]).reduce((t,a)=>t+(Number(a.periods_per_week)||0),0)}),je=()=>{f.name="",f.phone="",f.class_ids=[],f.subject_ids=[],M.value=[];for(const l of Object.keys(N))delete N[l]},Pe=async()=>{const l=z.value;q(N,l);const t={};for(const r of Object.keys(N))t[r]=Array.isArray(N[r])?N[r]:[];const a=ge(t),s={name:f.name,phone:f.phone,class_ids:l,subject_ids:a,class_subject_map:t},o=ye(t);if(o.length){const r=await he({pairs:o,excludeTeacherId:null});if(r.length){fe(r,()=>{O.post(route("teachers.store"),s,{preserveScroll:!0,onSuccess:()=>{je(),V.value=!1}})});return}}O.post(route("teachers.store"),s,{preserveScroll:!0,onSuccess:()=>{je(),V.value=!1}})},He=l=>{b.value=l,H.value=!0},We=l=>{b.value=l,c.id=l.id,c.name=l.name,c.phone=l.phone,c.check_number=l.check_number,c.teaching_classes=l.teaching_classes,c.class_ids=Array.isArray(l.assigned_stream_class_ids)?[...l.assigned_stream_class_ids]:[],c.subject_ids=Array.isArray(l.assigned_subject_ids)?[...l.assigned_subject_ids]:[];const t=new Set;for(const s of c.class_ids||[]){const o=(h.allClasses||[]).find(u=>Number(u.id)===Number(s)),r=o!=null&&o.parent_class_id?Number(o.parent_class_id):Number(s);Number.isFinite(r)&&r>0&&t.add(r)}T.value=Array.from(t);for(const s of Object.keys(w))delete w[s];const a=(l==null?void 0:l.assigned_class_subject_ids)||{};for(const s of Object.keys(a)){const o=Array.isArray(a[s])?a[s]:[];w[String(s)]=o.map(r=>Number(r)).filter(r=>Number.isFinite(r))}q(w,F.value),B.value=!0},Je=async()=>{if(!c.id)return;const l=F.value;q(w,l);const t={};for(const r of Object.keys(w))t[r]=Array.isArray(w[r])?w[r]:[];const a=ge(t),s={name:c.name,phone:c.phone,check_number:c.check_number,class_ids:l,subject_ids:a,class_subject_map:t},o=ye(t);if(o.length){const r=await he({pairs:o,excludeTeacherId:c.id});if(r.length){fe(r,()=>{O.put(route("teachers.update",c.id),s,{preserveScroll:!0,onSuccess:()=>{B.value=!1}})});return}}O.put(route("teachers.update",c.id),s,{preserveScroll:!0,onSuccess:()=>{B.value=!1}})},Ke=l=>{b.value=l,W.value=!0},Ye=()=>{b.value&&O.delete(route("teachers.destroy",b.value.id),{preserveScroll:!0,onSuccess:()=>{W.value=!1}})},Ze=async l=>{b.value=l,J.value=!0,ne.value=!0;try{const a=await(await fetch(route("teachers.weekly-limits",l.id),{headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json"},credentials:"same-origin"})).json();R.value={teacher:(a==null?void 0:a.teacher)||{id:l.id,name:l.name},limits:Array.isArray(a==null?void 0:a.limits)?a.limits:[]}}catch{R.value={teacher:{id:l.id,name:l.name},limits:[]}}finally{ne.value=!1}},Ge=async l=>{b.value=l,Q.value=!0,Z.value=!0,v.value=[];try{const a=await(await fetch(route("teachers.weekly-limits",l.id),{headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json"},credentials:"same-origin"})).json(),s=Array.isArray(a==null?void 0:a.limits)?a.limits:[];v.value=s.map(o=>{const r=Number(o.school_class_id)||"",u=(h.allClasses||[]).find(st=>Number(st.id)===Number(r)),y=u!=null&&u.parent_class_id?Number(u.parent_class_id):r,k=u!=null&&u.parent_class_id?r:"";return{base_class_id:y||"",stream_id:k||"",subject_id:Number(o.subject_id)||"",periods_per_week:Number(o.periods_per_week)||0}})}catch{v.value=[]}finally{Z.value=!1}},ie=()=>{j.value||(Q.value=!1,v.value=[])},Qe=()=>{v.value=[...v.value,{base_class_id:"",stream_id:"",subject_id:"",periods_per_week:0}]},et=l=>{v.value=v.value.filter((t,a)=>a!==l)},tt=async()=>{var t;if(!b.value||j.value)return;const l=(v.value||[]).map(a=>{const s=a.stream_id?Number(a.stream_id):Number(a.base_class_id),o=a.periods_per_week===""||a.periods_per_week===null||typeof a.periods_per_week>"u"?0:Number(a.periods_per_week);return{school_class_id:s,subject_id:Number(a.subject_id),teacher_id:Number(b.value.id),periods_per_week:Number.isFinite(o)&&o>=0?o:0}}).filter(a=>Number.isFinite(a.school_class_id)&&a.school_class_id>0).filter(a=>Number.isFinite(a.subject_id)&&a.subject_id>0);if(l.length){j.value=!0;try{await fetch(route("timetables.weekly-limits.save"),{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest",Accept:"application/json","X-CSRF-TOKEN":((t=document.querySelector('meta[name="csrf-token"]'))==null?void 0:t.getAttribute("content"))||""},credentials:"same-origin",body:JSON.stringify({limits:l})}),ie()}finally{j.value=!1}}},$=l=>{const t=l!=null&&l.name?String(l.name).trim():"",a=l!=null&&l.level?String(l.level).trim():"";return t||a},de=l=>{const t=l!=null&&l.subject_code?String(l.subject_code).trim():"",a=l!=null&&l.name?String(l.name).trim():"";return t&&a?`${t} - ${a}`:t||a};return(l,t)=>(i(),n(m,null,[Ce(lt(at),{title:"Teachers"}),Ce(rt,null,{header:Ne(()=>[e("div",nt,[t[16]||(t[16]=e("div",null,[e("h2",{class:"text-2xl font-semibold leading-tight text-gray-800"}," Teachers "),e("p",{class:"mt-1 text-sm text-gray-500"}," List of all registered teachers with their contact details, registration number and assigned classes. ")],-1)),e("div",it,[e("button",{type:"button",class:"rounded-md bg-emerald-600 px-3 py-1.5 text-xs font-semibold text-white shadow-sm hover:bg-emerald-700",onClick:t[0]||(t[0]=a=>V.value=!0)}," Add Teacher "),_.value.length?(i(),n("button",{key:0,type:"button",class:"rounded-md bg-red-600 px-3 py-1.5 text-xs font-semibold text-white shadow-sm hover:bg-red-700",onClick:Fe}," Delete selected ("+d(_.value.length)+") ",1)):p("",!0)])])]),default:Ne(()=>{var a;return[be.value?(i(),n("div",dt,[e("div",ut,[e("div",ct,[t[17]||(t[17]=e("div",null,[e("h3",{class:"text-sm font-semibold text-gray-900"},"This class already has teacher(s)"),e("p",{class:"mt-0.5 text-[11px] text-gray-500"}," Darasa hili tayari lina mwalimu. Mfumo unaruhusu walimu zaidi ya mmoja. ")],-1)),e("button",{type:"button",class:"inline-flex h-6 w-6 items-center justify-center rounded-full bg-gray-100 text-[11px] font-bold text-gray-600 hover:bg-gray-200",disabled:te.value,onClick:ve}," × ",8,bt)]),e("div",pt,[t[18]||(t[18]=e("div",{class:"font-semibold"},"Existing teacher(s):",-1)),e("div",mt,[(i(!0),n(m,null,g(se.value.teachers||[],s=>(i(),n("span",{key:s.id,class:"rounded bg-white/70 px-2 py-0.5 text-[10px] text-amber-900 ring-1 ring-amber-200"},d(s.name),1))),128)),(se.value.teachers||[]).length?p("",!0):(i(),n("span",xt," — "))])]),e("div",gt,[e("button",{type:"button",class:"rounded-md bg-amber-600 px-3 py-1.5 text-[11px] font-semibold text-white shadow-sm hover:bg-amber-700 disabled:opacity-60",disabled:te.value,onClick:Le}," OK ",8,yt)])])])):p("",!0),ee.value?(i(),n("div",ft,[e("div",ht,[e("div",vt,[t[19]||(t[19]=e("div",null,[e("h3",{class:"text-sm font-semibold text-gray-900"},"Taarifa: tayari kuna mwalimu"),e("p",{class:"mt-0.5 text-[11px] text-gray-500"}," Darasa/stream na somo hili tayari lina mwalimu. Unataka kuruhusu walimu wawili (au zaidi) wafundishe pamoja? ")],-1)),e("button",{type:"button",class:"inline-flex h-6 w-6 items-center justify-center rounded-full bg-gray-100 text-[11px] font-bold text-gray-600 hover:bg-gray-200",disabled:A.value,onClick:re}," × ",8,_t)]),e("div",wt,[(i(!0),n(m,null,g(Y.value,s=>(i(),n("div",{key:`${s.class_id}-${s.subject_id}`,class:"rounded-md border border-amber-200 bg-amber-50 p-2"},[e("div",kt,d(s.class_label)+" · "+d(s.subject_label),1),e("div",jt,[(i(!0),n(m,null,g(s.teachers||[],o=>(i(),n("span",{key:o.id,class:"rounded bg-white/70 px-2 py-0.5 text-[10px] text-amber-900 ring-1 ring-amber-200"},d(o.name),1))),128))])]))),128)),Y.value.length?p("",!0):(i(),n("div",Ct," No conflicts. "))]),e("div",Nt,[e("button",{type:"button",class:"rounded-md bg-gray-50 px-3 py-1.5 text-[11px] font-medium text-gray-700 ring-1 ring-gray-200 hover:bg-gray-100",disabled:A.value,onClick:re}," Cancel ",8,St),e("button",{type:"button",class:"rounded-md bg-amber-600 px-3 py-1.5 text-[11px] font-semibold text-white shadow-sm hover:bg-amber-700 disabled:opacity-60",disabled:A.value,onClick:Xe}," Ruhusu wawili (Endelea) ",8,At)])])])):p("",!0),Q.value&&b.value?(i(),n("div",Mt,[e("div",Tt,[e("div",Ft,[e("div",null,[t[20]||(t[20]=e("h3",{class:"text-sm font-semibold text-gray-900"},"Assign vipindi (weekly limits)",-1)),e("p",It,d(b.value.name)+" · Weka vipindi kwa wiki kwa kila darasa na somo. ",1)]),e("button",{type:"button",class:"inline-flex h-6 w-6 items-center justify-center rounded-full bg-gray-100 text-[11px] font-bold text-gray-600 hover:bg-gray-200",disabled:j.value,onClick:ie}," × ",8,$t)]),Z.value?(i(),n("div",Xt," Loading... ")):(i(),n("div",Vt,[e("div",Bt,[e("table",Lt,[t[25]||(t[25]=e("thead",null,[e("tr",{class:"bg-gray-50 text-left"},[e("th",{class:"border-b border-gray-200 px-3 py-2"},"Class"),e("th",{class:"border-b border-gray-200 px-3 py-2"},"Subject"),e("th",{class:"border-b border-gray-200 px-3 py-2"},"Vipindi / Wiki"),e("th",{class:"border-b border-gray-200 px-3 py-2"})])],-1)),e("tbody",null,[v.value.length?p("",!0):(i(),n("tr",zt,[...t[21]||(t[21]=[e("td",{colspan:"4",class:"px-3 py-6 text-center text-[11px] text-gray-500"},' Hakuna row bado. Bonyeza "Add row" kuongeza. ',-1)])])),(i(!0),n(m,null,g(v.value,(s,o)=>(i(),n("tr",{key:o,class:"hover:bg-gray-50"},[e("td",Rt,[C(e("select",{"onUpdate:modelValue":r=>s.base_class_id=r,class:"w-full rounded-md border border-gray-300 px-2 py-1 text-[11px] focus:border-emerald-500 focus:outline-none focus:ring-emerald-500"},[t[22]||(t[22]=e("option",{value:""},"Select class...",-1)),(i(!0),n(m,null,g(Ee.value,r=>(i(),n("option",{key:r.id,value:r.id},d($(r)),9,Ot))),128))],8,Dt),[[ce,s.base_class_id]]),ke(s.base_class_id).length?(i(),n("div",Ut,[C(e("select",{"onUpdate:modelValue":r=>s.stream_id=r,class:"w-full rounded-md border border-gray-300 px-2 py-1 text-[11px] focus:border-emerald-500 focus:outline-none focus:ring-emerald-500"},[t[23]||(t[23]=e("option",{value:""},"No stream (base class)",-1)),(i(!0),n(m,null,g(Ue(s.base_class_id),r=>(i(),n("option",{key:r.id,value:r.id},d(r.label),9,qt))),128))],8,Et),[[ce,s.stream_id]])])):p("",!0)]),e("td",Pt,[C(e("select",{"onUpdate:modelValue":r=>s.subject_id=r,class:"w-full rounded-md border border-gray-300 px-2 py-1 text-[11px] focus:border-emerald-500 focus:outline-none focus:ring-emerald-500"},[t[24]||(t[24]=e("option",{value:""},"Select subject...",-1)),(i(!0),n(m,null,g(we(s),r=>(i(),n("option",{key:r.id,value:r.id},d(de(r)),9,Wt))),128))],8,Ht),[[ce,s.subject_id]])]),e("td",Jt,[C(e("input",{"onUpdate:modelValue":r=>s.periods_per_week=r,type:"number",min:"0",max:"50",class:"w-24 rounded-md border border-gray-300 px-2 py-1 text-[11px] focus:border-emerald-500 focus:outline-none focus:ring-emerald-500"},null,8,Kt),[[X,s.periods_per_week,void 0,{number:!0}]])]),e("td",Yt,[e("button",{type:"button",class:"rounded-md bg-red-50 px-2 py-1 text-[11px] font-medium text-red-700 ring-1 ring-red-100 hover:bg-red-100",disabled:j.value,onClick:r=>et(o)}," Remove ",8,Zt)])]))),128))])])]),e("div",Gt,[e("button",{type:"button",class:"rounded-md bg-slate-50 px-3 py-1.5 text-[11px] font-medium text-slate-700 ring-1 ring-slate-200 hover:bg-slate-100",disabled:j.value,onClick:Qe}," Add row ",8,Qt),e("div",es,[e("button",{type:"button",class:"rounded-md bg-gray-50 px-3 py-1.5 text-[11px] font-medium text-gray-700 ring-1 ring-gray-200 hover:bg-gray-100",disabled:j.value,onClick:ie}," Cancel ",8,ts),e("button",{type:"button",class:"rounded-md bg-emerald-600 px-3 py-1.5 text-[11px] font-semibold text-white shadow-sm hover:bg-emerald-700 disabled:opacity-60",disabled:j.value||Z.value||!v.value.length,onClick:tt},d(j.value?"Saving...":"Save vipindi"),9,ss)])])]))])])):p("",!0),e("div",ls,[e("div",as,[e("div",os,[e("div",null,[t[27]||(t[27]=e("p",{class:"text-sm font-semibold text-gray-800"},"Teachers",-1)),e("p",rs,[t[26]||(t[26]=D("Jumla: ",-1)),e("span",ns,d(U.value.length),1)])]),e("div",is,[t[28]||(t[28]=e("label",{class:"mb-1 block text-[11px] font-medium text-gray-700"},"Search teacher",-1)),C(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>ae.value=s),type:"text",class:"w-full rounded-md border border-gray-300 px-3 py-2 text-[11px] focus:border-emerald-500 focus:outline-none focus:ring-emerald-500",placeholder:"Search name/email/phone/check no..."},null,512),[[X,ae.value]])])]),e("div",ds,[e("div",us,[e("table",cs,[e("thead",null,[e("tr",bs,[e("th",ps,[e("input",{type:"checkbox",class:"h-4 w-4 rounded border-gray-300 text-emerald-600 focus:ring-emerald-500",checked:Me.value,onChange:Te},null,40,ms)]),t[29]||(t[29]=e("th",{class:"px-4 py-3"},"Name",-1)),t[30]||(t[30]=e("th",{class:"px-4 py-3"},"Phone",-1)),t[31]||(t[31]=e("th",{class:"px-4 py-3"},"Check No.",-1)),t[32]||(t[32]=e("th",{class:"px-4 py-3"},"Assigned Classes",-1)),t[33]||(t[33]=e("th",{class:"px-4 py-3"},"Assigned Subjects",-1)),t[34]||(t[34]=e("th",{class:"px-4 py-3 text-right"},"Actions",-1))])]),e("tbody",null,[U.value.length===0?(i(),n("tr",xs,[...t[35]||(t[35]=[e("td",{colspan:"7",class:"px-4 py-10 text-center"},[e("div",{class:"mx-auto max-w-sm"},[e("div",{class:"text-sm font-semibold text-gray-800"},"No teachers found"),e("div",{class:"mt-1 text-xs text-gray-500"},"Badilisha search au ongeza mwalimu mpya.")])],-1)])])):p("",!0),(i(!0),n(m,null,g(U.value,(s,o)=>(i(),n("tr",{key:s.id,class:ot(["border-b border-gray-100 text-xs text-gray-700",o%2===0?"bg-white":"bg-slate-50/40","hover:bg-emerald-50/40"])},[e("td",gs,[e("input",{type:"checkbox",class:"h-4 w-4 rounded border-gray-300 text-emerald-600 focus:ring-emerald-500",checked:_.value.map(r=>Number(r)).includes(Number(s.id)),onChange:r=>Ae(s.id)},null,40,ys)]),e("td",fs,[e("div",hs,[e("span",vs,d(s.name),1),e("span",_s,d(s.email),1)])]),e("td",ws,d(s.phone||"—"),1),e("td",ks,d(s.check_number||"—"),1),e("td",js,[s.assigned_classes&&s.assigned_classes.length?(i(),n("div",Cs,[(i(!0),n(m,null,g(s.assigned_classes,r=>(i(),n("span",{key:r,class:"rounded bg-gray-100 px-1.5 py-0.5 text-[10px] text-gray-700"},d(r),1))),128))])):(i(),n("span",Ns,"—"))]),e("td",Ss,[s.assigned_class_subjects&&Object.keys(s.assigned_class_subjects).length?(i(),n("div",As,[(i(!0),n(m,null,g(s.assigned_class_subjects,(r,u)=>(i(),n("div",{key:u,class:"rounded-md border border-emerald-100 bg-emerald-50/40 px-2 py-1"},[e("div",Ms,d(u),1),e("div",Ts,[(i(!0),n(m,null,g(r,y=>(i(),n("span",{key:`${u}-${y}`,class:"rounded bg-white/70 px-1.5 py-0.5 text-[10px] text-emerald-800 ring-1 ring-emerald-100"},d(y),1))),128))])]))),128))])):s.assigned_subjects&&s.assigned_subjects.length?(i(),n("div",Fs,[(i(!0),n(m,null,g(s.assigned_subjects,r=>(i(),n("span",{key:r,class:"rounded bg-emerald-50 px-1.5 py-0.5 text-[10px] text-emerald-800"},d(r),1))),128))])):(i(),n("span",Is,"—"))]),e("td",$s,[e("div",Xs,[e("button",{type:"button",class:"inline-flex h-8 w-8 items-center justify-center rounded-md bg-white text-gray-700 ring-1 ring-gray-200 hover:bg-gray-50",title:"Timetable preview",onClick:r=>Ze(s)},[...t[36]||(t[36]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("path",{d:"M3 4h18"}),e("path",{d:"M8 2v4"}),e("path",{d:"M16 2v4"}),e("rect",{x:"3",y:"6",width:"18",height:"16",rx:"2"}),e("path",{d:"M7 10h4"}),e("path",{d:"M7 14h4"}),e("path",{d:"M13 10h4"}),e("path",{d:"M13 14h4"})],-1)])],8,Vs),e("button",{type:"button",class:"inline-flex h-8 w-8 items-center justify-center rounded-md bg-amber-50 text-amber-700 ring-1 ring-amber-100 hover:bg-amber-100",title:"Assign vipindi",onClick:r=>Ge(s)},[...t[37]||(t[37]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("path",{d:"M12 20h9"}),e("path",{d:"M16.5 3.5a2.1 2.1 0 0 1 3 3L7 19l-4 1 1-4Z"})],-1)])],8,Bs),e("button",{type:"button",class:"inline-flex h-8 w-8 items-center justify-center rounded-md bg-white text-gray-700 ring-1 ring-gray-200 hover:bg-gray-50",title:"Details",onClick:r=>He(s)},[...t[38]||(t[38]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("circle",{cx:"12",cy:"12",r:"10"}),e("path",{d:"M12 16v-4"}),e("path",{d:"M12 8h.01"})],-1)])],8,Ls),e("button",{type:"button",class:"inline-flex h-8 w-8 items-center justify-center rounded-md bg-emerald-50 text-emerald-700 ring-1 ring-emerald-100 hover:bg-emerald-100",title:"Edit",onClick:r=>We(s)},[...t[39]||(t[39]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("path",{d:"M12 20h9"}),e("path",{d:"M16.5 3.5a2.1 2.1 0 0 1 3 3L7 19l-4 1 1-4Z"})],-1)])],8,zs),e("button",{type:"button",class:"inline-flex h-8 w-8 items-center justify-center rounded-md bg-red-50 text-red-700 ring-1 ring-red-200 hover:bg-red-100",title:"Delete",onClick:r=>Ke(s)},[...t[40]||(t[40]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("path",{d:"M3 6h18"}),e("path",{d:"M8 6V4h8v2"}),e("path",{d:"M19 6l-1 14H6L5 6"}),e("path",{d:"M10 11v6"}),e("path",{d:"M14 11v6"})],-1)])],8,Rs)])])],2))),128))])])])])])]),J.value&&b.value?(i(),n("div",Ds,[e("div",Os,[e("div",Us,[e("div",null,[t[41]||(t[41]=e("h3",{class:"text-sm font-semibold text-gray-900"},"Teacher timetable preview",-1)),e("p",Es,[D(d(((a=R.value.teacher)==null?void 0:a.name)||b.value.name)+" · Total vipindi kwa wiki: ",1),e("span",qs,d(qe.value),1)])]),e("button",{type:"button",class:"inline-flex h-6 w-6 items-center justify-center rounded-full bg-gray-100 text-[11px] font-bold text-gray-600 hover:bg-gray-200",onClick:t[2]||(t[2]=s=>J.value=!1)}," × ")]),ne.value?(i(),n("div",Ps," Loading... ")):(i(),n("div",Hs,[e("table",Ws,[t[43]||(t[43]=e("thead",null,[e("tr",{class:"bg-gray-50 text-left"},[e("th",{class:"border-b border-gray-200 px-3 py-2"},"Class"),e("th",{class:"border-b border-gray-200 px-3 py-2"},"Subject"),e("th",{class:"border-b border-gray-200 px-3 py-2"},"Vipindi / Wiki")])],-1)),e("tbody",null,[R.value.limits.length?p("",!0):(i(),n("tr",Js,[...t[42]||(t[42]=[e("td",{colspan:"3",class:"px-3 py-4 text-center text-[11px] text-gray-500"}," Hakuna limitations zilizowekwa kwa huyu mwalimu bado. ",-1)])])),(i(!0),n(m,null,g(R.value.limits,s=>(i(),n("tr",{key:s.id,class:"hover:bg-gray-50"},[e("td",Ks,d(s.class_label),1),e("td",Ys,[e("div",Zs,d(s.subject_code),1),e("div",Gs,d(s.subject_name),1)]),e("td",Qs,d(s.periods_per_week),1)]))),128))])])])),e("div",el,[e("button",{type:"button",class:"rounded-md bg-emerald-50 px-3 py-1.5 text-[11px] font-medium text-emerald-700 ring-1 ring-emerald-100 hover:bg-emerald-100",onClick:t[3]||(t[3]=s=>J.value=!1)}," Close ")])])])):p("",!0),H.value&&b.value?(i(),n("div",tl,[e("div",sl,[e("div",ll,[t[44]||(t[44]=e("div",null,[e("h3",{class:"text-sm font-semibold text-gray-900"},"Teacher details"),e("p",{class:"mt-0.5 text-[11px] text-gray-500"}," Full profile preview for this teacher. ")],-1)),e("button",{type:"button",class:"inline-flex h-6 w-6 items-center justify-center rounded-full bg-gray-100 text-[11px] font-bold text-gray-600 hover:bg-gray-200",onClick:t[4]||(t[4]=s=>H.value=!1)}," × ")]),e("dl",al,[e("div",ol,[t[45]||(t[45]=e("dt",{class:"font-semibold text-gray-600"},"Name",-1)),e("dd",rl,d(b.value.name),1)]),e("div",nl,[t[46]||(t[46]=e("dt",{class:"font-semibold text-gray-600"},"Email",-1)),e("dd",il,d(b.value.email),1)]),e("div",dl,[t[47]||(t[47]=e("dt",{class:"text-[10px] font-semibold text-gray-500"},"Phone",-1)),e("dd",ul,d(b.value.phone||"—"),1)]),e("div",cl,[t[48]||(t[48]=e("dt",{class:"text-[10px] font-semibold text-gray-500"},"Check No.",-1)),e("dd",bl,d(b.value.check_number||"—"),1)]),e("div",pl,[t[49]||(t[49]=e("dt",{class:"text-[10px] font-semibold text-gray-500"},"Assigned classes",-1)),e("dd",ml,[(i(!0),n(m,null,g(b.value.assigned_classes||[],s=>(i(),n("span",{key:s,class:"rounded bg-gray-100 px-2 py-0.5 text-[10px] text-gray-700"},d(s),1))),128)),(b.value.assigned_classes||[]).length?p("",!0):(i(),n("span",xl,"—"))])]),b.value.collaborations&&Object.keys(b.value.collaborations).length?(i(),n("div",gl,[t[50]||(t[50]=e("dt",{class:"text-[10px] font-semibold text-gray-500"},"Anaeshirikiana nae (same class & subject)",-1)),e("dd",yl,[(i(!0),n(m,null,g(b.value.collaborations,(s,o)=>(i(),n("div",{key:o,class:"rounded-lg border border-amber-200 bg-amber-50/50 p-2"},[e("div",fl,d(o),1),e("div",hl,[(i(!0),n(m,null,g(s,(r,u)=>(i(),n("div",{key:`${o}-${u}`},[e("div",vl,d(u),1),e("div",_l,[(i(!0),n(m,null,g(r,y=>(i(),n("span",{key:y.id,class:"rounded bg-white/70 px-2 py-0.5 text-[10px] text-amber-900 ring-1 ring-amber-200"},d(y.name),1))),128))])]))),128))])]))),128))])])):p("",!0)]),e("div",wl,[e("button",{type:"button",class:"rounded-md bg-emerald-50 px-3 py-1.5 text-[11px] font-medium text-emerald-700 ring-1 ring-emerald-100 hover:bg-emerald-100",onClick:t[5]||(t[5]=s=>H.value=!1)}," Close ")])])])):p("",!0),B.value&&b.value?(i(),n("div",kl,[e("div",jl,[e("div",Cl,[t[51]||(t[51]=e("div",null,[e("h3",{class:"text-sm font-semibold text-gray-900"},"Edit Teacher"),e("p",{class:"mt-0.5 text-[11px] text-gray-500"}," Update basic details for this teacher. ")],-1)),e("button",{type:"button",class:"inline-flex h-6 w-6 items-center justify-center rounded-full bg-gray-100 text-[11px] font-bold text-gray-600 hover:bg-gray-200",onClick:t[6]||(t[6]=s=>B.value=!1)}," × ")]),e("form",{class:"space-y-3",onSubmit:Se(Je,["prevent"])},[e("div",null,[t[52]||(t[52]=e("label",{class:"mb-1 block text-[11px] font-medium"},"Full Name",-1)),C(e("input",{"onUpdate:modelValue":t[7]||(t[7]=s=>c.name=s),type:"text",class:"w-full rounded-md border border-gray-300 px-2 py-1.5 text-[11px] focus:border-emerald-500 focus:outline-none focus:ring-emerald-500",required:""},null,512),[[X,c.name]])]),e("div",Nl,[e("div",null,[t[53]||(t[53]=e("label",{class:"mb-1 block text-[11px] font-medium"},"Phone Number",-1)),C(e("input",{"onUpdate:modelValue":t[8]||(t[8]=s=>c.phone=s),type:"tel",class:"w-full rounded-md border border-gray-300 px-2 py-1.5 text-[11px] focus:border-emerald-500 focus:outline-none focus:ring-emerald-500",placeholder:"07XXXXXXXX (optional)"},null,512),[[X,c.phone]])]),e("div",null,[t[54]||(t[54]=e("label",{class:"mb-1 block text-[11px] font-medium"},"Check / Registration No.",-1)),C(e("input",{"onUpdate:modelValue":t[9]||(t[9]=s=>c.check_number=s),type:"text",class:"w-full rounded-md border border-gray-300 px-2 py-1.5 text-[11px] focus:border-emerald-500 focus:outline-none focus:ring-emerald-500",placeholder:"TCH-XXXXXX (optional)"},null,512),[[X,c.check_number]])])]),e("div",Sl,[e("div",null,[t[56]||(t[56]=e("label",{class:"mb-1 block text-[11px] font-medium"},"Assigned classes",-1)),e("div",Al,[(i(!0),n(m,null,g(G.classes,s=>(i(),n("div",{key:s.id,class:"rounded-md border border-gray-100 bg-white"},[e("label",Ml,[e("input",{type:"checkbox",class:"h-3.5 w-3.5 rounded border-gray-300 text-emerald-600 focus:ring-emerald-500",checked:T.value.includes(s.id),onChange:o=>Re(s.id)},null,40,Tl),e("span",Fl,d($(s)),1)]),T.value.includes(s.id)?(i(),n("div",Il,[t[55]||(t[55]=e("div",{class:"text-[10px] font-semibold text-gray-600"},"Streams",-1)),e("div",$l,[(i(!0),n(m,null,g(L(s.id),o=>(i(),n("label",{key:o.id,class:"flex items-center gap-2 rounded-md px-2 py-1 text-[11px] text-gray-700 hover:bg-slate-50"},[e("input",{type:"checkbox",class:"h-3.5 w-3.5 rounded border-gray-300 text-emerald-600 focus:ring-emerald-500",checked:c.class_ids.includes(o.id),onChange:r=>Oe(o.id)},null,40,Xl),e("span",Vl,d(o.label),1)]))),128)),L(s.id).length?p("",!0):(i(),n("div",Bl," Hakuna streams kwenye darasa hili. "))])])):p("",!0)]))),128))]),t[57]||(t[57]=e("p",{class:"mt-1 text-[10px] text-gray-500"},"Chagua darasa, kisha chagua stream. Ukiacha stream bila kuchagua, hakuna assignment itahifadhiwa.",-1))]),e("div",null,[t[58]||(t[58]=e("label",{class:"mb-1 block text-[11px] font-medium"},"Assigned subjects",-1)),e("div",Ll,[(i(!0),n(m,null,g(F.value,s=>(i(),n("div",{key:s,class:"rounded-md border border-gray-100 bg-slate-50/40 p-2"},[e("div",zl,d(xe(s)),1),e("div",Rl,[(i(!0),n(m,null,g(E(s),o=>(i(),n("label",{key:`${s}-${o.id}`,class:"flex items-center gap-2 rounded-md px-2 py-1 text-[11px] text-gray-700 hover:bg-emerald-50/40"},[e("input",{type:"checkbox",class:"h-3.5 w-3.5 rounded border-gray-300 text-emerald-600 focus:ring-emerald-500",checked:(w[String(s)]||[]).map(r=>Number(r)).includes(Number(o.id)),onChange:r=>I(w[String(s)],o.id)},null,40,Dl),e("span",Ol,d(de(o)),1)]))),128)),E(s).length?p("",!0):(i(),n("div",Ul," Hakuna masomo yaliyowekwa kwa darasa hili. "))])]))),128)),F.value.length?p("",!0):(i(),n("div",El," Chagua darasa/stream kwanza. "))]),t[59]||(t[59]=e("p",{class:"mt-1 text-[10px] text-gray-500"},"Chagua masomo kwa kila darasa/stream.",-1))])]),e("div",ql,[e("button",{type:"button",class:"rounded-md bg-gray-50 px-3 py-1.5 text-[11px] font-medium text-gray-700 ring-1 ring-gray-200 hover:bg-gray-100",onClick:t[10]||(t[10]=s=>B.value=!1)}," Cancel "),t[60]||(t[60]=e("button",{type:"submit",class:"rounded-md bg-emerald-600 px-3 py-1.5 text-[11px] font-semibold text-white shadow-sm hover:bg-emerald-700"}," Save changes ",-1))])],32)])])):p("",!0),W.value&&b.value?(i(),n("div",Pl,[e("div",Hl,[t[63]||(t[63]=e("h3",{class:"mb-2 text-sm font-semibold text-gray-900"},"Delete teacher?",-1)),e("p",Wl,[t[61]||(t[61]=D(" This will remove ",-1)),e("span",Jl,d(b.value.name),1),t[62]||(t[62]=D(" from the list of teachers. You can re-create them later if needed. ",-1))]),e("div",Kl,[e("button",{type:"button",class:"rounded-md bg-gray-50 px-3 py-1.5 text-[11px] font-medium text-gray-700 ring-1 ring-gray-200 hover:bg-gray-100",onClick:t[11]||(t[11]=s=>W.value=!1)}," Cancel "),e("button",{type:"button",class:"rounded-md bg-red-600 px-3 py-1.5 text-[11px] font-semibold text-white shadow-sm hover:bg-red-700",onClick:Ye}," Delete ")])])])):p("",!0),V.value?(i(),n("div",Yl,[e("div",Zl,[e("div",Gl,[t[64]||(t[64]=e("div",null,[e("h3",{class:"text-sm font-semibold text-gray-900"},"Add Teacher"),e("p",{class:"mt-0.5 text-[11px] text-gray-500"}," Register a new teacher with contact details and the classes they teach. ")],-1)),e("button",{type:"button",class:"inline-flex h-6 w-6 items-center justify-center rounded-full bg-gray-100 text-[11px] font-bold text-gray-600 hover:bg-gray-200",onClick:t[12]||(t[12]=s=>V.value=!1)}," × ")]),e("form",{class:"space-y-3",onSubmit:Se(Pe,["prevent"])},[e("div",null,[t[65]||(t[65]=e("label",{class:"mb-1 block text-[11px] font-medium"},"Full Name",-1)),C(e("input",{"onUpdate:modelValue":t[13]||(t[13]=s=>f.name=s),type:"text",class:"w-full rounded-md border border-gray-300 px-2 py-1.5 text-[11px] focus:border-emerald-500 focus:outline-none focus:ring-emerald-500",placeholder:"e.g. John Peter Mwakalinga",required:""},null,512),[[X,f.name]])]),e("div",null,[t[66]||(t[66]=e("label",{class:"mb-1 block text-[11px] font-medium"},"Phone Number",-1)),C(e("input",{"onUpdate:modelValue":t[14]||(t[14]=s=>f.phone=s),type:"tel",class:"w-full rounded-md border border-gray-300 px-2 py-1.5 text-[11px] focus:border-emerald-500 focus:outline-none focus:ring-emerald-500",placeholder:"07XXXXXXXX (optional)"},null,512),[[X,f.phone]])]),e("div",Ql,[e("div",null,[t[68]||(t[68]=e("label",{class:"mb-1 block text-[11px] font-medium"},"Assigned classes",-1)),e("div",ea,[(i(!0),n(m,null,g(G.classes,s=>(i(),n("div",{key:s.id,class:"rounded-md border border-gray-100 bg-white"},[e("label",ta,[e("input",{type:"checkbox",class:"h-3.5 w-3.5 rounded border-gray-300 text-emerald-600 focus:ring-emerald-500",checked:M.value.includes(s.id),onChange:o=>ze(s.id)},null,40,sa),e("span",la,d($(s)),1)]),M.value.includes(s.id)?(i(),n("div",aa,[t[67]||(t[67]=e("div",{class:"text-[10px] font-semibold text-gray-600"},"Streams",-1)),e("div",oa,[(i(!0),n(m,null,g(L(s.id),o=>(i(),n("label",{key:o.id,class:"flex items-center gap-2 rounded-md px-2 py-1 text-[11px] text-gray-700 hover:bg-slate-50"},[e("input",{type:"checkbox",class:"h-3.5 w-3.5 rounded border-gray-300 text-emerald-600 focus:ring-emerald-500",checked:f.class_ids.includes(o.id),onChange:r=>De(o.id)},null,40,ra),e("span",na,d(o.label),1)]))),128)),L(s.id).length?p("",!0):(i(),n("div",ia," Hakuna streams kwenye darasa hili. "))])])):p("",!0)]))),128))]),t[69]||(t[69]=e("p",{class:"mt-1 text-[10px] text-gray-500"},"Chagua darasa, kisha chagua stream. Ukiacha stream bila kuchagua, hakuna assignment itahifadhiwa.",-1))]),e("div",null,[t[70]||(t[70]=e("label",{class:"mb-1 block text-[11px] font-medium"},"Assigned subjects",-1)),e("div",da,[(i(!0),n(m,null,g(z.value,s=>(i(),n("div",{key:s,class:"rounded-md border border-gray-100 bg-slate-50/40 p-2"},[e("div",ua,d(xe(s)),1),e("div",ca,[(i(!0),n(m,null,g(E(s),o=>(i(),n("label",{key:`${s}-${o.id}`,class:"flex items-center gap-2 rounded-md px-2 py-1 text-[11px] text-gray-700 hover:bg-emerald-50/40"},[e("input",{type:"checkbox",class:"h-3.5 w-3.5 rounded border-gray-300 text-emerald-600 focus:ring-emerald-500",checked:(N[String(s)]||[]).map(r=>Number(r)).includes(Number(o.id)),onChange:r=>I(N[String(s)],o.id)},null,40,ba),e("span",pa,d(de(o)),1)]))),128)),E(s).length?p("",!0):(i(),n("div",ma," Hakuna masomo yaliyowekwa kwa darasa hili. "))])]))),128)),z.value.length?p("",!0):(i(),n("div",xa," Chagua darasa/stream kwanza. "))]),t[71]||(t[71]=e("p",{class:"mt-1 text-[10px] text-gray-500"},"Chagua masomo kwa kila darasa/stream.",-1))])]),e("div",ga,[e("button",{type:"button",class:"rounded-md bg-gray-50 px-3 py-1.5 text-[11px] font-medium text-gray-700 ring-1 ring-gray-200 hover:bg-gray-100",onClick:t[15]||(t[15]=s=>V.value=!1)}," Cancel "),t[72]||(t[72]=e("button",{type:"submit",class:"rounded-md bg-emerald-600 px-3 py-1.5 text-[11px] font-semibold text-white shadow-sm hover:bg-emerald-700"}," Save Teacher ",-1))])],32)])])):p("",!0),K.value?(i(),n("div",ya,[e("div",fa,[t[75]||(t[75]=e("h3",{class:"mb-2 text-sm font-semibold text-gray-900"},"Delete selected teachers?",-1)),e("p",ha,[t[73]||(t[73]=D(" You are about to delete ",-1)),e("span",va,d(_.value.length),1),t[74]||(t[74]=D(" teacher(s). This will also remove their class/subject assignments. ",-1))]),e("div",{class:"mt-3 flex justify-end gap-2"},[e("button",{type:"button",class:"rounded-md bg-gray-50 px-3 py-1.5 text-[11px] font-medium text-gray-700 ring-1 ring-gray-200 hover:bg-gray-100",onClick:Ie}," Cancel "),e("button",{type:"button",class:"rounded-md bg-red-600 px-3 py-1.5 text-[11px] font-semibold text-white shadow-sm hover:bg-red-700",onClick:$e}," Delete ")])])])):p("",!0)]}),_:1})],64))}};export{ja as default};

import{i as f,c as r,a as h,u as m,h as D,w as _,b as e,d,t as o,o as n,F as v,r as P,s as c,x as N,m as x}from"./app-Bv3pXQiw.js";import{_ as $}from"./AuthenticatedLayout-Bs3ktz0D.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const j={class:"flex items-center justify-between"},F={class:"rounded-xl bg-white p-5 shadow-sm ring-1 ring-gray-100"},S={class:"mb-3 flex items-center justify-between gap-3"},z={class:"text-sm font-medium text-gray-700"},A={class:"overflow-x-auto"},V={class:"min-w-full text-left text-sm"},B={key:0},E={class:"px-3 py-2 align-top"},M={class:"px-3 py-2 align-top"},U={class:"px-3 py-2 align-top text-xs text-gray-600"},L={key:0},Y={key:1},H={key:2},I={class:"px-3 py-2 align-top"},O={class:"flex flex-wrap items-center gap-1"},q={class:"px-3 py-2 align-top text-xs text-gray-600"},G={class:"px-3 py-2 align-top"},J={class:"flex justify-end gap-2"},K=["onClick"],Q=["onClick"],R=["disabled","onClick"],W=["onClick"],X={class:"flex h-[85vh] w-full max-w-5xl flex-col overflow-hidden rounded-xl bg-white shadow-xl"},Z={class:"flex items-center justify-between border-b border-gray-100 px-4 py-3"},ee={class:"min-w-0"},te={class:"truncate text-sm font-semibold text-gray-800"},se={class:"mt-0.5 text-[11px] text-gray-500"},le={class:"flex items-center gap-2"},oe={class:"flex-1 bg-gray-50"},re={key:0,class:"p-6 text-center text-xs text-gray-500"},ne={key:1,class:"p-6 text-center text-xs text-gray-600"},ie=["src"],ce={__name:"Timetables",props:{timetables:{type:Array,default:()=>[]}},setup(p){const u=f(!1),i=f(null),w=l=>{i.value=l||null,u.value=!0},k=l=>{confirm("Delete this timetable?")&&x.delete(route("timetables.destroy",l))},C=l=>{x.post(route("timetables.publish",l))},T=l=>{if(!l)return"-";const s=new Date(l);return Number.isNaN(s.getTime())?String(l):s.toLocaleString()},y=l=>{const s=l==null?void 0:l.schedule_json;return s?Array.isArray(s)?s.length>0:typeof s=="object"?Object.keys(s).length>0:!1:!1};return(l,s)=>(n(),r(v,null,[h(m(D),{title:"Timetables"}),h($,null,{header:_(()=>[e("div",j,[s[4]||(s[4]=e("div",null,[e("h2",{class:"text-2xl font-semibold leading-tight text-gray-800"}," Timetables "),e("p",{class:"mt-1 text-sm text-gray-500"}," View and manage class timetables. You can preview, download or delete a timetable from the list below. ")],-1)),e("button",{type:"button",class:"inline-flex items-center rounded-md bg-emerald-600 px-3 py-2 text-xs font-semibold text-white shadow-sm hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:ring-offset-1",onClick:s[0]||(s[0]=g=>m(x).get(l.route("timetables.create")))}," Create Timetable ")])]),default:_(()=>{var g,b;return[e("div",F,[e("div",S,[e("p",z," Timetables ("+o(p.timetables.length)+") ",1),s[5]||(s[5]=e("p",{class:"text-[11px] text-gray-500"}," Hizi ni ratiba ulizohifadhi (kwa madarasa au shule). Unaweza ku-preview, ku-print au kufuta. ",-1))]),e("div",A,[e("table",V,[s[7]||(s[7]=e("thead",null,[e("tr",{class:"border-b border-gray-200 bg-gray-50 text-xs font-semibold uppercase tracking-wide text-gray-500"},[e("th",{class:"px-3 py-2"},"Title"),e("th",{class:"px-3 py-2"},"Class"),e("th",{class:"px-3 py-2"},"Year / Term"),e("th",{class:"px-3 py-2"},"Status"),e("th",{class:"px-3 py-2"},"Created"),e("th",{class:"px-3 py-2 text-right"},"Actions")])],-1)),e("tbody",null,[p.timetables.length===0?(n(),r("tr",B,[...s[6]||(s[6]=[e("td",{colspan:"6",class:"px-3 py-4 text-center text-xs text-gray-500"}," No timetables created yet. ",-1)])])):d("",!0),(n(!0),r(v,null,P(p.timetables,t=>(n(),r("tr",{key:t.id,class:"border-b border-gray-100 text-xs text-gray-700 hover:bg-gray-50"},[e("td",E,o(t.title),1),e("td",M,o(t.class_name||"-"),1),e("td",U,[t.academic_year?(n(),r("span",L,o(t.academic_year),1)):d("",!0),t.term?(n(),r("span",Y," â€¢ "+o(t.term),1)):d("",!0),!t.academic_year&&!t.term?(n(),r("span",H,"-")):d("",!0)]),e("td",I,[e("div",O,[e("span",{class:c(["inline-flex items-center rounded-full px-2 py-0.5 text-[10px] font-semibold ring-1",y(t)?"bg-emerald-50 text-emerald-700 ring-emerald-100":"bg-amber-50 text-amber-800 ring-amber-100"])},o(y(t)?"Saved":"No schedule"),3),e("span",{class:c(["inline-flex items-center rounded-full px-2 py-0.5 text-[10px] font-semibold ring-1",t.is_published?"bg-violet-50 text-violet-700 ring-violet-100":"bg-gray-50 text-gray-600 ring-gray-100"])},o(t.is_published?"Published":"Draft"),3),e("span",{class:c(["inline-flex items-center rounded-full px-2 py-0.5 text-[10px] font-semibold ring-1",t.file_path?"bg-blue-50 text-blue-700 ring-blue-100":"bg-gray-50 text-gray-500 ring-gray-100"])},o(t.file_path?"PDF":"No PDF"),3)])]),e("td",q,o(T(t.created_at)),1),e("td",G,[e("div",J,[e("button",{type:"button",class:"rounded-md bg-blue-50 px-2 py-1 text-[11px] font-medium text-blue-700 ring-1 ring-blue-100 hover:bg-blue-100",onClick:a=>w(t)}," Preview ",8,K),e("button",{type:"button",class:"rounded-md bg-violet-50 px-2 py-1 text-[11px] font-medium text-violet-700 ring-1 ring-violet-100 hover:bg-violet-100",onClick:a=>C(t.id)},o(t.is_published?"Unpublish":"Publish"),9,Q),e("button",{type:"button",disabled:!t.file_path,class:c(["rounded-md px-2 py-1 text-[11px] font-medium ring-1",t.file_path?"bg-emerald-50 text-emerald-700 ring-emerald-100 hover:bg-emerald-100":"bg-gray-50 text-gray-400 ring-gray-100 cursor-not-allowed"]),onClick:a=>t.file_path&&l.window.open(l.route("timetables.download",t.id),"_blank")}," Download ",10,R),e("button",{type:"button",class:"rounded-md bg-red-50 px-2 py-1 text-[11px] font-medium text-red-700 ring-1 ring-red-100 hover:bg-red-100",onClick:a=>k(t.id)}," Delete ",8,W)])])]))),128))])])]),u.value?(n(),r("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 px-4 py-6",onClick:s[3]||(s[3]=N(t=>u.value=!1,["self"]))},[e("div",X,[e("div",Z,[e("div",ee,[e("div",te,o(((g=i.value)==null?void 0:g.title)||"Timetable Preview"),1),e("div",se,o(((b=i.value)==null?void 0:b.class_name)||"-"),1)]),e("div",le,[e("button",{type:"button",class:"rounded-md bg-emerald-50 px-2 py-1 text-[11px] font-medium text-emerald-700 ring-1 ring-emerald-100 hover:bg-emerald-100",onClick:s[1]||(s[1]=t=>{var a;return((a=i.value)==null?void 0:a.id)&&m(x).get(l.route("timetables.show",i.value.id))})}," Edit "),e("button",{type:"button",class:"rounded-md bg-gray-50 px-2 py-1 text-[11px] font-medium text-gray-700 ring-1 ring-gray-100 hover:bg-gray-100",onClick:s[2]||(s[2]=t=>u.value=!1)}," Close ")])]),e("div",oe,[i.value?i.value.file_path?(n(),r("iframe",{key:2,src:l.route("timetables.preview",i.value.id),class:"h-full w-full"},null,8,ie)):(n(),r("div",ne," This timetable has no PDF yet. Use Export to generate a PDF. ")):(n(),r("div",re," No timetable selected. "))])])])):d("",!0)])]}),_:1})],64))}};export{ce as default};
